(function(){const h=document.createElement("link").relList;if(h&&h.supports&&h.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))v(w);new MutationObserver(w=>{for(const S of w)if(S.type==="childList")for(const T of S.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&v(T)}).observe(document,{childList:!0,subtree:!0});function c(w){const S={};return w.integrity&&(S.integrity=w.integrity),w.referrerPolicy&&(S.referrerPolicy=w.referrerPolicy),w.crossOrigin==="use-credentials"?S.credentials="include":w.crossOrigin==="anonymous"?S.credentials="omit":S.credentials="same-origin",S}function v(w){if(w.ep)return;w.ep=!0;const S=c(w);fetch(w.href,S)}})();var xf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sf(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Xo={exports:{}},Va;function En(){return Va||(Va=1,function(d,h){(function(c,v){d.exports=v()})(xf,function(){var c=navigator.userAgent,v=navigator.platform,w=/gecko\/\d/i.test(c),S=/MSIE \d/.test(c),T=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(c),O=/Edge\/(\d+)/.exec(c),B=S||T||O,W=B&&(S?document.documentMode||6:+(O||T)[1]),A=!O&&/WebKit\//.test(c),j=A&&/Qt\/\d+\.\d+/.test(c),P=!O&&/Chrome\/(\d+)/.exec(c),$=P&&+P[1],q=/Opera\//.test(c),re=/Apple Computer/.test(navigator.vendor),te=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(c),b=/PhantomJS/.test(c),x=re&&(/Mobile\/\w+/.test(c)||navigator.maxTouchPoints>2),E=/Android/.test(c),I=x||E||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(c),F=x||/Mac/.test(v),X=/\bCrOS\b/.test(c),C=/win/i.test(v),H=q&&c.match(/Version\/(\d*\.\d*)/);H&&(H=Number(H[1])),H&&H>=15&&(q=!1,A=!0);var Z=F&&(j||q&&(H==null||H<12.11)),U=w||B&&W>=9;function Y(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var J=function(e,t){var r=e.className,n=Y(t).exec(r);if(n){var i=r.slice(n.index+n[0].length);e.className=r.slice(0,n.index)+(i?n[1]+i:"")}};function M(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function z(e,t){return M(e).appendChild(t)}function g(e,t,r,n){var i=document.createElement(e);if(r&&(i.className=r),n&&(i.style.cssText=n),typeof t=="string")i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function ge(e,t,r,n){var i=g(e,t,r,n);return i.setAttribute("role","presentation"),i}var Se;document.createRange?Se=function(e,t,r,n){var i=document.createRange();return i.setEnd(n||e,r),i.setStart(e,t),i}:Se=function(e,t,r){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch{return n}return n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",t),n};function Ce(e,t){if(t.nodeType==3&&(t=t.parentNode),e.contains)return e.contains(t);do if(t.nodeType==11&&(t=t.host),t==e)return!0;while(t=t.parentNode)}function Te(e){var t=e.ownerDocument||e,r;try{r=e.activeElement}catch{r=t.body||null}for(;r&&r.shadowRoot&&r.shadowRoot.activeElement;)r=r.shadowRoot.activeElement;return r}function Ee(e,t){var r=e.className;Y(t).test(r)||(e.className+=(r?" ":"")+t)}function Re(e,t){for(var r=e.split(" "),n=0;n<r.length;n++)r[n]&&!Y(r[n]).test(t)&&(t+=" "+r[n]);return t}var Bt=function(e){e.select()};x?Bt=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:B&&(Bt=function(e){try{e.select()}catch{}});function ot(e){return e.display.wrapper.ownerDocument}function yt(e){return Me(e.display.wrapper)}function Me(e){return e.getRootNode?e.getRootNode():e.ownerDocument}function ce(e){return ot(e).defaultView}function ae(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function pe(e,t,r){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(r!==!1||!t.hasOwnProperty(n))&&(t[n]=e[n]);return t}function be(e,t,r,n,i){t==null&&(t=e.search(/[^\s\u00a0]/),t==-1&&(t=e.length));for(var o=n||0,s=i||0;;){var a=e.indexOf("	",o);if(a<0||a>=t)return s+(t-o);s+=a-o,s+=r-s%r,o=a+1}}var Et=function(){this.id=null,this.f=null,this.time=0,this.handler=ae(this.onTimeout,this)};Et.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},Et.prototype.set=function(e,t){this.f=t;var r=+new Date+e;(!this.id||r<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=r)};function he(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return r;return-1}var Ue=50,St={toString:function(){return"CodeMirror.Pass"}},Qe={scroll:!1},kt={origin:"*mouse"},st={origin:"+move"};function Oe(e,t,r){for(var n=0,i=0;;){var o=e.indexOf("	",n);o==-1&&(o=e.length);var s=o-n;if(o==e.length||i+s>=t)return n+Math.min(s,t-i);if(i+=o-n,i+=r-i%r,n=o+1,i>=t)return n}}var We=[""];function ln(e){for(;We.length<=e;)We.push(me(We)+" ");return We[e]}function me(e){return e[e.length-1]}function Tn(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=t(e[n],n);return r}function $i(e,t,r){for(var n=0,i=r(t);n<e.length&&r(e[n])<=i;)n++;e.splice(n,0,t)}function ai(){}function li(e,t){var r;return Object.create?r=Object.create(e):(ai.prototype=e,r=new ai),t&&pe(t,r),r}var Yi=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Cr(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Yi.test(e))}function Yt(e,t){return t?t.source.indexOf("\\w")>-1&&Cr(e)?!0:t.test(e):Cr(e)}function ui(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var Jt=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function qe(e){return e.charCodeAt(0)>=768&&Jt.test(e)}function un(e,t,r){for(;(r<0?t>0:t<e.length)&&qe(e.charAt(t));)t+=r;return t}function zt(e,t,r){for(var n=t>r?-1:1;;){if(t==r)return t;var i=(t+r)/2,o=n<0?Math.ceil(i):Math.floor(i);if(o==t)return e(o)?t:r;e(o)?r=o:t=o+n}}function fn(e,t,r,n){if(!e)return n(t,r,"ltr",0);for(var i=!1,o=0;o<e.length;++o){var s=e[o];(s.from<r&&s.to>t||t==r&&s.to==t)&&(n(Math.max(s.from,t),Math.min(s.to,r),s.level==1?"rtl":"ltr",o),i=!0)}i||n(t,r,"ltr")}var In=null;function cn(e,t,r){var n;In=null;for(var i=0;i<e.length;++i){var o=e[i];if(o.from<t&&o.to>t)return i;o.to==t&&(o.from!=o.to&&r=="before"?n=i:In=i),o.from==t&&(o.from!=o.to&&r!="before"?n=i:In=i)}return n??In}var Ji=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function r(u){return u<=247?e.charAt(u):1424<=u&&u<=1524?"R":1536<=u&&u<=1785?t.charAt(u-1536):1774<=u&&u<=2220?"r":8192<=u&&u<=8203?"w":u==8204?"b":"L"}var n=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,o=/[LRr]/,s=/[Lb1n]/,a=/[1n]/;function l(u,p,y){this.level=u,this.from=p,this.to=y}return function(u,p){var y=p=="ltr"?"L":"R";if(u.length==0||p=="ltr"&&!n.test(u))return!1;for(var L=u.length,k=[],D=0;D<L;++D)k.push(r(u.charCodeAt(D)));for(var _=0,K=y;_<L;++_){var Q=k[_];Q=="m"?k[_]=K:K=Q}for(var ne=0,V=y;ne<L;++ne){var ie=k[ne];ie=="1"&&V=="r"?k[ne]="n":o.test(ie)&&(V=ie,ie=="r"&&(k[ne]="R"))}for(var fe=1,le=k[0];fe<L-1;++fe){var ve=k[fe];ve=="+"&&le=="1"&&k[fe+1]=="1"?k[fe]="1":ve==","&&le==k[fe+1]&&(le=="1"||le=="n")&&(k[fe]=le),le=ve}for(var Le=0;Le<L;++Le){var Ye=k[Le];if(Ye==",")k[Le]="N";else if(Ye=="%"){var Be=void 0;for(Be=Le+1;Be<L&&k[Be]=="%";++Be);for(var xt=Le&&k[Le-1]=="!"||Be<L&&k[Be]=="1"?"1":"N",vt=Le;vt<Be;++vt)k[vt]=xt;Le=Be-1}}for(var _e=0,gt=y;_e<L;++_e){var Ve=k[_e];gt=="L"&&Ve=="1"?k[_e]="L":o.test(Ve)&&(gt=Ve)}for(var Ge=0;Ge<L;++Ge)if(i.test(k[Ge])){var ze=void 0;for(ze=Ge+1;ze<L&&i.test(k[ze]);++ze);for(var De=(Ge?k[Ge-1]:y)=="L",mt=(ze<L?k[ze]:y)=="L",vr=De==mt?De?"L":"R":y,Ln=Ge;Ln<ze;++Ln)k[Ln]=vr;Ge=ze-1}for(var it=[],Xt,Je=0;Je<L;)if(s.test(k[Je])){var Ko=Je;for(++Je;Je<L&&s.test(k[Je]);++Je);it.push(new l(0,Ko,Je))}else{var on=Je,Pn=it.length,Rn=p=="rtl"?1:0;for(++Je;Je<L&&k[Je]!="L";++Je);for(var lt=on;lt<Je;)if(a.test(k[lt])){on<lt&&(it.splice(Pn,0,new l(1,on,lt)),Pn+=Rn);var gr=lt;for(++lt;lt<Je&&a.test(k[lt]);++lt);it.splice(Pn,0,new l(2,gr,lt)),Pn+=Rn,on=lt}else++lt;on<Je&&it.splice(Pn,0,new l(1,on,Je))}return p=="ltr"&&(it[0].level==1&&(Xt=u.match(/^\s+/))&&(it[0].from=Xt[0].length,it.unshift(new l(0,0,Xt[0].length))),me(it).level==1&&(Xt=u.match(/\s+$/))&&(me(it).to-=Xt[0].length,it.push(new l(0,L-Xt[0].length,L)))),p=="rtl"?it.reverse():it}}();function ye(e,t){var r=e.order;return r==null&&(r=e.order=Ji(e.text,t)),r}var fi=[],ue=function(e,t,r){if(e.addEventListener)e.addEventListener(t,r,!1);else if(e.attachEvent)e.attachEvent("on"+t,r);else{var n=e._handlers||(e._handlers={});n[t]=(n[t]||fi).concat(r)}};function Zt(e,t){return e._handlers&&e._handlers[t]||fi}function tt(e,t,r){if(e.removeEventListener)e.removeEventListener(t,r,!1);else if(e.detachEvent)e.detachEvent("on"+t,r);else{var n=e._handlers,i=n&&n[t];if(i){var o=he(i,r);o>-1&&(n[t]=i.slice(0,o).concat(i.slice(o+1)))}}}function Ae(e,t){var r=Zt(e,t);if(r.length)for(var n=Array.prototype.slice.call(arguments,2),i=0;i<r.length;++i)r[i].apply(null,n)}function Ne(e,t,r){return typeof t=="string"&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Ae(e,r||t.type,e,t),ct(t)||t.codemirrorIgnore}function Tt(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var r=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)he(r,t[n])==-1&&r.push(t[n])}function bt(e,t){return Zt(e,t).length>0}function Ot(e){e.prototype.on=function(t,r){ue(this,t,r)},e.prototype.off=function(t,r){tt(this,t,r)}}function nt(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Gn(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function ct(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==!1}function dn(e){nt(e),Gn(e)}function Er(e){return e.target||e.srcElement}function At(e){var t=e.which;return t==null&&(e.button&1?t=1:e.button&2?t=3:e.button&4&&(t=2)),F&&e.ctrlKey&&t==1&&(t=3),t}var Zi=function(){if(B&&W<9)return!1;var e=g("div");return"draggable"in e||"dragDrop"in e}(),Kn;function ci(e){if(Kn==null){var t=g("span","​");z(e,g("span",[t,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(Kn=t.offsetWidth<=1&&t.offsetHeight>2&&!(B&&W<8))}var r=Kn?g("span","​"):g("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return r.setAttribute("cm-text",""),r}var Tr;function hn(e){if(Tr!=null)return Tr;var t=z(e,document.createTextNode("AخA")),r=Se(t,0,1).getBoundingClientRect(),n=Se(t,1,2).getBoundingClientRect();return M(e),!r||r.left==r.right?!1:Tr=n.right-r.right<3}var It=`

b`.split(/\n/).length!=3?function(e){for(var t=0,r=[],n=e.length;t<=n;){var i=e.indexOf(`
`,t);i==-1&&(i=e.length);var o=e.slice(t,e.charAt(i-1)=="\r"?i-1:i),s=o.indexOf("\r");s!=-1?(r.push(o.slice(0,s)),t+=s+1):(r.push(o),t=i+1)}return r}:function(e){return e.split(/\r\n?|\n/)},pn=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch{return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch{}return!t||t.parentElement()!=e?!1:t.compareEndPoints("StartToEnd",t)!=0},di=function(){var e=g("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),Nt=null;function Qi(e){if(Nt!=null)return Nt;var t=z(e,g("span","x")),r=t.getBoundingClientRect(),n=Se(t,0,1).getBoundingClientRect();return Nt=Math.abs(r.left-n.left)>1}var jn={},Ht={};function Dt(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),jn[e]=t}function Mn(e,t){Ht[e]=t}function Xn(e){if(typeof e=="string"&&Ht.hasOwnProperty(e))e=Ht[e];else if(e&&typeof e.name=="string"&&Ht.hasOwnProperty(e.name)){var t=Ht[e.name];typeof t=="string"&&(t={name:t}),e=li(t,e),e.name=t.name}else{if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return Xn("application/xml");if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return Xn("application/json")}return typeof e=="string"?{name:e}:e||{name:"null"}}function $n(e,t){t=Xn(t);var r=jn[t.name];if(!r)return $n(e,"text/plain");var n=r(e,t);if(vn.hasOwnProperty(t.name)){var i=vn[t.name];for(var o in i)i.hasOwnProperty(o)&&(n.hasOwnProperty(o)&&(n["_"+o]=n[o]),n[o]=i[o])}if(n.name=t.name,t.helperType&&(n.helperType=t.helperType),t.modeProps)for(var s in t.modeProps)n[s]=t.modeProps[s];return n}var vn={};function Yn(e,t){var r=vn.hasOwnProperty(e)?vn[e]:vn[e]={};pe(t,r)}function Ut(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var r={};for(var n in t){var i=t[n];i instanceof Array&&(i=i.concat([])),r[n]=i}return r}function Ir(e,t){for(var r;e.innerMode&&(r=e.innerMode(t),!(!r||r.mode==e));)t=r.state,e=r.mode;return r||{mode:e,state:t}}function Jn(e,t,r){return e.startState?e.startState(t,r):!0}var He=function(e,t,r){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=r};He.prototype.eol=function(){return this.pos>=this.string.length},He.prototype.sol=function(){return this.pos==this.lineStart},He.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},He.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},He.prototype.eat=function(e){var t=this.string.charAt(this.pos),r;if(typeof e=="string"?r=t==e:r=t&&(e.test?e.test(t):e(t)),r)return++this.pos,t},He.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},He.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},He.prototype.skipToEnd=function(){this.pos=this.string.length},He.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},He.prototype.backUp=function(e){this.pos-=e},He.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=be(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?be(this.string,this.lineStart,this.tabSize):0)},He.prototype.indentation=function(){return be(this.string,null,this.tabSize)-(this.lineStart?be(this.string,this.lineStart,this.tabSize):0)},He.prototype.match=function(e,t,r){if(typeof e=="string"){var n=function(s){return r?s.toLowerCase():s},i=this.string.substr(this.pos,e.length);if(n(i)==n(e))return t!==!1&&(this.pos+=e.length),!0}else{var o=this.string.slice(this.pos).match(e);return o&&o.index>0?null:(o&&t!==!1&&(this.pos+=o[0].length),o)}},He.prototype.current=function(){return this.string.slice(this.start,this.pos)},He.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},He.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},He.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function se(e,t){if(t-=e.first,t<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var r=e;!r.lines;)for(var n=0;;++n){var i=r.children[n],o=i.chunkSize();if(t<o){r=i;break}t-=o}return r.lines[t]}function Qt(e,t,r){var n=[],i=t.line;return e.iter(t.line,r.line+1,function(o){var s=o.text;i==r.line&&(s=s.slice(0,r.ch)),i==t.line&&(s=s.slice(t.ch)),n.push(s),++i}),n}function Mr(e,t,r){var n=[];return e.iter(t,r,function(i){n.push(i.text)}),n}function Lt(e,t){var r=t-e.height;if(r)for(var n=e;n;n=n.parent)n.height+=r}function f(e){if(e.parent==null)return null;for(var t=e.parent,r=he(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var i=0;n.children[i]!=t;++i)r+=n.children[i].chunkSize();return r+t.first}function m(e,t){var r=e.first;e:do{for(var n=0;n<e.children.length;++n){var i=e.children[n],o=i.height;if(t<o){e=i;continue e}t-=o,r+=i.chunkSize()}return r}while(!e.lines);for(var s=0;s<e.lines.length;++s){var a=e.lines[s],l=a.height;if(t<l)break;t-=l}return r+s}function R(e,t){return t>=e.first&&t<e.first+e.size}function G(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function N(e,t,r){if(r===void 0&&(r=null),!(this instanceof N))return new N(e,t,r);this.line=e,this.ch=t,this.sticky=r}function ee(e,t){return e.line-t.line||e.ch-t.ch}function we(e,t){return e.sticky==t.sticky&&ee(e,t)==0}function Ke(e){return N(e.line,e.ch)}function dt(e,t){return ee(e,t)<0?t:e}function Zn(e,t){return ee(e,t)<0?e:t}function es(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function de(e,t){if(t.line<e.first)return N(e.first,0);var r=e.first+e.size-1;return t.line>r?N(r,se(e,r).text.length):xl(t,se(e,t.line).text.length)}function xl(e,t){var r=e.ch;return r==null||r>t?N(e.line,t):r<0?N(e.line,0):e}function ts(e,t){for(var r=[],n=0;n<t.length;n++)r[n]=de(e,t[n]);return r}var hi=function(e,t){this.state=e,this.lookAhead=t},Gt=function(e,t,r,n){this.state=t,this.doc=e,this.line=r,this.maxLookAhead=n||0,this.baseTokens=null,this.baseTokenPos=1};Gt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return t!=null&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},Gt.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},Gt.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},Gt.fromSaved=function(e,t,r){return t instanceof hi?new Gt(e,Ut(e.mode,t.state),r,t.lookAhead):new Gt(e,Ut(e.mode,t),r)},Gt.prototype.save=function(e){var t=e!==!1?Ut(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new hi(t,this.maxLookAhead):t};function ns(e,t,r,n){var i=[e.state.modeGen],o={};ls(e,t.text,e.doc.mode,r,function(u,p){return i.push(u,p)},o,n);for(var s=r.state,a=function(u){r.baseTokens=i;var p=e.state.overlays[u],y=1,L=0;r.state=!0,ls(e,t.text,p.mode,r,function(k,D){for(var _=y;L<k;){var K=i[y];K>k&&i.splice(y,1,k,i[y+1],K),y+=2,L=Math.min(k,K)}if(D)if(p.opaque)i.splice(_,y-_,k,"overlay "+D),y=_+2;else for(;_<y;_+=2){var Q=i[_+1];i[_+1]=(Q?Q+" ":"")+"overlay "+D}},o),r.state=s,r.baseTokens=null,r.baseTokenPos=1},l=0;l<e.state.overlays.length;++l)a(l);return{styles:i,classes:o.bgClass||o.textClass?o:null}}function rs(e,t,r){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=Br(e,f(t)),i=t.text.length>e.options.maxHighlightLength&&Ut(e.doc.mode,n.state),o=ns(e,t,n);i&&(n.state=i),t.stateAfter=n.save(!i),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),r===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function Br(e,t,r){var n=e.doc,i=e.display;if(!n.mode.startState)return new Gt(n,!0,t);var o=Sl(e,t,r),s=o>n.first&&se(n,o-1).stateAfter,a=s?Gt.fromSaved(n,s,o):new Gt(n,Jn(n.mode),o);return n.iter(o,t,function(l){Vi(e,l.text,a);var u=a.line;l.stateAfter=u==t-1||u%5==0||u>=i.viewFrom&&u<i.viewTo?a.save():null,a.nextLine()}),r&&(n.modeFrontier=a.line),a}function Vi(e,t,r,n){var i=e.doc.mode,o=new He(t,e.options.tabSize,r);for(o.start=o.pos=n||0,t==""&&is(i,r.state);!o.eol();)eo(i,o,r.state),o.start=o.pos}function is(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var r=Ir(e,t);if(r.mode.blankLine)return r.mode.blankLine(r.state)}}function eo(e,t,r,n){for(var i=0;i<10;i++){n&&(n[0]=Ir(e,r).mode);var o=e.token(t,r);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}var os=function(e,t,r){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=r};function ss(e,t,r,n){var i=e.doc,o=i.mode,s;t=de(i,t);var a=se(i,t.line),l=Br(e,t.line,r),u=new He(a.text,e.options.tabSize,l),p;for(n&&(p=[]);(n||u.pos<t.ch)&&!u.eol();)u.start=u.pos,s=eo(o,u,l.state),n&&p.push(new os(u,s,Ut(i.mode,l.state)));return n?p:new os(u,s,l.state)}function as(e,t){if(e)for(;;){var r=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!r)break;e=e.slice(0,r.index)+e.slice(r.index+r[0].length);var n=r[1]?"bgClass":"textClass";t[n]==null?t[n]=r[2]:new RegExp("(?:^|\\s)"+r[2]+"(?:$|\\s)").test(t[n])||(t[n]+=" "+r[2])}return e}function ls(e,t,r,n,i,o,s){var a=r.flattenSpans;a==null&&(a=e.options.flattenSpans);var l=0,u=null,p=new He(t,e.options.tabSize,n),y,L=e.options.addModeClass&&[null];for(t==""&&as(is(r,n.state),o);!p.eol();){if(p.pos>e.options.maxHighlightLength?(a=!1,s&&Vi(e,t,n,p.pos),p.pos=t.length,y=null):y=as(eo(r,p,n.state,L),o),L){var k=L[0].name;k&&(y="m-"+(y?k+" "+y:k))}if(!a||u!=y){for(;l<p.start;)l=Math.min(p.start,l+5e3),i(l,u);u=y}p.start=p.pos}for(;l<p.pos;){var D=Math.min(p.pos,l+5e3);i(D,u),l=D}}function Sl(e,t,r){for(var n,i,o=e.doc,s=r?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>s;--a){if(a<=o.first)return o.first;var l=se(o,a-1),u=l.stateAfter;if(u&&(!r||a+(u instanceof hi?u.lookAhead:0)<=o.modeFrontier))return a;var p=be(l.text,null,e.options.tabSize);(i==null||n>p)&&(i=a-1,n=p)}return i}function kl(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var r=e.first,n=t-1;n>r;n--){var i=se(e,n).stateAfter;if(i&&(!(i instanceof hi)||n+i.lookAhead<t)){r=n+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,r)}}var us=!1,Vt=!1;function Ll(){us=!0}function Cl(){Vt=!0}function pi(e,t,r){this.marker=e,this.from=t,this.to=r}function Or(e,t){if(e)for(var r=0;r<e.length;++r){var n=e[r];if(n.marker==t)return n}}function El(e,t){for(var r,n=0;n<e.length;++n)e[n]!=t&&(r||(r=[])).push(e[n]);return r}function Tl(e,t,r){var n=r&&window.WeakSet&&(r.markedSpans||(r.markedSpans=new WeakSet));n&&e.markedSpans&&n.has(e.markedSpans)?e.markedSpans.push(t):(e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],n&&n.add(e.markedSpans)),t.marker.attachLine(e)}function Il(e,t,r){var n;if(e)for(var i=0;i<e.length;++i){var o=e[i],s=o.marker,a=o.from==null||(s.inclusiveLeft?o.from<=t:o.from<t);if(a||o.from==t&&s.type=="bookmark"&&(!r||!o.marker.insertLeft)){var l=o.to==null||(s.inclusiveRight?o.to>=t:o.to>t);(n||(n=[])).push(new pi(s,o.from,l?null:o.to))}}return n}function Ml(e,t,r){var n;if(e)for(var i=0;i<e.length;++i){var o=e[i],s=o.marker,a=o.to==null||(s.inclusiveRight?o.to>=t:o.to>t);if(a||o.from==t&&s.type=="bookmark"&&(!r||o.marker.insertLeft)){var l=o.from==null||(s.inclusiveLeft?o.from<=t:o.from<t);(n||(n=[])).push(new pi(s,l?null:o.from-t,o.to==null?null:o.to-t))}}return n}function to(e,t){if(t.full)return null;var r=R(e,t.from.line)&&se(e,t.from.line).markedSpans,n=R(e,t.to.line)&&se(e,t.to.line).markedSpans;if(!r&&!n)return null;var i=t.from.ch,o=t.to.ch,s=ee(t.from,t.to)==0,a=Il(r,i,s),l=Ml(n,o,s),u=t.text.length==1,p=me(t.text).length+(u?i:0);if(a)for(var y=0;y<a.length;++y){var L=a[y];if(L.to==null){var k=Or(l,L.marker);k?u&&(L.to=k.to==null?null:k.to+p):L.to=i}}if(l)for(var D=0;D<l.length;++D){var _=l[D];if(_.to!=null&&(_.to+=p),_.from==null){var K=Or(a,_.marker);K||(_.from=p,u&&(a||(a=[])).push(_))}else _.from+=p,u&&(a||(a=[])).push(_)}a&&(a=fs(a)),l&&l!=a&&(l=fs(l));var Q=[a];if(!u){var ne=t.text.length-2,V;if(ne>0&&a)for(var ie=0;ie<a.length;++ie)a[ie].to==null&&(V||(V=[])).push(new pi(a[ie].marker,null,null));for(var fe=0;fe<ne;++fe)Q.push(V);Q.push(l)}return Q}function fs(e){for(var t=0;t<e.length;++t){var r=e[t];r.from!=null&&r.from==r.to&&r.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function Bl(e,t,r){var n=null;if(e.iter(t.line,r.line+1,function(k){if(k.markedSpans)for(var D=0;D<k.markedSpans.length;++D){var _=k.markedSpans[D].marker;_.readOnly&&(!n||he(n,_)==-1)&&(n||(n=[])).push(_)}}),!n)return null;for(var i=[{from:t,to:r}],o=0;o<n.length;++o)for(var s=n[o],a=s.find(0),l=0;l<i.length;++l){var u=i[l];if(!(ee(u.to,a.from)<0||ee(u.from,a.to)>0)){var p=[l,1],y=ee(u.from,a.from),L=ee(u.to,a.to);(y<0||!s.inclusiveLeft&&!y)&&p.push({from:u.from,to:a.from}),(L>0||!s.inclusiveRight&&!L)&&p.push({from:a.to,to:u.to}),i.splice.apply(i,p),l+=p.length-3}}return i}function cs(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;++r)t[r].marker.detachLine(e);e.markedSpans=null}}function ds(e,t){if(t){for(var r=0;r<t.length;++r)t[r].marker.attachLine(e);e.markedSpans=t}}function vi(e){return e.inclusiveLeft?-1:0}function gi(e){return e.inclusiveRight?1:0}function no(e,t){var r=e.lines.length-t.lines.length;if(r!=0)return r;var n=e.find(),i=t.find(),o=ee(n.from,i.from)||vi(e)-vi(t);if(o)return-o;var s=ee(n.to,i.to)||gi(e)-gi(t);return s||t.id-e.id}function hs(e,t){var r=Vt&&e.markedSpans,n;if(r)for(var i=void 0,o=0;o<r.length;++o)i=r[o],i.marker.collapsed&&(t?i.from:i.to)==null&&(!n||no(n,i.marker)<0)&&(n=i.marker);return n}function ps(e){return hs(e,!0)}function mi(e){return hs(e,!1)}function Ol(e,t){var r=Vt&&e.markedSpans,n;if(r)for(var i=0;i<r.length;++i){var o=r[i];o.marker.collapsed&&(o.from==null||o.from<t)&&(o.to==null||o.to>t)&&(!n||no(n,o.marker)<0)&&(n=o.marker)}return n}function vs(e,t,r,n,i){var o=se(e,t),s=Vt&&o.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var u=l.marker.find(0),p=ee(u.from,r)||vi(l.marker)-vi(i),y=ee(u.to,n)||gi(l.marker)-gi(i);if(!(p>=0&&y<=0||p<=0&&y>=0)&&(p<=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?ee(u.to,r)>=0:ee(u.to,r)>0)||p>=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?ee(u.from,n)<=0:ee(u.from,n)<0)))return!0}}}function Wt(e){for(var t;t=ps(e);)e=t.find(-1,!0).line;return e}function Al(e){for(var t;t=mi(e);)e=t.find(1,!0).line;return e}function Nl(e){for(var t,r;t=mi(e);)e=t.find(1,!0).line,(r||(r=[])).push(e);return r}function ro(e,t){var r=se(e,t),n=Wt(r);return r==n?t:f(n)}function gs(e,t){if(t>e.lastLine())return t;var r=se(e,t),n;if(!gn(e,r))return t;for(;n=mi(r);)r=n.find(1,!0).line;return f(r)+1}function gn(e,t){var r=Vt&&t.markedSpans;if(r){for(var n=void 0,i=0;i<r.length;++i)if(n=r[i],!!n.marker.collapsed){if(n.from==null)return!0;if(!n.marker.widgetNode&&n.from==0&&n.marker.inclusiveLeft&&io(e,t,n))return!0}}}function io(e,t,r){if(r.to==null){var n=r.marker.find(1,!0);return io(e,n.line,Or(n.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==t.text.length)return!0;for(var i=void 0,o=0;o<t.markedSpans.length;++o)if(i=t.markedSpans[o],i.marker.collapsed&&!i.marker.widgetNode&&i.from==r.to&&(i.to==null||i.to!=r.from)&&(i.marker.inclusiveLeft||r.marker.inclusiveRight)&&io(e,t,i))return!0}function en(e){e=Wt(e);for(var t=0,r=e.parent,n=0;n<r.lines.length;++n){var i=r.lines[n];if(i==e)break;t+=i.height}for(var o=r.parent;o;r=o,o=r.parent)for(var s=0;s<o.children.length;++s){var a=o.children[s];if(a==r)break;t+=a.height}return t}function yi(e){if(e.height==0)return 0;for(var t=e.text.length,r,n=e;r=ps(n);){var i=r.find(0,!0);n=i.from.line,t+=i.from.ch-i.to.ch}for(n=e;r=mi(n);){var o=r.find(0,!0);t-=n.text.length-o.from.ch,n=o.to.line,t+=n.text.length-o.to.ch}return t}function oo(e){var t=e.display,r=e.doc;t.maxLine=se(r,r.first),t.maxLineLength=yi(t.maxLine),t.maxLineChanged=!0,r.iter(function(n){var i=yi(n);i>t.maxLineLength&&(t.maxLineLength=i,t.maxLine=n)})}var Qn=function(e,t,r){this.text=e,ds(this,t),this.height=r?r(this):1};Qn.prototype.lineNo=function(){return f(this)},Ot(Qn);function Hl(e,t,r,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),cs(e),ds(e,r);var i=n?n(e):1;i!=e.height&&Lt(e,i)}function Dl(e){e.parent=null,cs(e)}var Wl={},Fl={};function ms(e,t){if(!e||/^\s*$/.test(e))return null;var r=t.addModeClass?Fl:Wl;return r[e]||(r[e]=e.replace(/\S+/g,"cm-$&"))}function ys(e,t){var r=ge("span",null,null,A?"padding-right: .1px":null),n={pre:ge("pre",[r],"CodeMirror-line"),content:r,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var o=i?t.rest[i-1]:t.line,s=void 0;n.pos=0,n.addToken=Rl,hn(e.display.measure)&&(s=ye(o,e.doc.direction))&&(n.addToken=_l(n.addToken,s)),n.map=[];var a=t!=e.display.externalMeasured&&f(o);zl(o,n,rs(e,o,a)),o.styleClasses&&(o.styleClasses.bgClass&&(n.bgClass=Re(o.styleClasses.bgClass,n.bgClass||"")),o.styleClasses.textClass&&(n.textClass=Re(o.styleClasses.textClass,n.textClass||""))),n.map.length==0&&n.map.push(0,0,n.content.appendChild(ci(e.display.measure))),i==0?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(A){var l=n.content.lastChild;(/\bcm-tab\b/.test(l.className)||l.querySelector&&l.querySelector(".cm-tab"))&&(n.content.className="cm-tab-wrap-hack")}return Ae(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=Re(n.pre.className,n.textClass||"")),n}function Pl(e){var t=g("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Rl(e,t,r,n,i,o,s){if(t){var a=e.splitSpaces?ql(t,e.trailingSpace):t,l=e.cm.state.specialChars,u=!1,p;if(!l.test(t))e.col+=t.length,p=document.createTextNode(a),e.map.push(e.pos,e.pos+t.length,p),B&&W<9&&(u=!0),e.pos+=t.length;else{p=document.createDocumentFragment();for(var y=0;;){l.lastIndex=y;var L=l.exec(t),k=L?L.index-y:t.length-y;if(k){var D=document.createTextNode(a.slice(y,y+k));B&&W<9?p.appendChild(g("span",[D])):p.appendChild(D),e.map.push(e.pos,e.pos+k,D),e.col+=k,e.pos+=k}if(!L)break;y+=k+1;var _=void 0;if(L[0]=="	"){var K=e.cm.options.tabSize,Q=K-e.col%K;_=p.appendChild(g("span",ln(Q),"cm-tab")),_.setAttribute("role","presentation"),_.setAttribute("cm-text","	"),e.col+=Q}else L[0]=="\r"||L[0]==`
`?(_=p.appendChild(g("span",L[0]=="\r"?"␍":"␤","cm-invalidchar")),_.setAttribute("cm-text",L[0]),e.col+=1):(_=e.cm.options.specialCharPlaceholder(L[0]),_.setAttribute("cm-text",L[0]),B&&W<9?p.appendChild(g("span",[_])):p.appendChild(_),e.col+=1);e.map.push(e.pos,e.pos+1,_),e.pos++}}if(e.trailingSpace=a.charCodeAt(t.length-1)==32,r||n||i||u||o||s){var ne=r||"";n&&(ne+=n),i&&(ne+=i);var V=g("span",[p],ne,o);if(s)for(var ie in s)s.hasOwnProperty(ie)&&ie!="style"&&ie!="class"&&V.setAttribute(ie,s[ie]);return e.content.appendChild(V)}e.content.appendChild(p)}}function ql(e,t){if(e.length>1&&!/  /.test(e))return e;for(var r=t,n="",i=0;i<e.length;i++){var o=e.charAt(i);o==" "&&r&&(i==e.length-1||e.charCodeAt(i+1)==32)&&(o=" "),n+=o,r=o==" "}return n}function _l(e,t){return function(r,n,i,o,s,a,l){i=i?i+" cm-force-border":"cm-force-border";for(var u=r.pos,p=u+n.length;;){for(var y=void 0,L=0;L<t.length&&(y=t[L],!(y.to>u&&y.from<=u));L++);if(y.to>=p)return e(r,n,i,o,s,a,l);e(r,n.slice(0,y.to-u),i,o,null,a,l),o=null,n=n.slice(y.to-u),u=y.to}}}function bs(e,t,r,n){var i=!n&&r.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!n&&e.cm.display.input.needsContentAttribute&&(i||(i=e.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",r.id)),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t,e.trailingSpace=!1}function zl(e,t,r){var n=e.markedSpans,i=e.text,o=0;if(!n){for(var s=1;s<r.length;s+=2)t.addToken(t,i.slice(o,o=r[s]),ms(r[s+1],t.cm.options));return}for(var a=i.length,l=0,u=1,p="",y,L,k=0,D,_,K,Q,ne;;){if(k==l){D=_=K=L="",ne=null,Q=null,k=1/0;for(var V=[],ie=void 0,fe=0;fe<n.length;++fe){var le=n[fe],ve=le.marker;if(ve.type=="bookmark"&&le.from==l&&ve.widgetNode)V.push(ve);else if(le.from<=l&&(le.to==null||le.to>l||ve.collapsed&&le.to==l&&le.from==l)){if(le.to!=null&&le.to!=l&&k>le.to&&(k=le.to,_=""),ve.className&&(D+=" "+ve.className),ve.css&&(L=(L?L+";":"")+ve.css),ve.startStyle&&le.from==l&&(K+=" "+ve.startStyle),ve.endStyle&&le.to==k&&(ie||(ie=[])).push(ve.endStyle,le.to),ve.title&&((ne||(ne={})).title=ve.title),ve.attributes)for(var Le in ve.attributes)(ne||(ne={}))[Le]=ve.attributes[Le];ve.collapsed&&(!Q||no(Q.marker,ve)<0)&&(Q=le)}else le.from>l&&k>le.from&&(k=le.from)}if(ie)for(var Ye=0;Ye<ie.length;Ye+=2)ie[Ye+1]==k&&(_+=" "+ie[Ye]);if(!Q||Q.from==l)for(var Be=0;Be<V.length;++Be)bs(t,0,V[Be]);if(Q&&(Q.from||0)==l){if(bs(t,(Q.to==null?a+1:Q.to)-l,Q.marker,Q.from==null),Q.to==null)return;Q.to==l&&(Q=!1)}}if(l>=a)break;for(var xt=Math.min(a,k);;){if(p){var vt=l+p.length;if(!Q){var _e=vt>xt?p.slice(0,xt-l):p;t.addToken(t,_e,y?y+D:D,K,l+_e.length==k?_:"",L,ne)}if(vt>=xt){p=p.slice(xt-l),l=xt;break}l=vt,K=""}p=i.slice(o,o=r[u++]),y=ms(r[u++],t.cm.options)}}}function ws(e,t,r){this.line=t,this.rest=Nl(t),this.size=this.rest?f(me(this.rest))-r+1:1,this.node=this.text=null,this.hidden=gn(e,t)}function bi(e,t,r){for(var n=[],i,o=t;o<r;o=i){var s=new ws(e.doc,se(e.doc,o),o);i=o+s.size,n.push(s)}return n}var Vn=null;function Ul(e){Vn?Vn.ops.push(e):e.ownsGroup=Vn={ops:[e],delayedCallbacks:[]}}function Gl(e){var t=e.delayedCallbacks,r=0;do{for(;r<t.length;r++)t[r].call(null);for(var n=0;n<e.ops.length;n++){var i=e.ops[n];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(r<t.length)}function Kl(e,t){var r=e.ownsGroup;if(r)try{Gl(r)}finally{Vn=null,t(r)}}var Ar=null;function je(e,t){var r=Zt(e,t);if(r.length){var n=Array.prototype.slice.call(arguments,2),i;Vn?i=Vn.delayedCallbacks:Ar?i=Ar:(i=Ar=[],setTimeout(jl,0));for(var o=function(a){i.push(function(){return r[a].apply(null,n)})},s=0;s<r.length;++s)o(s)}}function jl(){var e=Ar;Ar=null;for(var t=0;t<e.length;++t)e[t]()}function xs(e,t,r,n){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];o=="text"?$l(e,t):o=="gutter"?ks(e,t,r,n):o=="class"?so(e,t):o=="widget"&&Yl(e,t,n)}t.changes=null}function Nr(e){return e.node==e.text&&(e.node=g("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),B&&W<8&&(e.node.style.zIndex=2)),e.node}function Xl(e,t){var r=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(r&&(r+=" CodeMirror-linebackground"),t.background)r?t.background.className=r:(t.background.parentNode.removeChild(t.background),t.background=null);else if(r){var n=Nr(t);t.background=n.insertBefore(g("div",null,r),n.firstChild),e.display.input.setUneditable(t.background)}}function Ss(e,t){var r=e.display.externalMeasured;return r&&r.line==t.line?(e.display.externalMeasured=null,t.measure=r.measure,r.built):ys(e,t)}function $l(e,t){var r=t.text.className,n=Ss(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,so(e,t)):r&&(t.text.className=r)}function so(e,t){Xl(e,t),t.line.wrapClass?Nr(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var r=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=r||""}function ks(e,t,r,n){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var i=Nr(t);t.gutterBackground=g("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),i.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){var s=Nr(t),a=t.gutter=g("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");if(a.setAttribute("aria-hidden","true"),e.display.input.setUneditable(a),s.insertBefore(a,t.text),t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),e.options.lineNumbers&&(!o||!o["CodeMirror-linenumbers"])&&(t.lineNumber=a.appendChild(g("div",G(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var l=0;l<e.display.gutterSpecs.length;++l){var u=e.display.gutterSpecs[l].className,p=o.hasOwnProperty(u)&&o[u];p&&a.appendChild(g("div",[p],"CodeMirror-gutter-elt","left: "+n.gutterLeft[u]+"px; width: "+n.gutterWidth[u]+"px"))}}}function Yl(e,t,r){t.alignable&&(t.alignable=null);for(var n=Y("CodeMirror-linewidget"),i=t.node.firstChild,o=void 0;i;i=o)o=i.nextSibling,n.test(i.className)&&t.node.removeChild(i);Ls(e,t,r)}function Jl(e,t,r,n){var i=Ss(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),so(e,t),ks(e,t,r,n),Ls(e,t,n),t.node}function Ls(e,t,r){if(Cs(e,t.line,t,r,!0),t.rest)for(var n=0;n<t.rest.length;n++)Cs(e,t.rest[n],t,r,!1)}function Cs(e,t,r,n,i){if(t.widgets)for(var o=Nr(r),s=0,a=t.widgets;s<a.length;++s){var l=a[s],u=g("div",[l.node],"CodeMirror-linewidget"+(l.className?" "+l.className:""));l.handleMouseEvents||u.setAttribute("cm-ignore-events","true"),Zl(l,u,r,n),e.display.input.setUneditable(u),i&&l.above?o.insertBefore(u,r.gutter||r.text):o.appendChild(u),je(l,"redraw")}}function Zl(e,t,r,n){if(e.noHScroll){(r.alignable||(r.alignable=[])).push(t);var i=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(i-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function Hr(e){if(e.height!=null)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Ce(document.body,e.node)){var r="position: relative;";e.coverGutter&&(r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(r+="width: "+t.display.wrapper.clientWidth+"px;"),z(t.display.measure,g("div",[e.node],null,r))}return e.height=e.node.parentNode.offsetHeight}function tn(e,t){for(var r=Er(t);r!=e.wrapper;r=r.parentNode)if(!r||r.nodeType==1&&r.getAttribute("cm-ignore-events")=="true"||r.parentNode==e.sizer&&r!=e.mover)return!0}function wi(e){return e.lineSpace.offsetTop}function ao(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Es(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=z(e.measure,g("pre","x","CodeMirror-line-like")),r=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(r.paddingLeft),right:parseInt(r.paddingRight)};return!isNaN(n.left)&&!isNaN(n.right)&&(e.cachedPaddingH=n),n}function Kt(e){return Ue-e.display.nativeBarWidth}function Bn(e){return e.display.scroller.clientWidth-Kt(e)-e.display.barWidth}function lo(e){return e.display.scroller.clientHeight-Kt(e)-e.display.barHeight}function Ql(e,t,r){var n=e.options.lineWrapping,i=n&&Bn(e);if(!t.measure.heights||n&&t.measure.width!=i){var o=t.measure.heights=[];if(n){t.measure.width=i;for(var s=t.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],u=s[a+1];Math.abs(l.bottom-u.bottom)>2&&o.push((l.bottom+u.top)/2-r.top)}}o.push(r.bottom-r.top)}}function Ts(e,t,r){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(var i=0;i<e.rest.length;i++)if(f(e.rest[i])>r)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}}function Vl(e,t){t=Wt(t);var r=f(t),n=e.display.externalMeasured=new ws(e.doc,t,r);n.lineN=r;var i=n.built=ys(e,n);return n.text=i.pre,z(e.display.lineMeasure,i.pre),n}function Is(e,t,r,n){return jt(e,er(e,t),r,n)}function uo(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Nn(e,t)];var r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size)return r}function er(e,t){var r=f(t),n=uo(e,r);n&&!n.text?n=null:n&&n.changes&&(xs(e,n,r,vo(e)),e.curOp.forceUpdate=!0),n||(n=Vl(e,t));var i=Ts(n,t,r);return{line:t,view:n,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function jt(e,t,r,n,i){t.before&&(r=-1);var o=r+(n||""),s;return t.cache.hasOwnProperty(o)?s=t.cache[o]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(Ql(e,t.view,t.rect),t.hasHeights=!0),s=tu(e,t,r,n),s.bogus||(t.cache[o]=s)),{left:s.left,right:s.right,top:i?s.rtop:s.top,bottom:i?s.rbottom:s.bottom}}var Ms={left:0,right:0,top:0,bottom:0};function Bs(e,t,r){for(var n,i,o,s,a,l,u=0;u<e.length;u+=3)if(a=e[u],l=e[u+1],t<a?(i=0,o=1,s="left"):t<l?(i=t-a,o=i+1):(u==e.length-3||t==l&&e[u+3]>t)&&(o=l-a,i=o-1,t>=l&&(s="right")),i!=null){if(n=e[u+2],a==l&&r==(n.insertLeft?"left":"right")&&(s=r),r=="left"&&i==0)for(;u&&e[u-2]==e[u-3]&&e[u-1].insertLeft;)n=e[(u-=3)+2],s="left";if(r=="right"&&i==l-a)for(;u<e.length-3&&e[u+3]==e[u+4]&&!e[u+5].insertLeft;)n=e[(u+=3)+2],s="right";break}return{node:n,start:i,end:o,collapse:s,coverStart:a,coverEnd:l}}function eu(e,t){var r=Ms;if(t=="left")for(var n=0;n<e.length&&(r=e[n]).left==r.right;n++);else for(var i=e.length-1;i>=0&&(r=e[i]).left==r.right;i--);return r}function tu(e,t,r,n){var i=Bs(t.map,r,n),o=i.node,s=i.start,a=i.end,l=i.collapse,u;if(o.nodeType==3){for(var p=0;p<4;p++){for(;s&&qe(t.line.text.charAt(i.coverStart+s));)--s;for(;i.coverStart+a<i.coverEnd&&qe(t.line.text.charAt(i.coverStart+a));)++a;if(B&&W<9&&s==0&&a==i.coverEnd-i.coverStart?u=o.parentNode.getBoundingClientRect():u=eu(Se(o,s,a).getClientRects(),n),u.left||u.right||s==0)break;a=s,s=s-1,l="right"}B&&W<11&&(u=nu(e.display.measure,u))}else{s>0&&(l=n="right");var y;e.options.lineWrapping&&(y=o.getClientRects()).length>1?u=y[n=="right"?y.length-1:0]:u=o.getBoundingClientRect()}if(B&&W<9&&!s&&(!u||!u.left&&!u.right)){var L=o.parentNode.getClientRects()[0];L?u={left:L.left,right:L.left+nr(e.display),top:L.top,bottom:L.bottom}:u=Ms}for(var k=u.top-t.rect.top,D=u.bottom-t.rect.top,_=(k+D)/2,K=t.view.measure.heights,Q=0;Q<K.length-1&&!(_<K[Q]);Q++);var ne=Q?K[Q-1]:0,V=K[Q],ie={left:(l=="right"?u.right:u.left)-t.rect.left,right:(l=="left"?u.left:u.right)-t.rect.left,top:ne,bottom:V};return!u.left&&!u.right&&(ie.bogus=!0),e.options.singleCursorHeightPerLine||(ie.rtop=k,ie.rbottom=D),ie}function nu(e,t){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Qi(e))return t;var r=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*r,right:t.right*r,top:t.top*n,bottom:t.bottom*n}}function Os(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function As(e){e.display.externalMeasure=null,M(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Os(e.display.view[t])}function Dr(e){As(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Ns(e){return P&&E?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function Hs(e){return P&&E?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function fo(e){var t=Wt(e),r=t.widgets,n=0;if(r)for(var i=0;i<r.length;++i)r[i].above&&(n+=Hr(r[i]));return n}function xi(e,t,r,n,i){if(!i){var o=fo(t);r.top+=o,r.bottom+=o}if(n=="line")return r;n||(n="local");var s=en(t);if(n=="local"?s+=wi(e.display):s-=e.display.viewOffset,n=="page"||n=="window"){var a=e.display.lineSpace.getBoundingClientRect();s+=a.top+(n=="window"?0:Hs(ot(e)));var l=a.left+(n=="window"?0:Ns(ot(e)));r.left+=l,r.right+=l}return r.top+=s,r.bottom+=s,r}function Ds(e,t,r){if(r=="div")return t;var n=t.left,i=t.top;if(r=="page")n-=Ns(ot(e)),i-=Hs(ot(e));else if(r=="local"||!r){var o=e.display.sizer.getBoundingClientRect();n+=o.left,i+=o.top}var s=e.display.lineSpace.getBoundingClientRect();return{left:n-s.left,top:i-s.top}}function Si(e,t,r,n,i){return n||(n=se(e.doc,t.line)),xi(e,n,Is(e,n,t.ch,i),r)}function Ft(e,t,r,n,i,o){n=n||se(e.doc,t.line),i||(i=er(e,n));function s(D,_){var K=jt(e,i,D,_?"right":"left",o);return _?K.left=K.right:K.right=K.left,xi(e,n,K,r)}var a=ye(n,e.doc.direction),l=t.ch,u=t.sticky;if(l>=n.text.length?(l=n.text.length,u="before"):l<=0&&(l=0,u="after"),!a)return s(u=="before"?l-1:l,u=="before");function p(D,_,K){var Q=a[_],ne=Q.level==1;return s(K?D-1:D,ne!=K)}var y=cn(a,l,u),L=In,k=p(l,y,u=="before");return L!=null&&(k.other=p(l,L,u!="before")),k}function Ws(e,t){var r=0;t=de(e.doc,t),e.options.lineWrapping||(r=nr(e.display)*t.ch);var n=se(e.doc,t.line),i=en(n)+wi(e.display);return{left:r,right:r,top:i,bottom:i+n.height}}function co(e,t,r,n,i){var o=N(e,t,r);return o.xRel=i,n&&(o.outside=n),o}function ho(e,t,r){var n=e.doc;if(r+=e.display.viewOffset,r<0)return co(n.first,0,null,-1,-1);var i=m(n,r),o=n.first+n.size-1;if(i>o)return co(n.first+n.size-1,se(n,o).text.length,null,1,1);t<0&&(t=0);for(var s=se(n,i);;){var a=ru(e,s,i,t,r),l=Ol(s,a.ch+(a.xRel>0||a.outside>0?1:0));if(!l)return a;var u=l.find(1);if(u.line==i)return u;s=se(n,i=u.line)}}function Fs(e,t,r,n){n-=fo(t);var i=t.text.length,o=zt(function(s){return jt(e,r,s-1).bottom<=n},i,0);return i=zt(function(s){return jt(e,r,s).top>n},o,i),{begin:o,end:i}}function Ps(e,t,r,n){r||(r=er(e,t));var i=xi(e,t,jt(e,r,n),"line").top;return Fs(e,t,r,i)}function po(e,t,r,n){return e.bottom<=r?!1:e.top>r?!0:(n?e.left:e.right)>t}function ru(e,t,r,n,i){i-=en(t);var o=er(e,t),s=fo(t),a=0,l=t.text.length,u=!0,p=ye(t,e.doc.direction);if(p){var y=(e.options.lineWrapping?ou:iu)(e,t,r,o,p,n,i);u=y.level!=1,a=u?y.from:y.to-1,l=u?y.to:y.from-1}var L=null,k=null,D=zt(function(fe){var le=jt(e,o,fe);return le.top+=s,le.bottom+=s,po(le,n,i,!1)?(le.top<=i&&le.left<=n&&(L=fe,k=le),!0):!1},a,l),_,K,Q=!1;if(k){var ne=n-k.left<k.right-n,V=ne==u;D=L+(V?0:1),K=V?"after":"before",_=ne?k.left:k.right}else{!u&&(D==l||D==a)&&D++,K=D==0?"after":D==t.text.length?"before":jt(e,o,D-(u?1:0)).bottom+s<=i==u?"after":"before";var ie=Ft(e,N(r,D,K),"line",t,o);_=ie.left,Q=i<ie.top?-1:i>=ie.bottom?1:0}return D=un(t.text,D,1),co(r,D,K,Q,n-_)}function iu(e,t,r,n,i,o,s){var a=zt(function(y){var L=i[y],k=L.level!=1;return po(Ft(e,N(r,k?L.to:L.from,k?"before":"after"),"line",t,n),o,s,!0)},0,i.length-1),l=i[a];if(a>0){var u=l.level!=1,p=Ft(e,N(r,u?l.from:l.to,u?"after":"before"),"line",t,n);po(p,o,s,!0)&&p.top>s&&(l=i[a-1])}return l}function ou(e,t,r,n,i,o,s){var a=Fs(e,t,n,s),l=a.begin,u=a.end;/\s/.test(t.text.charAt(u-1))&&u--;for(var p=null,y=null,L=0;L<i.length;L++){var k=i[L];if(!(k.from>=u||k.to<=l)){var D=k.level!=1,_=jt(e,n,D?Math.min(u,k.to)-1:Math.max(l,k.from)).right,K=_<o?o-_+1e9:_-o;(!p||y>K)&&(p=k,y=K)}}return p||(p=i[i.length-1]),p.from<l&&(p={from:l,to:p.to,level:p.level}),p.to>u&&(p={from:p.from,to:u,level:p.level}),p}var On;function tr(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(On==null){On=g("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)On.appendChild(document.createTextNode("x")),On.appendChild(g("br"));On.appendChild(document.createTextNode("x"))}z(e.measure,On);var r=On.offsetHeight/50;return r>3&&(e.cachedTextHeight=r),M(e.measure),r||1}function nr(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var t=g("span","xxxxxxxxxx"),r=g("pre",[t],"CodeMirror-line-like");z(e.measure,r);var n=t.getBoundingClientRect(),i=(n.right-n.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function vo(e){for(var t=e.display,r={},n={},i=t.gutters.clientLeft,o=t.gutters.firstChild,s=0;o;o=o.nextSibling,++s){var a=e.display.gutterSpecs[s].className;r[a]=o.offsetLeft+o.clientLeft+i,n[a]=o.clientWidth}return{fixedPos:go(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:r,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function go(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Rs(e){var t=tr(e.display),r=e.options.lineWrapping,n=r&&Math.max(5,e.display.scroller.clientWidth/nr(e.display)-3);return function(i){if(gn(e.doc,i))return 0;var o=0;if(i.widgets)for(var s=0;s<i.widgets.length;s++)i.widgets[s].height&&(o+=i.widgets[s].height);return r?o+(Math.ceil(i.text.length/n)||1)*t:o+t}}function mo(e){var t=e.doc,r=Rs(e);t.iter(function(n){var i=r(n);i!=n.height&&Lt(n,i)})}function An(e,t,r,n){var i=e.display;if(!r&&Er(t).getAttribute("cm-not-content")=="true")return null;var o,s,a=i.lineSpace.getBoundingClientRect();try{o=t.clientX-a.left,s=t.clientY-a.top}catch{return null}var l=ho(e,o,s),u;if(n&&l.xRel>0&&(u=se(e.doc,l.line).text).length==l.ch){var p=be(u,u.length,e.options.tabSize)-u.length;l=N(l.line,Math.max(0,Math.round((o-Es(e.display).left)/nr(e.display))-p))}return l}function Nn(e,t){if(t>=e.display.viewTo||(t-=e.display.viewFrom,t<0))return null;for(var r=e.display.view,n=0;n<r.length;n++)if(t-=r[n].size,t<0)return n}function ht(e,t,r,n){t==null&&(t=e.doc.first),r==null&&(r=e.doc.first+e.doc.size),n||(n=0);var i=e.display;if(n&&r<i.viewTo&&(i.updateLineNumbers==null||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=i.viewTo)Vt&&ro(e.doc,t)<i.viewTo&&yn(e);else if(r<=i.viewFrom)Vt&&gs(e.doc,r+n)>i.viewFrom?yn(e):(i.viewFrom+=n,i.viewTo+=n);else if(t<=i.viewFrom&&r>=i.viewTo)yn(e);else if(t<=i.viewFrom){var o=ki(e,r,r+n,1);o?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=n):yn(e)}else if(r>=i.viewTo){var s=ki(e,t,t,-1);s?(i.view=i.view.slice(0,s.index),i.viewTo=s.lineN):yn(e)}else{var a=ki(e,t,t,-1),l=ki(e,r,r+n,1);a&&l?(i.view=i.view.slice(0,a.index).concat(bi(e,a.lineN,l.lineN)).concat(i.view.slice(l.index)),i.viewTo+=n):yn(e)}var u=i.externalMeasured;u&&(r<u.lineN?u.lineN+=n:t<u.lineN+u.size&&(i.externalMeasured=null))}function mn(e,t,r){e.curOp.viewChanged=!0;var n=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var o=n.view[Nn(e,t)];if(o.node!=null){var s=o.changes||(o.changes=[]);he(s,r)==-1&&s.push(r)}}}function yn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function ki(e,t,r,n){var i=Nn(e,t),o,s=e.display.view;if(!Vt||r==e.doc.first+e.doc.size)return{index:i,lineN:r};for(var a=e.display.viewFrom,l=0;l<i;l++)a+=s[l].size;if(a!=t){if(n>0){if(i==s.length-1)return null;o=a+s[i].size-t,i++}else o=a-t;t+=o,r+=o}for(;ro(e.doc,r)!=r;){if(i==(n<0?0:s.length-1))return null;r+=n*s[i-(n<0?1:0)].size,i+=n}return{index:i,lineN:r}}function su(e,t,r){var n=e.display,i=n.view;i.length==0||t>=n.viewTo||r<=n.viewFrom?(n.view=bi(e,t,r),n.viewFrom=t):(n.viewFrom>t?n.view=bi(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(Nn(e,t))),n.viewFrom=t,n.viewTo<r?n.view=n.view.concat(bi(e,n.viewTo,r)):n.viewTo>r&&(n.view=n.view.slice(0,Nn(e,r)))),n.viewTo=r}function qs(e){for(var t=e.display.view,r=0,n=0;n<t.length;n++){var i=t[n];!i.hidden&&(!i.node||i.changes)&&++r}return r}function Wr(e){e.display.input.showSelection(e.display.input.prepareSelection())}function _s(e,t){t===void 0&&(t=!0);var r=e.doc,n={},i=n.cursors=document.createDocumentFragment(),o=n.selection=document.createDocumentFragment(),s=e.options.$customCursor;s&&(t=!0);for(var a=0;a<r.sel.ranges.length;a++)if(!(!t&&a==r.sel.primIndex)){var l=r.sel.ranges[a];if(!(l.from().line>=e.display.viewTo||l.to().line<e.display.viewFrom)){var u=l.empty();if(s){var p=s(e,l);p&&yo(e,p,i)}else(u||e.options.showCursorWhenSelecting)&&yo(e,l.head,i);u||au(e,l,o)}}return n}function yo(e,t,r){var n=Ft(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=r.appendChild(g("div"," ","CodeMirror-cursor"));if(i.style.left=n.left+"px",i.style.top=n.top+"px",i.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var o=Si(e,t,"div",null,null),s=o.right-o.left;i.style.width=(s>0?s:e.defaultCharWidth())+"px"}if(n.other){var a=r.appendChild(g("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="",a.style.left=n.other.left+"px",a.style.top=n.other.top+"px",a.style.height=(n.other.bottom-n.other.top)*.85+"px"}}function Li(e,t){return e.top-t.top||e.left-t.left}function au(e,t,r){var n=e.display,i=e.doc,o=document.createDocumentFragment(),s=Es(e.display),a=s.left,l=Math.max(n.sizerWidth,Bn(e)-n.sizer.offsetLeft)-s.right,u=i.direction=="ltr";function p(V,ie,fe,le){ie<0&&(ie=0),ie=Math.round(ie),le=Math.round(le),o.appendChild(g("div",null,"CodeMirror-selected","position: absolute; left: "+V+`px;
                             top: `+ie+"px; width: "+(fe??l-V)+`px;
                             height: `+(le-ie)+"px"))}function y(V,ie,fe){var le=se(i,V),ve=le.text.length,Le,Ye;function Be(_e,gt){return Si(e,N(V,_e),"div",le,gt)}function xt(_e,gt,Ve){var Ge=Ps(e,le,null,_e),ze=gt=="ltr"==(Ve=="after")?"left":"right",De=Ve=="after"?Ge.begin:Ge.end-(/\s/.test(le.text.charAt(Ge.end-1))?2:1);return Be(De,ze)[ze]}var vt=ye(le,i.direction);return fn(vt,ie||0,fe??ve,function(_e,gt,Ve,Ge){var ze=Ve=="ltr",De=Be(_e,ze?"left":"right"),mt=Be(gt-1,ze?"right":"left"),vr=ie==null&&_e==0,Ln=fe==null&&gt==ve,it=Ge==0,Xt=!vt||Ge==vt.length-1;if(mt.top-De.top<=3){var Je=(u?vr:Ln)&&it,Ko=(u?Ln:vr)&&Xt,on=Je?a:(ze?De:mt).left,Pn=Ko?l:(ze?mt:De).right;p(on,De.top,Pn-on,De.bottom)}else{var Rn,lt,gr,jo;ze?(Rn=u&&vr&&it?a:De.left,lt=u?l:xt(_e,Ve,"before"),gr=u?a:xt(gt,Ve,"after"),jo=u&&Ln&&Xt?l:mt.right):(Rn=u?xt(_e,Ve,"before"):a,lt=!u&&vr&&it?l:De.right,gr=!u&&Ln&&Xt?a:mt.left,jo=u?xt(gt,Ve,"after"):l),p(Rn,De.top,lt-Rn,De.bottom),De.bottom<mt.top&&p(a,De.bottom,null,mt.top),p(gr,mt.top,jo-gr,mt.bottom)}(!Le||Li(De,Le)<0)&&(Le=De),Li(mt,Le)<0&&(Le=mt),(!Ye||Li(De,Ye)<0)&&(Ye=De),Li(mt,Ye)<0&&(Ye=mt)}),{start:Le,end:Ye}}var L=t.from(),k=t.to();if(L.line==k.line)y(L.line,L.ch,k.ch);else{var D=se(i,L.line),_=se(i,k.line),K=Wt(D)==Wt(_),Q=y(L.line,L.ch,K?D.text.length+1:null).end,ne=y(k.line,K?0:null,k.ch).start;K&&(Q.top<ne.top-2?(p(Q.right,Q.top,null,Q.bottom),p(a,ne.top,ne.left,ne.bottom)):p(Q.right,Q.top,ne.left-Q.right,Q.bottom)),Q.bottom<ne.top&&p(a,Q.bottom,null,ne.top)}r.appendChild(o)}function bo(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var r=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){e.hasFocus()||rr(e),t.cursorDiv.style.visibility=(r=!r)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function zs(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||xo(e))}function wo(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&rr(e))},100)}function xo(e,t){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),e.options.readOnly!="nocursor"&&(e.state.focused||(Ae(e,"focus",e,t),e.state.focused=!0,Ee(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),A&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),bo(e))}function rr(e,t){e.state.delayingBlurEvent||(e.state.focused&&(Ae(e,"blur",e,t),e.state.focused=!1,J(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Ci(e){for(var t=e.display,r=t.lineDiv.offsetTop,n=Math.max(0,t.scroller.getBoundingClientRect().top),i=t.lineDiv.getBoundingClientRect().top,o=0,s=0;s<t.view.length;s++){var a=t.view[s],l=e.options.lineWrapping,u=void 0,p=0;if(!a.hidden){if(i+=a.line.height,B&&W<8){var y=a.node.offsetTop+a.node.offsetHeight;u=y-r,r=y}else{var L=a.node.getBoundingClientRect();u=L.bottom-L.top,!l&&a.text.firstChild&&(p=a.text.firstChild.getBoundingClientRect().right-L.left-1)}var k=a.line.height-u;if((k>.005||k<-.005)&&(i<n&&(o-=k),Lt(a.line,u),Us(a.line),a.rest))for(var D=0;D<a.rest.length;D++)Us(a.rest[D]);if(p>e.display.sizerWidth){var _=Math.ceil(p/nr(e.display));_>e.display.maxLineLength&&(e.display.maxLineLength=_,e.display.maxLine=a.line,e.display.maxLineChanged=!0)}}}Math.abs(o)>2&&(t.scroller.scrollTop+=o)}function Us(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var r=e.widgets[t],n=r.node.parentNode;n&&(r.height=n.offsetHeight)}}function Ei(e,t,r){var n=r&&r.top!=null?Math.max(0,r.top):e.scroller.scrollTop;n=Math.floor(n-wi(e));var i=r&&r.bottom!=null?r.bottom:n+e.wrapper.clientHeight,o=m(t,n),s=m(t,i);if(r&&r.ensure){var a=r.ensure.from.line,l=r.ensure.to.line;a<o?(o=a,s=m(t,en(se(t,a))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=s&&(o=m(t,en(se(t,l))-e.wrapper.clientHeight),s=l)}return{from:o,to:Math.max(s,o+1)}}function lu(e,t){if(!Ne(e,"scrollCursorIntoView")){var r=e.display,n=r.sizer.getBoundingClientRect(),i=null,o=r.wrapper.ownerDocument;if(t.top+n.top<0?i=!0:t.bottom+n.top>(o.defaultView.innerHeight||o.documentElement.clientHeight)&&(i=!1),i!=null&&!b){var s=g("div","​",null,`position: absolute;
                         top: `+(t.top-r.viewOffset-wi(e.display))+`px;
                         height: `+(t.bottom-t.top+Kt(e)+r.barHeight)+`px;
                         left: `+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(s),s.scrollIntoView(i),e.display.lineSpace.removeChild(s)}}}function uu(e,t,r,n){n==null&&(n=0);var i;!e.options.lineWrapping&&t==r&&(r=t.sticky=="before"?N(t.line,t.ch+1,"before"):t,t=t.ch?N(t.line,t.sticky=="before"?t.ch-1:t.ch,"after"):t);for(var o=0;o<5;o++){var s=!1,a=Ft(e,t),l=!r||r==t?a:Ft(e,r);i={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-n,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+n};var u=So(e,i),p=e.doc.scrollTop,y=e.doc.scrollLeft;if(u.scrollTop!=null&&(Pr(e,u.scrollTop),Math.abs(e.doc.scrollTop-p)>1&&(s=!0)),u.scrollLeft!=null&&(Hn(e,u.scrollLeft),Math.abs(e.doc.scrollLeft-y)>1&&(s=!0)),!s)break}return i}function fu(e,t){var r=So(e,t);r.scrollTop!=null&&Pr(e,r.scrollTop),r.scrollLeft!=null&&Hn(e,r.scrollLeft)}function So(e,t){var r=e.display,n=tr(e.display);t.top<0&&(t.top=0);var i=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:r.scroller.scrollTop,o=lo(e),s={};t.bottom-t.top>o&&(t.bottom=t.top+o);var a=e.doc.height+ao(r),l=t.top<n,u=t.bottom>a-n;if(t.top<i)s.scrollTop=l?0:t.top;else if(t.bottom>i+o){var p=Math.min(t.top,(u?a:t.bottom)-o);p!=i&&(s.scrollTop=p)}var y=e.options.fixedGutter?0:r.gutters.offsetWidth,L=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:r.scroller.scrollLeft-y,k=Bn(e)-r.gutters.offsetWidth,D=t.right-t.left>k;return D&&(t.right=t.left+k),t.left<10?s.scrollLeft=0:t.left<L?s.scrollLeft=Math.max(0,t.left+y-(D?0:10)):t.right>k+L-3&&(s.scrollLeft=t.right+(D?0:10)-k),s}function ko(e,t){t!=null&&(Ti(e),e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+t)}function ir(e){Ti(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function Fr(e,t,r){(t!=null||r!=null)&&Ti(e),t!=null&&(e.curOp.scrollLeft=t),r!=null&&(e.curOp.scrollTop=r)}function cu(e,t){Ti(e),e.curOp.scrollToPos=t}function Ti(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var r=Ws(e,t.from),n=Ws(e,t.to);Gs(e,r,n,t.margin)}}function Gs(e,t,r,n){var i=So(e,{left:Math.min(t.left,r.left),top:Math.min(t.top,r.top)-n,right:Math.max(t.right,r.right),bottom:Math.max(t.bottom,r.bottom)+n});Fr(e,i.scrollLeft,i.scrollTop)}function Pr(e,t){Math.abs(e.doc.scrollTop-t)<2||(w||Co(e,{top:t}),Ks(e,t,!0),w&&Co(e),_r(e,100))}function Ks(e,t,r){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),!(e.display.scroller.scrollTop==t&&!r)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function Hn(e,t,r,n){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),!((r?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!n)&&(e.doc.scrollLeft=t,Js(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Rr(e){var t=e.display,r=t.gutters.offsetWidth,n=Math.round(e.doc.height+ao(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?r:0,docHeight:n,scrollHeight:n+Kt(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:r}}var Dn=function(e,t,r){this.cm=r;var n=this.vert=g("div",[g("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=g("div",[g("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");n.tabIndex=i.tabIndex=-1,e(n),e(i),ue(n,"scroll",function(){n.clientHeight&&t(n.scrollTop,"vertical")}),ue(i,"scroll",function(){i.clientWidth&&t(i.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,B&&W<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Dn.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;if(r){this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0";var i=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=r?n+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(r?n:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+o)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(n==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?n:0,bottom:t?n:0}},Dn.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Dn.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Dn.prototype.zeroWidthHack=function(){var e=F&&!te?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new Et,this.disableVert=new Et},Dn.prototype.enableZeroWidthBar=function(e,t,r){e.style.visibility="";function n(){var i=e.getBoundingClientRect(),o=r=="vert"?document.elementFromPoint(i.right-1,(i.top+i.bottom)/2):document.elementFromPoint((i.right+i.left)/2,i.bottom-1);o!=e?e.style.visibility="hidden":t.set(1e3,n)}t.set(1e3,n)},Dn.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var qr=function(){};qr.prototype.update=function(){return{bottom:0,right:0}},qr.prototype.setScrollLeft=function(){},qr.prototype.setScrollTop=function(){},qr.prototype.clear=function(){};function or(e,t){t||(t=Rr(e));var r=e.display.barWidth,n=e.display.barHeight;js(e,t);for(var i=0;i<4&&r!=e.display.barWidth||n!=e.display.barHeight;i++)r!=e.display.barWidth&&e.options.lineWrapping&&Ci(e),js(e,Rr(e)),r=e.display.barWidth,n=e.display.barHeight}function js(e,t){var r=e.display,n=r.scrollbars.update(t);r.sizer.style.paddingRight=(r.barWidth=n.right)+"px",r.sizer.style.paddingBottom=(r.barHeight=n.bottom)+"px",r.heightForcer.style.borderBottom=n.bottom+"px solid transparent",n.right&&n.bottom?(r.scrollbarFiller.style.display="block",r.scrollbarFiller.style.height=n.bottom+"px",r.scrollbarFiller.style.width=n.right+"px"):r.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(r.gutterFiller.style.display="block",r.gutterFiller.style.height=n.bottom+"px",r.gutterFiller.style.width=t.gutterWidth+"px"):r.gutterFiller.style.display=""}var Xs={native:Dn,null:qr};function $s(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&J(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new Xs[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),ue(t,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,r){r=="horizontal"?Hn(e,t):Pr(e,t)},e),e.display.scrollbars.addClass&&Ee(e.display.wrapper,e.display.scrollbars.addClass)}var du=0;function Wn(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++du,markArrays:null},Ul(e.curOp)}function Fn(e){var t=e.curOp;t&&Kl(t,function(r){for(var n=0;n<r.ops.length;n++)r.ops[n].cm.curOp=null;hu(r)})}function hu(e){for(var t=e.ops,r=0;r<t.length;r++)pu(t[r]);for(var n=0;n<t.length;n++)vu(t[n]);for(var i=0;i<t.length;i++)gu(t[i]);for(var o=0;o<t.length;o++)mu(t[o]);for(var s=0;s<t.length;s++)yu(t[s])}function pu(e){var t=e.cm,r=t.display;wu(t),e.updateMaxLine&&oo(t),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<r.viewFrom||e.scrollToPos.to.line>=r.viewTo)||r.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new Ii(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function vu(e){e.updatedDisplay=e.mustUpdate&&Lo(e.cm,e.update)}function gu(e){var t=e.cm,r=t.display;e.updatedDisplay&&Ci(t),e.barMeasure=Rr(t),r.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Is(t,r.maxLine,r.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(r.scroller.clientWidth,r.sizer.offsetLeft+e.adjustWidthTo+Kt(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,r.sizer.offsetLeft+e.adjustWidthTo-Bn(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=r.input.prepareSelection())}function mu(e){var t=e.cm;e.adjustWidthTo!=null&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Hn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var r=e.focus&&e.focus==Te(yt(t));e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,r),(e.updatedDisplay||e.startHeight!=t.doc.height)&&or(t,e.barMeasure),e.updatedDisplay&&To(t,e.barMeasure),e.selectionChanged&&bo(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),r&&zs(e.cm)}function yu(e){var t=e.cm,r=t.display,n=t.doc;if(e.updatedDisplay&&Ys(t,e.update),r.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(r.wheelStartX=r.wheelStartY=null),e.scrollTop!=null&&Ks(t,e.scrollTop,e.forceScroll),e.scrollLeft!=null&&Hn(t,e.scrollLeft,!0,!0),e.scrollToPos){var i=uu(t,de(n,e.scrollToPos.from),de(n,e.scrollToPos.to),e.scrollToPos.margin);lu(t,i)}var o=e.maybeHiddenMarkers,s=e.maybeUnhiddenMarkers;if(o)for(var a=0;a<o.length;++a)o[a].lines.length||Ae(o[a],"hide");if(s)for(var l=0;l<s.length;++l)s[l].lines.length&&Ae(s[l],"unhide");r.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Ae(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function wt(e,t){if(e.curOp)return t();Wn(e);try{return t()}finally{Fn(e)}}function Xe(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Wn(e);try{return t.apply(e,arguments)}finally{Fn(e)}}}function at(e){return function(){if(this.curOp)return e.apply(this,arguments);Wn(this);try{return e.apply(this,arguments)}finally{Fn(this)}}}function $e(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Wn(t);try{return e.apply(this,arguments)}finally{Fn(t)}}}function _r(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,ae(bu,e))}function bu(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var r=+new Date+e.options.workTime,n=Br(e,t.highlightFrontier),i=[];t.iter(n.line,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(n.line>=e.display.viewFrom){var s=o.styles,a=o.text.length>e.options.maxHighlightLength?Ut(t.mode,n.state):null,l=ns(e,o,n,!0);a&&(n.state=a),o.styles=l.styles;var u=o.styleClasses,p=l.classes;p?o.styleClasses=p:u&&(o.styleClasses=null);for(var y=!s||s.length!=o.styles.length||u!=p&&(!u||!p||u.bgClass!=p.bgClass||u.textClass!=p.textClass),L=0;!y&&L<s.length;++L)y=s[L]!=o.styles[L];y&&i.push(n.line),o.stateAfter=n.save(),n.nextLine()}else o.text.length<=e.options.maxHighlightLength&&Vi(e,o.text,n),o.stateAfter=n.line%5==0?n.save():null,n.nextLine();if(+new Date>r)return _r(e,e.options.workDelay),!0}),t.highlightFrontier=n.line,t.modeFrontier=Math.max(t.modeFrontier,n.line),i.length&&wt(e,function(){for(var o=0;o<i.length;o++)mn(e,i[o],"text")})}}var Ii=function(e,t,r){var n=e.display;this.viewport=t,this.visible=Ei(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=Bn(e),this.force=r,this.dims=vo(e),this.events=[]};Ii.prototype.signal=function(e,t){bt(e,t)&&this.events.push(arguments)},Ii.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ae.apply(null,this.events[e])};function wu(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Kt(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Kt(e)+"px",t.scrollbarsClipped=!0)}function xu(e){if(e.hasFocus())return null;var t=Te(yt(e));if(!t||!Ce(e.display.lineDiv,t))return null;var r={activeElt:t};if(window.getSelection){var n=ce(e).getSelection();n.anchorNode&&n.extend&&Ce(e.display.lineDiv,n.anchorNode)&&(r.anchorNode=n.anchorNode,r.anchorOffset=n.anchorOffset,r.focusNode=n.focusNode,r.focusOffset=n.focusOffset)}return r}function Su(e){if(!(!e||!e.activeElt||e.activeElt==Te(Me(e.activeElt)))&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&Ce(document.body,e.anchorNode)&&Ce(document.body,e.focusNode))){var t=e.activeElt.ownerDocument,r=t.defaultView.getSelection(),n=t.createRange();n.setEnd(e.anchorNode,e.anchorOffset),n.collapse(!1),r.removeAllRanges(),r.addRange(n),r.extend(e.focusNode,e.focusOffset)}}function Lo(e,t){var r=e.display,n=e.doc;if(t.editorIsHidden)return yn(e),!1;if(!t.force&&t.visible.from>=r.viewFrom&&t.visible.to<=r.viewTo&&(r.updateLineNumbers==null||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&qs(e)==0)return!1;Zs(e)&&(yn(e),t.dims=vo(e));var i=n.first+n.size,o=Math.max(t.visible.from-e.options.viewportMargin,n.first),s=Math.min(i,t.visible.to+e.options.viewportMargin);r.viewFrom<o&&o-r.viewFrom<20&&(o=Math.max(n.first,r.viewFrom)),r.viewTo>s&&r.viewTo-s<20&&(s=Math.min(i,r.viewTo)),Vt&&(o=ro(e.doc,o),s=gs(e.doc,s));var a=o!=r.viewFrom||s!=r.viewTo||r.lastWrapHeight!=t.wrapperHeight||r.lastWrapWidth!=t.wrapperWidth;su(e,o,s),r.viewOffset=en(se(e.doc,r.viewFrom)),e.display.mover.style.top=r.viewOffset+"px";var l=qs(e);if(!a&&l==0&&!t.force&&r.renderedView==r.view&&(r.updateLineNumbers==null||r.updateLineNumbers>=r.viewTo))return!1;var u=xu(e);return l>4&&(r.lineDiv.style.display="none"),ku(e,r.updateLineNumbers,t.dims),l>4&&(r.lineDiv.style.display=""),r.renderedView=r.view,Su(u),M(r.cursorDiv),M(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,a&&(r.lastWrapHeight=t.wrapperHeight,r.lastWrapWidth=t.wrapperWidth,_r(e,400)),r.updateLineNumbers=null,!0}function Ys(e,t){for(var r=t.viewport,n=!0;;n=!1){if(!n||!e.options.lineWrapping||t.oldDisplayWidth==Bn(e)){if(r&&r.top!=null&&(r={top:Math.min(e.doc.height+ao(e.display)-lo(e),r.top)}),t.visible=Ei(e.display,e.doc,r),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break}else n&&(t.visible=Ei(e.display,e.doc,r));if(!Lo(e,t))break;Ci(e);var i=Rr(e);Wr(e),or(e,i),To(e,i),t.force=!1}t.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Co(e,t){var r=new Ii(e,t);if(Lo(e,r)){Ci(e),Ys(e,r);var n=Rr(e);Wr(e),or(e,n),To(e,n),r.finish()}}function ku(e,t,r){var n=e.display,i=e.options.lineNumbers,o=n.lineDiv,s=o.firstChild;function a(D){var _=D.nextSibling;return A&&F&&e.display.currentWheelTarget==D?D.style.display="none":D.parentNode.removeChild(D),_}for(var l=n.view,u=n.viewFrom,p=0;p<l.length;p++){var y=l[p];if(!y.hidden)if(!y.node||y.node.parentNode!=o){var L=Jl(e,y,u,r);o.insertBefore(L,s)}else{for(;s!=y.node;)s=a(s);var k=i&&t!=null&&t<=u&&y.lineNumber;y.changes&&(he(y.changes,"gutter")>-1&&(k=!1),xs(e,y,u,r)),k&&(M(y.lineNumber),y.lineNumber.appendChild(document.createTextNode(G(e.options,u)))),s=y.node.nextSibling}u+=y.size}for(;s;)s=a(s)}function Eo(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px",je(e,"gutterChanged",e)}function To(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Kt(e)+"px"}function Js(e){var t=e.display,r=t.view;if(!(!t.alignWidgets&&(!t.gutters.firstChild||!e.options.fixedGutter))){for(var n=go(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=n+"px",s=0;s<r.length;s++)if(!r[s].hidden){e.options.fixedGutter&&(r[s].gutter&&(r[s].gutter.style.left=o),r[s].gutterBackground&&(r[s].gutterBackground.style.left=o));var a=r[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=n+i+"px")}}function Zs(e){if(!e.options.lineNumbers)return!1;var t=e.doc,r=G(e.options,t.first+t.size-1),n=e.display;if(r.length!=n.lineNumChars){var i=n.measure.appendChild(g("div",[g("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=i.firstChild.offsetWidth,s=i.offsetWidth-o;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(o,n.lineGutter.offsetWidth-s)+1,n.lineNumWidth=n.lineNumInnerWidth+s,n.lineNumChars=n.lineNumInnerWidth?r.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",Eo(e.display),!0}return!1}function Io(e,t){for(var r=[],n=!1,i=0;i<e.length;i++){var o=e[i],s=null;if(typeof o!="string"&&(s=o.style,o=o.className),o=="CodeMirror-linenumbers")if(t)n=!0;else continue;r.push({className:o,style:s})}return t&&!n&&r.push({className:"CodeMirror-linenumbers",style:null}),r}function Qs(e){var t=e.gutters,r=e.gutterSpecs;M(t),e.lineGutter=null;for(var n=0;n<r.length;++n){var i=r[n],o=i.className,s=i.style,a=t.appendChild(g("div",null,"CodeMirror-gutter "+o));s&&(a.style.cssText=s),o=="CodeMirror-linenumbers"&&(e.lineGutter=a,a.style.width=(e.lineNumWidth||1)+"px")}t.style.display=r.length?"":"none",Eo(e)}function zr(e){Qs(e.display),ht(e),Js(e)}function Lu(e,t,r,n){var i=this;this.input=r,i.scrollbarFiller=g("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=g("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=ge("div",null,"CodeMirror-code"),i.selectionDiv=g("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=g("div",null,"CodeMirror-cursors"),i.measure=g("div",null,"CodeMirror-measure"),i.lineMeasure=g("div",null,"CodeMirror-measure"),i.lineSpace=ge("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none");var o=ge("div",[i.lineSpace],"CodeMirror-lines");i.mover=g("div",[o],null,"position: relative"),i.sizer=g("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=g("div",null,null,"position: absolute; height: "+Ue+"px; width: 1px;"),i.gutters=g("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=g("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=g("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),P&&$===105&&(i.wrapper.style.clipPath="inset(0px)"),i.wrapper.setAttribute("translate","no"),B&&W<8&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),!A&&!(w&&I)&&(i.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(i.wrapper):e(i.wrapper)),i.viewFrom=i.viewTo=t.first,i.reportedViewFrom=i.reportedViewTo=t.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,i.gutterSpecs=Io(n.gutters,n.lineNumbers),Qs(i),r.init(i)}var Mi=0,nn=null;B?nn=-.53:w?nn=15:P?nn=-.7:re&&(nn=-1/3);function Vs(e){var t=e.wheelDeltaX,r=e.wheelDeltaY;return t==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),r==null&&e.detail&&e.axis==e.VERTICAL_AXIS?r=e.detail:r==null&&(r=e.wheelDelta),{x:t,y:r}}function Cu(e){var t=Vs(e);return t.x*=nn,t.y*=nn,t}function ea(e,t){P&&$==102&&(e.display.chromeScrollHack==null?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout(function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""},100));var r=Vs(t),n=r.x,i=r.y,o=nn;t.deltaMode===0&&(n=t.deltaX,i=t.deltaY,o=1);var s=e.display,a=s.scroller,l=a.scrollWidth>a.clientWidth,u=a.scrollHeight>a.clientHeight;if(n&&l||i&&u){if(i&&F&&A){e:for(var p=t.target,y=s.view;p!=a;p=p.parentNode)for(var L=0;L<y.length;L++)if(y[L].node==p){e.display.currentWheelTarget=p;break e}}if(n&&!w&&!q&&o!=null){i&&u&&Pr(e,Math.max(0,a.scrollTop+i*o)),Hn(e,Math.max(0,a.scrollLeft+n*o)),(!i||i&&u)&&nt(t),s.wheelStartX=null;return}if(i&&o!=null){var k=i*o,D=e.doc.scrollTop,_=D+s.wrapper.clientHeight;k<0?D=Math.max(0,D+k-50):_=Math.min(e.doc.height,_+k+50),Co(e,{top:D,bottom:_})}Mi<20&&t.deltaMode!==0&&(s.wheelStartX==null?(s.wheelStartX=a.scrollLeft,s.wheelStartY=a.scrollTop,s.wheelDX=n,s.wheelDY=i,setTimeout(function(){if(s.wheelStartX!=null){var K=a.scrollLeft-s.wheelStartX,Q=a.scrollTop-s.wheelStartY,ne=Q&&s.wheelDY&&Q/s.wheelDY||K&&s.wheelDX&&K/s.wheelDX;s.wheelStartX=s.wheelStartY=null,ne&&(nn=(nn*Mi+ne)/(Mi+1),++Mi)}},200)):(s.wheelDX+=n,s.wheelDY+=i))}}var Ct=function(e,t){this.ranges=e,this.primIndex=t};Ct.prototype.primary=function(){return this.ranges[this.primIndex]},Ct.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var r=this.ranges[t],n=e.ranges[t];if(!we(r.anchor,n.anchor)||!we(r.head,n.head))return!1}return!0},Ct.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new xe(Ke(this.ranges[t].anchor),Ke(this.ranges[t].head));return new Ct(e,this.primIndex)},Ct.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Ct.prototype.contains=function(e,t){t||(t=e);for(var r=0;r<this.ranges.length;r++){var n=this.ranges[r];if(ee(t,n.from())>=0&&ee(e,n.to())<=0)return r}return-1};var xe=function(e,t){this.anchor=e,this.head=t};xe.prototype.from=function(){return Zn(this.anchor,this.head)},xe.prototype.to=function(){return dt(this.anchor,this.head)},xe.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function Pt(e,t,r){var n=e&&e.options.selectionsMayTouch,i=t[r];t.sort(function(L,k){return ee(L.from(),k.from())}),r=he(t,i);for(var o=1;o<t.length;o++){var s=t[o],a=t[o-1],l=ee(a.to(),s.from());if(n&&!s.empty()?l>0:l>=0){var u=Zn(a.from(),s.from()),p=dt(a.to(),s.to()),y=a.empty()?s.from()==s.head:a.from()==a.head;o<=r&&--r,t.splice(--o,2,new xe(y?p:u,y?u:p))}}return new Ct(t,r)}function bn(e,t){return new Ct([new xe(e,t||e)],0)}function wn(e){return e.text?N(e.from.line+e.text.length-1,me(e.text).length+(e.text.length==1?e.from.ch:0)):e.to}function ta(e,t){if(ee(e,t.from)<0)return e;if(ee(e,t.to)<=0)return wn(t);var r=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=wn(t).ch-t.to.ch),N(r,n)}function Mo(e,t){for(var r=[],n=0;n<e.sel.ranges.length;n++){var i=e.sel.ranges[n];r.push(new xe(ta(i.anchor,t),ta(i.head,t)))}return Pt(e.cm,r,e.sel.primIndex)}function na(e,t,r){return e.line==t.line?N(r.line,e.ch-t.ch+r.ch):N(r.line+(e.line-t.line),e.ch)}function Eu(e,t,r){for(var n=[],i=N(e.first,0),o=i,s=0;s<t.length;s++){var a=t[s],l=na(a.from,i,o),u=na(wn(a),i,o);if(i=a.to,o=u,r=="around"){var p=e.sel.ranges[s],y=ee(p.head,p.anchor)<0;n[s]=new xe(y?u:l,y?l:u)}else n[s]=new xe(l,l)}return new Ct(n,e.sel.primIndex)}function Bo(e){e.doc.mode=$n(e.options,e.doc.modeOption),Ur(e)}function Ur(e){e.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,_r(e,100),e.state.modeGen++,e.curOp&&ht(e)}function ra(e,t){return t.from.ch==0&&t.to.ch==0&&me(t.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Oo(e,t,r,n){function i(ne){return r?r[ne]:null}function o(ne,V,ie){Hl(ne,V,ie,n),je(ne,"change",ne,t)}function s(ne,V){for(var ie=[],fe=ne;fe<V;++fe)ie.push(new Qn(u[fe],i(fe),n));return ie}var a=t.from,l=t.to,u=t.text,p=se(e,a.line),y=se(e,l.line),L=me(u),k=i(u.length-1),D=l.line-a.line;if(t.full)e.insert(0,s(0,u.length)),e.remove(u.length,e.size-u.length);else if(ra(e,t)){var _=s(0,u.length-1);o(y,y.text,k),D&&e.remove(a.line,D),_.length&&e.insert(a.line,_)}else if(p==y)if(u.length==1)o(p,p.text.slice(0,a.ch)+L+p.text.slice(l.ch),k);else{var K=s(1,u.length-1);K.push(new Qn(L+p.text.slice(l.ch),k,n)),o(p,p.text.slice(0,a.ch)+u[0],i(0)),e.insert(a.line+1,K)}else if(u.length==1)o(p,p.text.slice(0,a.ch)+u[0]+y.text.slice(l.ch),i(0)),e.remove(a.line+1,D);else{o(p,p.text.slice(0,a.ch)+u[0],i(0)),o(y,L+y.text.slice(l.ch),k);var Q=s(1,u.length-1);D>1&&e.remove(a.line+1,D-1),e.insert(a.line+1,Q)}je(e,"change",e,t)}function xn(e,t,r){function n(i,o,s){if(i.linked)for(var a=0;a<i.linked.length;++a){var l=i.linked[a];if(l.doc!=o){var u=s&&l.sharedHist;r&&!u||(t(l.doc,u),n(l.doc,i,u))}}}n(e,null,!0)}function ia(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,mo(e),Bo(e),oa(e),e.options.direction=t.direction,e.options.lineWrapping||oo(e),e.options.mode=t.modeOption,ht(e)}function oa(e){(e.doc.direction=="rtl"?Ee:J)(e.display.lineDiv,"CodeMirror-rtl")}function Tu(e){wt(e,function(){oa(e),ht(e)})}function Bi(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function Ao(e,t){var r={from:Ke(t.from),to:wn(t),text:Qt(e,t.from,t.to)};return la(e,r,t.from.line,t.to.line+1),xn(e,function(n){return la(n,r,t.from.line,t.to.line+1)},!0),r}function sa(e){for(;e.length;){var t=me(e);if(t.ranges)e.pop();else break}}function Iu(e,t){if(t)return sa(e.done),me(e.done);if(e.done.length&&!me(e.done).ranges)return me(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),me(e.done)}function aa(e,t,r,n){var i=e.history;i.undone.length=0;var o=+new Date,s,a;if((i.lastOp==n||i.lastOrigin==t.origin&&t.origin&&(t.origin.charAt(0)=="+"&&i.lastModTime>o-(e.cm?e.cm.options.historyEventDelay:500)||t.origin.charAt(0)=="*"))&&(s=Iu(i,i.lastOp==n)))a=me(s.changes),ee(t.from,t.to)==0&&ee(t.from,a.to)==0?a.to=wn(t):s.changes.push(Ao(e,t));else{var l=me(i.done);for((!l||!l.ranges)&&Oi(e.sel,i.done),s={changes:[Ao(e,t)],generation:i.generation},i.done.push(s);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(r),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=o,i.lastOp=i.lastSelOp=n,i.lastOrigin=i.lastSelOrigin=t.origin,a||Ae(e,"historyAdded")}function Mu(e,t,r,n){var i=t.charAt(0);return i=="*"||i=="+"&&r.ranges.length==n.ranges.length&&r.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function Bu(e,t,r,n){var i=e.history,o=n&&n.origin;r==i.lastSelOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||Mu(e,o,me(i.done),t))?i.done[i.done.length-1]=t:Oi(t,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastSelOp=r,n&&n.clearRedo!==!1&&sa(i.undone)}function Oi(e,t){var r=me(t);r&&r.ranges&&r.equals(e)||t.push(e)}function la(e,t,r,n){var i=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,r),Math.min(e.first+e.size,n),function(s){s.markedSpans&&((i||(i=t["spans_"+e.id]={}))[o]=s.markedSpans),++o})}function Ou(e){if(!e)return null;for(var t,r=0;r<e.length;++r)e[r].marker.explicitlyCleared?t||(t=e.slice(0,r)):t&&t.push(e[r]);return t?t.length?t:null:e}function Au(e,t){var r=t["spans_"+e.id];if(!r)return null;for(var n=[],i=0;i<t.text.length;++i)n.push(Ou(r[i]));return n}function ua(e,t){var r=Au(e,t),n=to(e,t);if(!r)return n;if(!n)return r;for(var i=0;i<r.length;++i){var o=r[i],s=n[i];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],u=0;u<o.length;++u)if(o[u].marker==l.marker)continue e;o.push(l)}else s&&(r[i]=s)}return r}function sr(e,t,r){for(var n=[],i=0;i<e.length;++i){var o=e[i];if(o.ranges){n.push(r?Ct.prototype.deepCopy.call(o):o);continue}var s=o.changes,a=[];n.push({changes:a});for(var l=0;l<s.length;++l){var u=s[l],p=void 0;if(a.push({from:u.from,to:u.to,text:u.text}),t)for(var y in u)(p=y.match(/^spans_(\d+)$/))&&he(t,Number(p[1]))>-1&&(me(a)[y]=u[y],delete u[y])}}return n}function No(e,t,r,n){if(n){var i=e.anchor;if(r){var o=ee(t,i)<0;o!=ee(r,i)<0?(i=t,t=r):o!=ee(t,r)<0&&(t=r)}return new xe(i,t)}else return new xe(r||t,t)}function Ai(e,t,r,n,i){i==null&&(i=e.cm&&(e.cm.display.shift||e.extend)),rt(e,new Ct([No(e.sel.primary(),t,r,i)],0),n)}function fa(e,t,r){for(var n=[],i=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)n[o]=No(e.sel.ranges[o],t[o],null,i);var s=Pt(e.cm,n,e.sel.primIndex);rt(e,s,r)}function Ho(e,t,r,n){var i=e.sel.ranges.slice(0);i[t]=r,rt(e,Pt(e.cm,i,e.sel.primIndex),n)}function ca(e,t,r,n){rt(e,bn(t,r),n)}function Nu(e,t,r){var n={ranges:t.ranges,update:function(i){this.ranges=[];for(var o=0;o<i.length;o++)this.ranges[o]=new xe(de(e,i[o].anchor),de(e,i[o].head))},origin:r&&r.origin};return Ae(e,"beforeSelectionChange",e,n),e.cm&&Ae(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?Pt(e.cm,n.ranges,n.ranges.length-1):t}function da(e,t,r){var n=e.history.done,i=me(n);i&&i.ranges?(n[n.length-1]=t,Ni(e,t,r)):rt(e,t,r)}function rt(e,t,r){Ni(e,t,r),Bu(e,e.sel,e.cm?e.cm.curOp.id:NaN,r)}function Ni(e,t,r){(bt(e,"beforeSelectionChange")||e.cm&&bt(e.cm,"beforeSelectionChange"))&&(t=Nu(e,t,r));var n=r&&r.bias||(ee(t.primary().head,e.sel.primary().head)<0?-1:1);ha(e,va(e,t,n,!0)),!(r&&r.scroll===!1)&&e.cm&&e.cm.getOption("readOnly")!="nocursor"&&ir(e.cm)}function ha(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,Tt(e.cm)),je(e,"cursorActivity",e))}function pa(e){ha(e,va(e,e.sel,null,!1))}function va(e,t,r,n){for(var i,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=Hi(e,s.anchor,a&&a.anchor,r,n),u=s.head==s.anchor?l:Hi(e,s.head,a&&a.head,r,n);(i||l!=s.anchor||u!=s.head)&&(i||(i=t.ranges.slice(0,o)),i[o]=new xe(l,u))}return i?Pt(e.cm,i,t.primIndex):t}function ar(e,t,r,n,i){var o=se(e,t.line);if(o.markedSpans)for(var s=0;s<o.markedSpans.length;++s){var a=o.markedSpans[s],l=a.marker,u="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,p="selectRight"in l?!l.selectRight:l.inclusiveRight;if((a.from==null||(u?a.from<=t.ch:a.from<t.ch))&&(a.to==null||(p?a.to>=t.ch:a.to>t.ch))){if(i&&(Ae(l,"beforeCursorEnter"),l.explicitlyCleared))if(o.markedSpans){--s;continue}else break;if(!l.atomic)continue;if(r){var y=l.find(n<0?1:-1),L=void 0;if((n<0?p:u)&&(y=ga(e,y,-n,y&&y.line==t.line?o:null)),y&&y.line==t.line&&(L=ee(y,r))&&(n<0?L<0:L>0))return ar(e,y,t,n,i)}var k=l.find(n<0?-1:1);return(n<0?u:p)&&(k=ga(e,k,n,k.line==t.line?o:null)),k?ar(e,k,t,n,i):null}}return t}function Hi(e,t,r,n,i){var o=n||1,s=ar(e,t,r,o,i)||!i&&ar(e,t,r,o,!0)||ar(e,t,r,-o,i)||!i&&ar(e,t,r,-o,!0);return s||(e.cantEdit=!0,N(e.first,0))}function ga(e,t,r,n){return r<0&&t.ch==0?t.line>e.first?de(e,N(t.line-1)):null:r>0&&t.ch==(n||se(e,t.line)).text.length?t.line<e.first+e.size-1?N(t.line+1,0):null:new N(t.line,t.ch+r)}function ma(e){e.setSelection(N(e.firstLine(),0),N(e.lastLine()),Qe)}function ya(e,t,r){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return n.canceled=!0}};return r&&(n.update=function(i,o,s,a){i&&(n.from=de(e,i)),o&&(n.to=de(e,o)),s&&(n.text=s),a!==void 0&&(n.origin=a)}),Ae(e,"beforeChange",e,n),e.cm&&Ae(e.cm,"beforeChange",e.cm,n),n.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:n.from,to:n.to,text:n.text,origin:n.origin}}function lr(e,t,r){if(e.cm){if(!e.cm.curOp)return Xe(e.cm,lr)(e,t,r);if(e.cm.state.suppressEdits)return}if(!((bt(e,"beforeChange")||e.cm&&bt(e.cm,"beforeChange"))&&(t=ya(e,t,!0),!t))){var n=us&&!r&&Bl(e,t.from,t.to);if(n)for(var i=n.length-1;i>=0;--i)ba(e,{from:n[i].from,to:n[i].to,text:i?[""]:t.text,origin:t.origin});else ba(e,t)}}function ba(e,t){if(!(t.text.length==1&&t.text[0]==""&&ee(t.from,t.to)==0)){var r=Mo(e,t);aa(e,t,r,e.cm?e.cm.curOp.id:NaN),Gr(e,t,r,to(e,t));var n=[];xn(e,function(i,o){!o&&he(n,i.history)==-1&&(ka(i.history,t),n.push(i.history)),Gr(i,t,null,to(i,t))})}}function Di(e,t,r){var n=e.cm&&e.cm.state.suppressEdits;if(!(n&&!r)){for(var i=e.history,o,s=e.sel,a=t=="undo"?i.done:i.undone,l=t=="undo"?i.undone:i.done,u=0;u<a.length&&(o=a[u],!(r?o.ranges&&!o.equals(e.sel):!o.ranges));u++);if(u!=a.length){for(i.lastOrigin=i.lastSelOrigin=null;;)if(o=a.pop(),o.ranges){if(Oi(o,l),r&&!o.equals(e.sel)){rt(e,o,{clearRedo:!1});return}s=o}else if(n){a.push(o);return}else break;var p=[];Oi(s,l),l.push({changes:p,generation:i.generation}),i.generation=o.generation||++i.maxGeneration;for(var y=bt(e,"beforeChange")||e.cm&&bt(e.cm,"beforeChange"),L=function(_){var K=o.changes[_];if(K.origin=t,y&&!ya(e,K,!1))return a.length=0,{};p.push(Ao(e,K));var Q=_?Mo(e,K):me(a);Gr(e,K,Q,ua(e,K)),!_&&e.cm&&e.cm.scrollIntoView({from:K.from,to:wn(K)});var ne=[];xn(e,function(V,ie){!ie&&he(ne,V.history)==-1&&(ka(V.history,K),ne.push(V.history)),Gr(V,K,null,ua(V,K))})},k=o.changes.length-1;k>=0;--k){var D=L(k);if(D)return D.v}}}}function wa(e,t){if(t!=0&&(e.first+=t,e.sel=new Ct(Tn(e.sel.ranges,function(i){return new xe(N(i.anchor.line+t,i.anchor.ch),N(i.head.line+t,i.head.ch))}),e.sel.primIndex),e.cm)){ht(e.cm,e.first,e.first-t,t);for(var r=e.cm.display,n=r.viewFrom;n<r.viewTo;n++)mn(e.cm,n,"gutter")}}function Gr(e,t,r,n){if(e.cm&&!e.cm.curOp)return Xe(e.cm,Gr)(e,t,r,n);if(t.to.line<e.first){wa(e,t.text.length-1-(t.to.line-t.from.line));return}if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);wa(e,i),t={from:N(e.first,0),to:N(t.to.line+i,t.to.ch),text:[me(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:N(o,se(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Qt(e,t.from,t.to),r||(r=Mo(e,t)),e.cm?Hu(e.cm,t,n):Oo(e,t,n),Ni(e,r,Qe),e.cantEdit&&Hi(e,N(e.firstLine(),0))&&(e.cantEdit=!1)}}function Hu(e,t,r){var n=e.doc,i=e.display,o=t.from,s=t.to,a=!1,l=o.line;e.options.lineWrapping||(l=f(Wt(se(n,o.line))),n.iter(l,s.line+1,function(k){if(k==i.maxLine)return a=!0,!0})),n.sel.contains(t.from,t.to)>-1&&Tt(e),Oo(n,t,r,Rs(e)),e.options.lineWrapping||(n.iter(l,o.line+t.text.length,function(k){var D=yi(k);D>i.maxLineLength&&(i.maxLine=k,i.maxLineLength=D,i.maxLineChanged=!0,a=!1)}),a&&(e.curOp.updateMaxLine=!0)),kl(n,o.line),_r(e,400);var u=t.text.length-(s.line-o.line)-1;t.full?ht(e):o.line==s.line&&t.text.length==1&&!ra(e.doc,t)?mn(e,o.line,"text"):ht(e,o.line,s.line+1,u);var p=bt(e,"changes"),y=bt(e,"change");if(y||p){var L={from:o,to:s,text:t.text,removed:t.removed,origin:t.origin};y&&je(e,"change",e,L),p&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(L)}e.display.selForContextMenu=null}function ur(e,t,r,n,i){var o;n||(n=r),ee(n,r)<0&&(o=[n,r],r=o[0],n=o[1]),typeof t=="string"&&(t=e.splitLines(t)),lr(e,{from:r,to:n,text:t,origin:i})}function xa(e,t,r,n){r<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function Sa(e,t,r,n){for(var i=0;i<e.length;++i){var o=e[i],s=!0;if(o.ranges){o.copied||(o=e[i]=o.deepCopy(),o.copied=!0);for(var a=0;a<o.ranges.length;a++)xa(o.ranges[a].anchor,t,r,n),xa(o.ranges[a].head,t,r,n);continue}for(var l=0;l<o.changes.length;++l){var u=o.changes[l];if(r<u.from.line)u.from=N(u.from.line+n,u.from.ch),u.to=N(u.to.line+n,u.to.ch);else if(t<=u.to.line){s=!1;break}}s||(e.splice(0,i+1),i=0)}}function ka(e,t){var r=t.from.line,n=t.to.line,i=t.text.length-(n-r)-1;Sa(e.done,r,n,i),Sa(e.undone,r,n,i)}function Kr(e,t,r,n){var i=t,o=t;return typeof t=="number"?o=se(e,es(e,t)):i=f(t),i==null?null:(n(o,i)&&e.cm&&mn(e.cm,i,r),o)}function jr(e){this.lines=e,this.parent=null;for(var t=0,r=0;r<e.length;++r)e[r].parent=this,t+=e[r].height;this.height=t}jr.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var r=e,n=e+t;r<n;++r){var i=this.lines[r];this.height-=i.height,Dl(i),je(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,r){this.height+=r,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,r){for(var n=e+t;e<n;++e)if(r(this.lines[e]))return!0}};function Xr(e){this.children=e;for(var t=0,r=0,n=0;n<e.length;++n){var i=e[n];t+=i.chunkSize(),r+=i.height,i.parent=this}this.size=t,this.height=r,this.parent=null}Xr.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var r=0;r<this.children.length;++r){var n=this.children[r],i=n.chunkSize();if(e<i){var o=Math.min(t,i-e),s=n.height;if(n.removeInner(e,o),this.height-=s-n.height,i==o&&(this.children.splice(r--,1),n.parent=null),(t-=o)==0)break;e=0}else e-=i}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof jr))){var a=[];this.collapse(a),this.children=[new jr(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,r){this.size+=t.length,this.height+=r;for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<=o){if(i.insertInner(e,t,r),i.lines&&i.lines.length>50){for(var s=i.lines.length%25+25,a=s;a<i.lines.length;){var l=new jr(i.lines.slice(a,a+=25));i.height-=l.height,this.children.splice(++n,0,l),l.parent=this}i.lines=i.lines.slice(0,s),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),r=new Xr(t);if(e.parent){e.size-=r.size,e.height-=r.height;var i=he(e.parent.children,e);e.parent.children.splice(i+1,0,r)}else{var n=new Xr(e.children);n.parent=e,e.children=[n,r],e=n}r.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,r){for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<o){var s=Math.min(t,o-e);if(i.iterN(e,s,r))return!0;if((t-=s)==0)break;e=0}else e-=o}}};var $r=function(e,t,r){if(r)for(var n in r)r.hasOwnProperty(n)&&(this[n]=r[n]);this.doc=e,this.node=t};$r.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,r=this.line,n=f(r);if(!(n==null||!t)){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(r.widgets=null);var o=Hr(this);Lt(r,Math.max(0,r.height-o)),e&&(wt(e,function(){La(e,r,-o),mn(e,n,"widget")}),je(e,"lineWidgetCleared",e,this,n))}},$r.prototype.changed=function(){var e=this,t=this.height,r=this.doc.cm,n=this.line;this.height=null;var i=Hr(this)-t;i&&(gn(this.doc,n)||Lt(n,n.height+i),r&&wt(r,function(){r.curOp.forceUpdate=!0,La(r,n,i),je(r,"lineWidgetChanged",r,e,f(n))}))},Ot($r);function La(e,t,r){en(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&ko(e,r)}function Du(e,t,r,n){var i=new $r(e,r,n),o=e.cm;return o&&i.noHScroll&&(o.display.alignWidgets=!0),Kr(e,t,"widget",function(s){var a=s.widgets||(s.widgets=[]);if(i.insertAt==null?a.push(i):a.splice(Math.min(a.length,Math.max(0,i.insertAt)),0,i),i.line=s,o&&!gn(e,s)){var l=en(s)<e.scrollTop;Lt(s,s.height+Hr(i)),l&&ko(o,i.height),o.curOp.forceUpdate=!0}return!0}),o&&je(o,"lineWidgetAdded",o,i,typeof t=="number"?t:f(t)),i}var Ca=0,Sn=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++Ca};Sn.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Wn(e),bt(this,"clear")){var r=this.find();r&&je(this,"clear",r.from,r.to)}for(var n=null,i=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=Or(s.markedSpans,this);e&&!this.collapsed?mn(e,f(s),"text"):e&&(a.to!=null&&(i=f(s)),a.from!=null&&(n=f(s))),s.markedSpans=El(s.markedSpans,a),a.from==null&&this.collapsed&&!gn(this.doc,s)&&e&&Lt(s,tr(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var u=Wt(this.lines[l]),p=yi(u);p>e.display.maxLineLength&&(e.display.maxLine=u,e.display.maxLineLength=p,e.display.maxLineChanged=!0)}n!=null&&e&&this.collapsed&&ht(e,n,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&pa(e.doc)),e&&je(e,"markerCleared",e,this,n,i),t&&Fn(e),this.parent&&this.parent.clear()}},Sn.prototype.find=function(e,t){e==null&&this.type=="bookmark"&&(e=1);for(var r,n,i=0;i<this.lines.length;++i){var o=this.lines[i],s=Or(o.markedSpans,this);if(s.from!=null&&(r=N(t?o:f(o),s.from),e==-1))return r;if(s.to!=null&&(n=N(t?o:f(o),s.to),e==1))return n}return r&&{from:r,to:n}},Sn.prototype.changed=function(){var e=this,t=this.find(-1,!0),r=this,n=this.doc.cm;!t||!n||wt(n,function(){var i=t.line,o=f(t.line),s=uo(n,o);if(s&&(Os(s),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!gn(r.doc,i)&&r.height!=null){var a=r.height;r.height=null;var l=Hr(r)-a;l&&Lt(i,i.height+l)}je(n,"markerChanged",n,e)})},Sn.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(!t.maybeHiddenMarkers||he(t.maybeHiddenMarkers,this)==-1)&&(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Sn.prototype.detachLine=function(e){if(this.lines.splice(he(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},Ot(Sn);function fr(e,t,r,n,i){if(n&&n.shared)return Wu(e,t,r,n,i);if(e.cm&&!e.cm.curOp)return Xe(e.cm,fr)(e,t,r,n,i);var o=new Sn(e,i),s=ee(t,r);if(n&&pe(n,o,!1),s>0||s==0&&o.clearWhenEmpty!==!1)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=ge("span",[o.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),n.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(vs(e,t.line,t,r,o)||t.line!=r.line&&vs(e,r.line,t,r,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");Cl()}o.addToHistory&&aa(e,{from:t,to:r,origin:"markText"},e.sel,NaN);var a=t.line,l=e.cm,u;if(e.iter(a,r.line+1,function(y){l&&o.collapsed&&!l.options.lineWrapping&&Wt(y)==l.display.maxLine&&(u=!0),o.collapsed&&a!=t.line&&Lt(y,0),Tl(y,new pi(o,a==t.line?t.ch:null,a==r.line?r.ch:null),e.cm&&e.cm.curOp),++a}),o.collapsed&&e.iter(t.line,r.line+1,function(y){gn(e,y)&&Lt(y,0)}),o.clearOnEnter&&ue(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(Ll(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++Ca,o.atomic=!0),l){if(u&&(l.curOp.updateMaxLine=!0),o.collapsed)ht(l,t.line,r.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var p=t.line;p<=r.line;p++)mn(l,p,"text");o.atomic&&pa(l.doc),je(l,"markerAdded",l,o)}return o}var Yr=function(e,t){this.markers=e,this.primary=t;for(var r=0;r<e.length;++r)e[r].parent=this};Yr.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();je(this,"clear")}},Yr.prototype.find=function(e,t){return this.primary.find(e,t)},Ot(Yr);function Wu(e,t,r,n,i){n=pe(n),n.shared=!1;var o=[fr(e,t,r,n,i)],s=o[0],a=n.widgetNode;return xn(e,function(l){a&&(n.widgetNode=a.cloneNode(!0)),o.push(fr(l,de(l,t),de(l,r),n,i));for(var u=0;u<l.linked.length;++u)if(l.linked[u].isParent)return;s=me(o)}),new Yr(o,s)}function Ea(e){return e.findMarks(N(e.first,0),e.clipPos(N(e.lastLine())),function(t){return t.parent})}function Fu(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.find(),o=e.clipPos(i.from),s=e.clipPos(i.to);if(ee(o,s)){var a=fr(e,o,s,n.primary,n.primary.type);n.markers.push(a),a.parent=n}}}function Pu(e){for(var t=function(n){var i=e[n],o=[i.primary.doc];xn(i.primary.doc,function(l){return o.push(l)});for(var s=0;s<i.markers.length;s++){var a=i.markers[s];he(o,a.doc)==-1&&(a.parent=null,i.markers.splice(s--,1))}},r=0;r<e.length;r++)t(r)}var Ru=0,pt=function(e,t,r,n,i){if(!(this instanceof pt))return new pt(e,t,r,n,i);r==null&&(r=0),Xr.call(this,[new jr([new Qn("",null)])]),this.first=r,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=r;var o=N(r,0);this.sel=bn(o),this.history=new Bi(null),this.id=++Ru,this.modeOption=t,this.lineSep=n,this.direction=i=="rtl"?"rtl":"ltr",this.extend=!1,typeof e=="string"&&(e=this.splitLines(e)),Oo(this,{from:o,to:o,text:e}),rt(this,bn(o),Qe)};pt.prototype=li(Xr.prototype,{constructor:pt,iter:function(e,t,r){r?this.iterN(e-this.first,t-e,r):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var r=0,n=0;n<t.length;++n)r+=t[n].height;this.insertInner(e-this.first,t,r)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Mr(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:$e(function(e){var t=N(this.first,0),r=this.first+this.size-1;lr(this,{from:t,to:N(r,se(this,r).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&Fr(this.cm,0,0),rt(this,bn(t),Qe)}),replaceRange:function(e,t,r,n){t=de(this,t),r=r?de(this,r):t,ur(this,e,t,r,n)},getRange:function(e,t,r){var n=Qt(this,de(this,e),de(this,t));return r===!1?n:r===""?n.join(""):n.join(r||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(R(this,e))return se(this,e)},getLineNumber:function(e){return f(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=se(this,e)),Wt(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return de(this,e)},getCursor:function(e){var t=this.sel.primary(),r;return e==null||e=="head"?r=t.head:e=="anchor"?r=t.anchor:e=="end"||e=="to"||e===!1?r=t.to():r=t.from(),r},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:$e(function(e,t,r){ca(this,de(this,typeof e=="number"?N(e,t||0):e),null,r)}),setSelection:$e(function(e,t,r){ca(this,de(this,e),de(this,t||e),r)}),extendSelection:$e(function(e,t,r){Ai(this,de(this,e),t&&de(this,t),r)}),extendSelections:$e(function(e,t){fa(this,ts(this,e),t)}),extendSelectionsBy:$e(function(e,t){var r=Tn(this.sel.ranges,e);fa(this,ts(this,r),t)}),setSelections:$e(function(e,t,r){if(e.length){for(var n=[],i=0;i<e.length;i++)n[i]=new xe(de(this,e[i].anchor),de(this,e[i].head||e[i].anchor));t==null&&(t=Math.min(e.length-1,this.sel.primIndex)),rt(this,Pt(this.cm,n,t),r)}}),addSelection:$e(function(e,t,r){var n=this.sel.ranges.slice(0);n.push(new xe(de(this,e),de(this,t||e))),rt(this,Pt(this.cm,n,n.length-1),r)}),getSelection:function(e){for(var t=this.sel.ranges,r,n=0;n<t.length;n++){var i=Qt(this,t[n].from(),t[n].to());r=r?r.concat(i):i}return e===!1?r:r.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],r=this.sel.ranges,n=0;n<r.length;n++){var i=Qt(this,r[n].from(),r[n].to());e!==!1&&(i=i.join(e||this.lineSeparator())),t[n]=i}return t},replaceSelection:function(e,t,r){for(var n=[],i=0;i<this.sel.ranges.length;i++)n[i]=e;this.replaceSelections(n,t,r||"+input")},replaceSelections:$e(function(e,t,r){for(var n=[],i=this.sel,o=0;o<i.ranges.length;o++){var s=i.ranges[o];n[o]={from:s.from(),to:s.to(),text:this.splitLines(e[o]),origin:r}}for(var a=t&&t!="end"&&Eu(this,n,t),l=n.length-1;l>=0;l--)lr(this,n[l]);a?da(this,a):this.cm&&ir(this.cm)}),undo:$e(function(){Di(this,"undo")}),redo:$e(function(){Di(this,"redo")}),undoSelection:$e(function(){Di(this,"undo",!0)}),redoSelection:$e(function(){Di(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,r=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++r;return{undo:t,redo:r}},clearHistory:function(){var e=this;this.history=new Bi(this.history),xn(this,function(t){return t.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:sr(this.history.done),undone:sr(this.history.undone)}},setHistory:function(e){var t=this.history=new Bi(this.history);t.done=sr(e.done.slice(0),null,!0),t.undone=sr(e.undone.slice(0),null,!0)},setGutterMarker:$e(function(e,t,r){return Kr(this,e,"gutter",function(n){var i=n.gutterMarkers||(n.gutterMarkers={});return i[t]=r,!r&&ui(i)&&(n.gutterMarkers=null),!0})}),clearGutter:$e(function(e){var t=this;this.iter(function(r){r.gutterMarkers&&r.gutterMarkers[e]&&Kr(t,r,"gutter",function(){return r.gutterMarkers[e]=null,ui(r.gutterMarkers)&&(r.gutterMarkers=null),!0})})}),lineInfo:function(e){var t;if(typeof e=="number"){if(!R(this,e)||(t=e,e=se(this,e),!e))return null}else if(t=f(e),t==null)return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:$e(function(e,t,r){return Kr(this,e,t=="gutter"?"gutter":"class",function(n){var i=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass";if(!n[i])n[i]=r;else{if(Y(r).test(n[i]))return!1;n[i]+=" "+r}return!0})}),removeLineClass:$e(function(e,t,r){return Kr(this,e,t=="gutter"?"gutter":"class",function(n){var i=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass",o=n[i];if(o)if(r==null)n[i]=null;else{var s=o.match(Y(r));if(!s)return!1;var a=s.index+s[0].length;n[i]=o.slice(0,s.index)+(!s.index||a==o.length?"":" ")+o.slice(a)||null}else return!1;return!0})}),addLineWidget:$e(function(e,t,r){return Du(this,e,t,r)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,r){return fr(this,de(this,e),de(this,t),r,r&&r.type||"range")},setBookmark:function(e,t){var r={replacedWith:t&&(t.nodeType==null?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=de(this,e),fr(this,e,e,r,"bookmark")},findMarksAt:function(e){e=de(this,e);var t=[],r=se(this,e.line).markedSpans;if(r)for(var n=0;n<r.length;++n){var i=r[n];(i.from==null||i.from<=e.ch)&&(i.to==null||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,r){e=de(this,e),t=de(this,t);var n=[],i=e.line;return this.iter(e.line,t.line+1,function(o){var s=o.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];!(l.to!=null&&i==e.line&&e.ch>=l.to||l.from==null&&i!=e.line||l.from!=null&&i==t.line&&l.from>=t.ch)&&(!r||r(l.marker))&&n.push(l.marker.parent||l.marker)}++i}),n},getAllMarks:function(){var e=[];return this.iter(function(t){var r=t.markedSpans;if(r)for(var n=0;n<r.length;++n)r[n].from!=null&&e.push(r[n].marker)}),e},posFromIndex:function(e){var t,r=this.first,n=this.lineSeparator().length;return this.iter(function(i){var o=i.text.length+n;if(o>e)return t=e,!0;e-=o,++r}),de(this,N(r,t))},indexFromPos:function(e){e=de(this,e);var t=e.ch;if(e.line<this.first||e.ch<0)return 0;var r=this.lineSeparator().length;return this.iter(this.first,e.line,function(n){t+=n.text.length+r}),t},copy:function(e){var t=new pt(Mr(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,r=this.first+this.size;e.from!=null&&e.from>t&&(t=e.from),e.to!=null&&e.to<r&&(r=e.to);var n=new pt(Mr(this,t,r),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Fu(n,Ea(this)),n},unlinkDoc:function(e){if(e instanceof Ie&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){var r=this.linked[t];if(r.doc==e){this.linked.splice(t,1),e.unlinkDoc(this),Pu(Ea(this));break}}if(e.history==this.history){var n=[e.id];xn(e,function(i){return n.push(i.id)},!0),e.history=new Bi(null),e.history.done=sr(this.history.done,n),e.history.undone=sr(this.history.undone,n)}},iterLinkedDocs:function(e){xn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):It(e)},lineSeparator:function(){return this.lineSep||`
`},setDirection:$e(function(e){e!="rtl"&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(t){return t.order=null}),this.cm&&Tu(this.cm))})}),pt.prototype.eachLine=pt.prototype.iter;var Ta=0;function qu(e){var t=this;if(Ia(t),!(Ne(t,e)||tn(t.display,e))){nt(e),B&&(Ta=+new Date);var r=An(t,e,!0),n=e.dataTransfer.files;if(!(!r||t.isReadOnly()))if(n&&n.length&&window.FileReader&&window.File)for(var i=n.length,o=Array(i),s=0,a=function(){++s==i&&Xe(t,function(){r=de(t.doc,r);var k={from:r,to:r,text:t.doc.splitLines(o.filter(function(D){return D!=null}).join(t.doc.lineSeparator())),origin:"paste"};lr(t.doc,k),da(t.doc,bn(de(t.doc,r),de(t.doc,wn(k))))})()},l=function(k,D){if(t.options.allowDropFileTypes&&he(t.options.allowDropFileTypes,k.type)==-1){a();return}var _=new FileReader;_.onerror=function(){return a()},_.onload=function(){var K=_.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(K)){a();return}o[D]=K,a()},_.readAsText(k)},u=0;u<n.length;u++)l(n[u],u);else{if(t.state.draggingText&&t.doc.sel.contains(r)>-1){t.state.draggingText(e),setTimeout(function(){return t.display.input.focus()},20);return}try{var p=e.dataTransfer.getData("Text");if(p){var y;if(t.state.draggingText&&!t.state.draggingText.copy&&(y=t.listSelections()),Ni(t.doc,bn(r,r)),y)for(var L=0;L<y.length;++L)ur(t.doc,"",y[L].anchor,y[L].head,"drag");t.replaceSelection(p,"around","paste"),t.display.input.focus()}}catch{}}}}function _u(e,t){if(B&&(!e.state.draggingText||+new Date-Ta<100)){dn(t);return}if(!(Ne(e,t)||tn(e.display,t))&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!re)){var r=g("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",q&&(r.width=r.height=1,e.display.wrapper.appendChild(r),r._top=r.offsetTop),t.dataTransfer.setDragImage(r,0,0),q&&r.parentNode.removeChild(r)}}function zu(e,t){var r=An(e,t);if(r){var n=document.createDocumentFragment();yo(e,r,n),e.display.dragCursor||(e.display.dragCursor=g("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),z(e.display.dragCursor,n)}}function Ia(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Ma(e){if(document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),r=[],n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&r.push(i)}r.length&&r[0].operation(function(){for(var o=0;o<r.length;o++)e(r[o])})}}var Ba=!1;function Uu(){Ba||(Gu(),Ba=!0)}function Gu(){var e;ue(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,Ma(Ku)},100))}),ue(window,"blur",function(){return Ma(rr)})}function Ku(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var kn={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Jr=0;Jr<10;Jr++)kn[Jr+48]=kn[Jr+96]=String(Jr);for(var Wi=65;Wi<=90;Wi++)kn[Wi]=String.fromCharCode(Wi);for(var Zr=1;Zr<=12;Zr++)kn[Zr+111]=kn[Zr+63235]="F"+Zr;var rn={};rn.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},rn.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},rn.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},rn.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},rn.default=F?rn.macDefault:rn.pcDefault;function ju(e){var t=e.split(/-(?!$)/);e=t[t.length-1];for(var r,n,i,o,s=0;s<t.length-1;s++){var a=t[s];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else if(/^s(hift)?$/i.test(a))i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(e="Alt-"+e),n&&(e="Ctrl-"+e),o&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}function Xu(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];if(/^(name|fallthrough|(de|at)tach)$/.test(r))continue;if(n=="..."){delete e[r];continue}for(var i=Tn(r.split(" "),ju),o=0;o<i.length;o++){var s=void 0,a=void 0;o==i.length-1?(a=i.join(" "),s=n):(a=i.slice(0,o+1).join(" "),s="...");var l=t[a];if(!l)t[a]=s;else if(l!=s)throw new Error("Inconsistent bindings for "+a)}delete e[r]}for(var u in t)e[u]=t[u];return e}function cr(e,t,r,n){t=Fi(t);var i=t.call?t.call(e,n):t[e];if(i===!1)return"nothing";if(i==="...")return"multi";if(i!=null&&r(i))return"handled";if(t.fallthrough){if(Object.prototype.toString.call(t.fallthrough)!="[object Array]")return cr(e,t.fallthrough,r,n);for(var o=0;o<t.fallthrough.length;o++){var s=cr(e,t.fallthrough[o],r,n);if(s)return s}}}function Oa(e){var t=typeof e=="string"?e:kn[e.keyCode];return t=="Ctrl"||t=="Alt"||t=="Shift"||t=="Mod"}function Aa(e,t,r){var n=e;return t.altKey&&n!="Alt"&&(e="Alt-"+e),(Z?t.metaKey:t.ctrlKey)&&n!="Ctrl"&&(e="Ctrl-"+e),(Z?t.ctrlKey:t.metaKey)&&n!="Mod"&&(e="Cmd-"+e),!r&&t.shiftKey&&n!="Shift"&&(e="Shift-"+e),e}function Na(e,t){if(q&&e.keyCode==34&&e.char)return!1;var r=kn[e.keyCode];return r==null||e.altGraphKey?!1:(e.keyCode==3&&e.code&&(r=e.code),Aa(r,e,t))}function Fi(e){return typeof e=="string"?rn[e]:e}function dr(e,t){for(var r=e.doc.sel.ranges,n=[],i=0;i<r.length;i++){for(var o=t(r[i]);n.length&&ee(o.from,me(n).to)<=0;){var s=n.pop();if(ee(s.from,o.from)<0){o.from=s.from;break}}n.push(o)}wt(e,function(){for(var a=n.length-1;a>=0;a--)ur(e.doc,"",n[a].from,n[a].to,"+delete");ir(e)})}function Do(e,t,r){var n=un(e.text,t+r,r);return n<0||n>e.text.length?null:n}function Wo(e,t,r){var n=Do(e,t.ch,r);return n==null?null:new N(t.line,n,r<0?"after":"before")}function Fo(e,t,r,n,i){if(e){t.doc.direction=="rtl"&&(i=-i);var o=ye(r,t.doc.direction);if(o){var s=i<0?me(o):o[0],a=i<0==(s.level==1),l=a?"after":"before",u;if(s.level>0||t.doc.direction=="rtl"){var p=er(t,r);u=i<0?r.text.length-1:0;var y=jt(t,p,u).top;u=zt(function(L){return jt(t,p,L).top==y},i<0==(s.level==1)?s.from:s.to-1,u),l=="before"&&(u=Do(r,u,1))}else u=i<0?s.to:s.from;return new N(n,u,l)}}return new N(n,i<0?r.text.length:0,i<0?"before":"after")}function $u(e,t,r,n){var i=ye(t,e.doc.direction);if(!i)return Wo(t,r,n);r.ch>=t.text.length?(r.ch=t.text.length,r.sticky="before"):r.ch<=0&&(r.ch=0,r.sticky="after");var o=cn(i,r.ch,r.sticky),s=i[o];if(e.doc.direction=="ltr"&&s.level%2==0&&(n>0?s.to>r.ch:s.from<r.ch))return Wo(t,r,n);var a=function(Q,ne){return Do(t,Q instanceof N?Q.ch:Q,ne)},l,u=function(Q){return e.options.lineWrapping?(l=l||er(e,t),Ps(e,t,l,Q)):{begin:0,end:t.text.length}},p=u(r.sticky=="before"?a(r,-1):r.ch);if(e.doc.direction=="rtl"||s.level==1){var y=s.level==1==n<0,L=a(r,y?1:-1);if(L!=null&&(y?L<=s.to&&L<=p.end:L>=s.from&&L>=p.begin)){var k=y?"before":"after";return new N(r.line,L,k)}}var D=function(Q,ne,V){for(var ie=function(Le,Ye){return Ye?new N(r.line,a(Le,1),"before"):new N(r.line,Le,"after")};Q>=0&&Q<i.length;Q+=ne){var fe=i[Q],le=ne>0==(fe.level!=1),ve=le?V.begin:a(V.end,-1);if(fe.from<=ve&&ve<fe.to||(ve=le?fe.from:a(fe.to,-1),V.begin<=ve&&ve<V.end))return ie(ve,le)}},_=D(o+n,n,p);if(_)return _;var K=n>0?p.end:a(p.begin,-1);return K!=null&&!(n>0&&K==t.text.length)&&(_=D(n>0?0:i.length-1,n,u(K)),_)?_:null}var Qr={selectAll:ma,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Qe)},killLine:function(e){return dr(e,function(t){if(t.empty()){var r=se(e.doc,t.head.line).text.length;return t.head.ch==r&&t.head.line<e.lastLine()?{from:t.head,to:N(t.head.line+1,0)}:{from:t.head,to:N(t.head.line,r)}}else return{from:t.from(),to:t.to()}})},deleteLine:function(e){return dr(e,function(t){return{from:N(t.from().line,0),to:de(e.doc,N(t.to().line+1,0))}})},delLineLeft:function(e){return dr(e,function(t){return{from:N(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(e){return dr(e,function(t){var r=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:r},"div");return{from:n,to:t.from()}})},delWrappedLineRight:function(e){return dr(e,function(t){var r=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:r},"div");return{from:t.from(),to:n}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(N(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(N(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(t){return Ha(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(t){return Da(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(t){return Yu(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(t){var r=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:r},"div")},st)},goLineLeft:function(e){return e.extendSelectionsBy(function(t){var r=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:r},"div")},st)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(t){var r=e.cursorCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:r},"div");return n.ch<e.getLine(n.line).search(/\S/)?Da(e,t.head):n},st)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],r=e.listSelections(),n=e.options.tabSize,i=0;i<r.length;i++){var o=r[i].from(),s=be(e.getLine(o.line),o.ch,n);t.push(ln(n-s%n))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return wt(e,function(){for(var t=e.listSelections(),r=[],n=0;n<t.length;n++)if(t[n].empty()){var i=t[n].head,o=se(e.doc,i.line).text;if(o){if(i.ch==o.length&&(i=new N(i.line,i.ch-1)),i.ch>0)i=new N(i.line,i.ch+1),e.replaceRange(o.charAt(i.ch-1)+o.charAt(i.ch-2),N(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var s=se(e.doc,i.line-1).text;s&&(i=new N(i.line,1),e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+s.charAt(s.length-1),N(i.line-1,s.length-1),i,"+transpose"))}}r.push(new xe(i,i))}e.setSelections(r)})},newlineAndIndent:function(e){return wt(e,function(){for(var t=e.listSelections(),r=t.length-1;r>=0;r--)e.replaceRange(e.doc.lineSeparator(),t[r].anchor,t[r].head,"+input");t=e.listSelections();for(var n=0;n<t.length;n++)e.indentLine(t[n].from().line,null,!0);ir(e)})},openLine:function(e){return e.replaceSelection(`
`,"start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Ha(e,t){var r=se(e.doc,t),n=Wt(r);return n!=r&&(t=f(n)),Fo(!0,e,n,t,1)}function Yu(e,t){var r=se(e.doc,t),n=Al(r);return n!=r&&(t=f(n)),Fo(!0,e,r,t,-1)}function Da(e,t){var r=Ha(e,t.line),n=se(e.doc,r.line),i=ye(n,e.doc.direction);if(!i||i[0].level==0){var o=Math.max(r.ch,n.text.search(/\S/)),s=t.line==r.line&&t.ch<=o&&t.ch;return N(r.line,s?0:o,r.sticky)}return r}function Pi(e,t,r){if(typeof t=="string"&&(t=Qr[t],!t))return!1;e.display.input.ensurePolled();var n=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),r&&(e.display.shift=!1),i=t(e)!=St}finally{e.display.shift=n,e.state.suppressEdits=!1}return i}function Ju(e,t,r){for(var n=0;n<e.state.keyMaps.length;n++){var i=cr(t,e.state.keyMaps[n],r,e);if(i)return i}return e.options.extraKeys&&cr(t,e.options.extraKeys,r,e)||cr(t,e.options.keyMap,r,e)}var Zu=new Et;function Vr(e,t,r,n){var i=e.state.keySeq;if(i){if(Oa(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:Zu.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())}),Wa(e,i+" "+t,r,n))return!0}return Wa(e,t,r,n)}function Wa(e,t,r,n){var i=Ju(e,t,n);return i=="multi"&&(e.state.keySeq=t),i=="handled"&&je(e,"keyHandled",e,t,r),(i=="handled"||i=="multi")&&(nt(r),bo(e)),!!i}function Fa(e,t){var r=Na(t,!0);return r?t.shiftKey&&!e.state.keySeq?Vr(e,"Shift-"+r,t,function(n){return Pi(e,n,!0)})||Vr(e,r,t,function(n){if(typeof n=="string"?/^go[A-Z]/.test(n):n.motion)return Pi(e,n)}):Vr(e,r,t,function(n){return Pi(e,n)}):!1}function Qu(e,t,r){return Vr(e,"'"+r+"'",t,function(n){return Pi(e,n,!0)})}var Po=null;function Pa(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField())&&(t.curOp.focus=Te(yt(t)),!Ne(t,e))){B&&W<11&&e.keyCode==27&&(e.returnValue=!1);var r=e.keyCode;t.display.shift=r==16||e.shiftKey;var n=Fa(t,e);q&&(Po=n?r:null,!n&&r==88&&!di&&(F?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),w&&!F&&!n&&r==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),r==18&&!/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)&&Vu(t)}}function Vu(e){var t=e.display.lineDiv;Ee(t,"CodeMirror-crosshair");function r(n){(n.keyCode==18||!n.altKey)&&(J(t,"CodeMirror-crosshair"),tt(document,"keyup",r),tt(document,"mouseover",r))}ue(document,"keyup",r),ue(document,"mouseover",r)}function Ra(e){e.keyCode==16&&(this.doc.sel.shift=!1),Ne(this,e)}function qa(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField())&&!(tn(t.display,e)||Ne(t,e)||e.ctrlKey&&!e.altKey||F&&e.metaKey)){var r=e.keyCode,n=e.charCode;if(q&&r==Po){Po=null,nt(e);return}if(!(q&&(!e.which||e.which<10)&&Fa(t,e))){var i=String.fromCharCode(n??r);i!="\b"&&(Qu(t,e,i)||t.display.input.onKeyPress(e))}}}var ef=400,Ro=function(e,t,r){this.time=e,this.pos=t,this.button=r};Ro.prototype.compare=function(e,t,r){return this.time+ef>e&&ee(t,this.pos)==0&&r==this.button};var ei,ti;function tf(e,t){var r=+new Date;return ti&&ti.compare(r,e,t)?(ei=ti=null,"triple"):ei&&ei.compare(r,e,t)?(ti=new Ro(r,e,t),ei=null,"double"):(ei=new Ro(r,e,t),ti=null,"single")}function _a(e){var t=this,r=t.display;if(!(Ne(t,e)||r.activeTouch&&r.input.supportsTouch())){if(r.input.ensurePolled(),r.shift=e.shiftKey,tn(r,e)){A||(r.scroller.draggable=!1,setTimeout(function(){return r.scroller.draggable=!0},100));return}if(!qo(t,e)){var n=An(t,e),i=At(e),o=n?tf(n,i):"single";ce(t).focus(),i==1&&t.state.selectingText&&t.state.selectingText(e),!(n&&nf(t,i,n,o,e))&&(i==1?n?of(t,n,o,e):Er(e)==r.scroller&&nt(e):i==2?(n&&Ai(t.doc,n),setTimeout(function(){return r.input.focus()},20)):i==3&&(U?t.display.input.onContextMenu(e):wo(t)))}}}function nf(e,t,r,n,i){var o="Click";return n=="double"?o="Double"+o:n=="triple"&&(o="Triple"+o),o=(t==1?"Left":t==2?"Middle":"Right")+o,Vr(e,Aa(o,i),i,function(s){if(typeof s=="string"&&(s=Qr[s]),!s)return!1;var a=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),a=s(e,r)!=St}finally{e.state.suppressEdits=!1}return a})}function rf(e,t,r){var n=e.getOption("configureMouse"),i=n?n(e,t,r):{};if(i.unit==null){var o=X?r.shiftKey&&r.metaKey:r.altKey;i.unit=o?"rectangle":t=="single"?"char":t=="double"?"word":"line"}return(i.extend==null||e.doc.extend)&&(i.extend=e.doc.extend||r.shiftKey),i.addNew==null&&(i.addNew=F?r.metaKey:r.ctrlKey),i.moveOnDrag==null&&(i.moveOnDrag=!(F?r.altKey:r.ctrlKey)),i}function of(e,t,r,n){B?setTimeout(ae(zs,e),0):e.curOp.focus=Te(yt(e));var i=rf(e,r,n),o=e.doc.sel,s;e.options.dragDrop&&Zi&&!e.isReadOnly()&&r=="single"&&(s=o.contains(t))>-1&&(ee((s=o.ranges[s]).from(),t)<0||t.xRel>0)&&(ee(s.to(),t)>0||t.xRel<0)?sf(e,n,t,i):af(e,n,t,i)}function sf(e,t,r,n){var i=e.display,o=!1,s=Xe(e,function(u){A&&(i.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:wo(e)),tt(i.wrapper.ownerDocument,"mouseup",s),tt(i.wrapper.ownerDocument,"mousemove",a),tt(i.scroller,"dragstart",l),tt(i.scroller,"drop",s),o||(nt(u),n.addNew||Ai(e.doc,r,null,null,n.extend),A&&!re||B&&W==9?setTimeout(function(){i.wrapper.ownerDocument.body.focus({preventScroll:!0}),i.input.focus()},20):i.input.focus())}),a=function(u){o=o||Math.abs(t.clientX-u.clientX)+Math.abs(t.clientY-u.clientY)>=10},l=function(){return o=!0};A&&(i.scroller.draggable=!0),e.state.draggingText=s,s.copy=!n.moveOnDrag,ue(i.wrapper.ownerDocument,"mouseup",s),ue(i.wrapper.ownerDocument,"mousemove",a),ue(i.scroller,"dragstart",l),ue(i.scroller,"drop",s),e.state.delayingBlurEvent=!0,setTimeout(function(){return i.input.focus()},20),i.scroller.dragDrop&&i.scroller.dragDrop()}function za(e,t,r){if(r=="char")return new xe(t,t);if(r=="word")return e.findWordAt(t);if(r=="line")return new xe(N(t.line,0),de(e.doc,N(t.line+1,0)));var n=r(e,t);return new xe(n.from,n.to)}function af(e,t,r,n){B&&wo(e);var i=e.display,o=e.doc;nt(t);var s,a,l=o.sel,u=l.ranges;if(n.addNew&&!n.extend?(a=o.sel.contains(r),a>-1?s=u[a]:s=new xe(r,r)):(s=o.sel.primary(),a=o.sel.primIndex),n.unit=="rectangle")n.addNew||(s=new xe(r,r)),r=An(e,t,!0,!0),a=-1;else{var p=za(e,r,n.unit);n.extend?s=No(s,p.anchor,p.head,n.extend):s=p}n.addNew?a==-1?(a=u.length,rt(o,Pt(e,u.concat([s]),a),{scroll:!1,origin:"*mouse"})):u.length>1&&u[a].empty()&&n.unit=="char"&&!n.extend?(rt(o,Pt(e,u.slice(0,a).concat(u.slice(a+1)),0),{scroll:!1,origin:"*mouse"}),l=o.sel):Ho(o,a,s,kt):(a=0,rt(o,new Ct([s],0),kt),l=o.sel);var y=r;function L(V){if(ee(y,V)!=0)if(y=V,n.unit=="rectangle"){for(var ie=[],fe=e.options.tabSize,le=be(se(o,r.line).text,r.ch,fe),ve=be(se(o,V.line).text,V.ch,fe),Le=Math.min(le,ve),Ye=Math.max(le,ve),Be=Math.min(r.line,V.line),xt=Math.min(e.lastLine(),Math.max(r.line,V.line));Be<=xt;Be++){var vt=se(o,Be).text,_e=Oe(vt,Le,fe);Le==Ye?ie.push(new xe(N(Be,_e),N(Be,_e))):vt.length>_e&&ie.push(new xe(N(Be,_e),N(Be,Oe(vt,Ye,fe))))}ie.length||ie.push(new xe(r,r)),rt(o,Pt(e,l.ranges.slice(0,a).concat(ie),a),{origin:"*mouse",scroll:!1}),e.scrollIntoView(V)}else{var gt=s,Ve=za(e,V,n.unit),Ge=gt.anchor,ze;ee(Ve.anchor,Ge)>0?(ze=Ve.head,Ge=Zn(gt.from(),Ve.anchor)):(ze=Ve.anchor,Ge=dt(gt.to(),Ve.head));var De=l.ranges.slice(0);De[a]=lf(e,new xe(de(o,Ge),ze)),rt(o,Pt(e,De,a),kt)}}var k=i.wrapper.getBoundingClientRect(),D=0;function _(V){var ie=++D,fe=An(e,V,!0,n.unit=="rectangle");if(fe)if(ee(fe,y)!=0){e.curOp.focus=Te(yt(e)),L(fe);var le=Ei(i,o);(fe.line>=le.to||fe.line<le.from)&&setTimeout(Xe(e,function(){D==ie&&_(V)}),150)}else{var ve=V.clientY<k.top?-20:V.clientY>k.bottom?20:0;ve&&setTimeout(Xe(e,function(){D==ie&&(i.scroller.scrollTop+=ve,_(V))}),50)}}function K(V){e.state.selectingText=!1,D=1/0,V&&(nt(V),i.input.focus()),tt(i.wrapper.ownerDocument,"mousemove",Q),tt(i.wrapper.ownerDocument,"mouseup",ne),o.history.lastSelOrigin=null}var Q=Xe(e,function(V){V.buttons===0||!At(V)?K(V):_(V)}),ne=Xe(e,K);e.state.selectingText=ne,ue(i.wrapper.ownerDocument,"mousemove",Q),ue(i.wrapper.ownerDocument,"mouseup",ne)}function lf(e,t){var r=t.anchor,n=t.head,i=se(e.doc,r.line);if(ee(r,n)==0&&r.sticky==n.sticky)return t;var o=ye(i);if(!o)return t;var s=cn(o,r.ch,r.sticky),a=o[s];if(a.from!=r.ch&&a.to!=r.ch)return t;var l=s+(a.from==r.ch==(a.level!=1)?0:1);if(l==0||l==o.length)return t;var u;if(n.line!=r.line)u=(n.line-r.line)*(e.doc.direction=="ltr"?1:-1)>0;else{var p=cn(o,n.ch,n.sticky),y=p-s||(n.ch-r.ch)*(a.level==1?-1:1);p==l-1||p==l?u=y<0:u=y>0}var L=o[l+(u?-1:0)],k=u==(L.level==1),D=k?L.from:L.to,_=k?"after":"before";return r.ch==D&&r.sticky==_?t:new xe(new N(r.line,D,_),n)}function Ua(e,t,r,n){var i,o;if(t.touches)i=t.touches[0].clientX,o=t.touches[0].clientY;else try{i=t.clientX,o=t.clientY}catch{return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&nt(t);var s=e.display,a=s.lineDiv.getBoundingClientRect();if(o>a.bottom||!bt(e,r))return ct(t);o-=a.top-s.viewOffset;for(var l=0;l<e.display.gutterSpecs.length;++l){var u=s.gutters.childNodes[l];if(u&&u.getBoundingClientRect().right>=i){var p=m(e.doc,o),y=e.display.gutterSpecs[l];return Ae(e,r,e,p,y.className,t),ct(t)}}}function qo(e,t){return Ua(e,t,"gutterClick",!0)}function Ga(e,t){tn(e.display,t)||uf(e,t)||Ne(e,t,"contextmenu")||U||e.display.input.onContextMenu(t)}function uf(e,t){return bt(e,"gutterContextMenu")?Ua(e,t,"gutterContextMenu",!1):!1}function Ka(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Dr(e)}var hr={toString:function(){return"CodeMirror.Init"}},ja={},Ri={};function ff(e){var t=e.optionHandlers;function r(n,i,o,s){e.defaults[n]=i,o&&(t[n]=s?function(a,l,u){u!=hr&&o(a,l,u)}:o)}e.defineOption=r,e.Init=hr,r("value","",function(n,i){return n.setValue(i)},!0),r("mode",null,function(n,i){n.doc.modeOption=i,Bo(n)},!0),r("indentUnit",2,Bo,!0),r("indentWithTabs",!1),r("smartIndent",!0),r("tabSize",4,function(n){Ur(n),Dr(n),ht(n)},!0),r("lineSeparator",null,function(n,i){if(n.doc.lineSep=i,!!i){var o=[],s=n.doc.first;n.doc.iter(function(l){for(var u=0;;){var p=l.text.indexOf(i,u);if(p==-1)break;u=p+i.length,o.push(N(s,p))}s++});for(var a=o.length-1;a>=0;a--)ur(n.doc,i,o[a],N(o[a].line,o[a].ch+i.length))}}),r("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,function(n,i,o){n.state.specialChars=new RegExp(i.source+(i.test("	")?"":"|	"),"g"),o!=hr&&n.refresh()}),r("specialCharPlaceholder",Pl,function(n){return n.refresh()},!0),r("electricChars",!0),r("inputStyle",I?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),r("spellcheck",!1,function(n,i){return n.getInputField().spellcheck=i},!0),r("autocorrect",!1,function(n,i){return n.getInputField().autocorrect=i},!0),r("autocapitalize",!1,function(n,i){return n.getInputField().autocapitalize=i},!0),r("rtlMoveVisually",!C),r("wholeLineUpdateBefore",!0),r("theme","default",function(n){Ka(n),zr(n)},!0),r("keyMap","default",function(n,i,o){var s=Fi(i),a=o!=hr&&Fi(o);a&&a.detach&&a.detach(n,s),s.attach&&s.attach(n,a||null)}),r("extraKeys",null),r("configureMouse",null),r("lineWrapping",!1,df,!0),r("gutters",[],function(n,i){n.display.gutterSpecs=Io(i,n.options.lineNumbers),zr(n)},!0),r("fixedGutter",!0,function(n,i){n.display.gutters.style.left=i?go(n.display)+"px":"0",n.refresh()},!0),r("coverGutterNextToScrollbar",!1,function(n){return or(n)},!0),r("scrollbarStyle","native",function(n){$s(n),or(n),n.display.scrollbars.setScrollTop(n.doc.scrollTop),n.display.scrollbars.setScrollLeft(n.doc.scrollLeft)},!0),r("lineNumbers",!1,function(n,i){n.display.gutterSpecs=Io(n.options.gutters,i),zr(n)},!0),r("firstLineNumber",1,zr,!0),r("lineNumberFormatter",function(n){return n},zr,!0),r("showCursorWhenSelecting",!1,Wr,!0),r("resetSelectionOnContextMenu",!0),r("lineWiseCopyCut",!0),r("pasteLinesPerSelection",!0),r("selectionsMayTouch",!1),r("readOnly",!1,function(n,i){i=="nocursor"&&(rr(n),n.display.input.blur()),n.display.input.readOnlyChanged(i)}),r("screenReaderLabel",null,function(n,i){i=i===""?null:i,n.display.input.screenReaderLabelChanged(i)}),r("disableInput",!1,function(n,i){i||n.display.input.reset()},!0),r("dragDrop",!0,cf),r("allowDropFileTypes",null),r("cursorBlinkRate",530),r("cursorScrollMargin",0),r("cursorHeight",1,Wr,!0),r("singleCursorHeightPerLine",!0,Wr,!0),r("workTime",100),r("workDelay",100),r("flattenSpans",!0,Ur,!0),r("addModeClass",!1,Ur,!0),r("pollInterval",100),r("undoDepth",200,function(n,i){return n.doc.history.undoDepth=i}),r("historyEventDelay",1250),r("viewportMargin",10,function(n){return n.refresh()},!0),r("maxHighlightLength",1e4,Ur,!0),r("moveInputWithCursor",!0,function(n,i){i||n.display.input.resetPosition()}),r("tabindex",null,function(n,i){return n.display.input.getField().tabIndex=i||""}),r("autofocus",null),r("direction","ltr",function(n,i){return n.doc.setDirection(i)},!0),r("phrases",null)}function cf(e,t,r){var n=r&&r!=hr;if(!t!=!n){var i=e.display.dragFunctions,o=t?ue:tt;o(e.display.scroller,"dragstart",i.start),o(e.display.scroller,"dragenter",i.enter),o(e.display.scroller,"dragover",i.over),o(e.display.scroller,"dragleave",i.leave),o(e.display.scroller,"drop",i.drop)}}function df(e){e.options.lineWrapping?(Ee(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(J(e.display.wrapper,"CodeMirror-wrap"),oo(e)),mo(e),ht(e),Dr(e),setTimeout(function(){return or(e)},100)}function Ie(e,t){var r=this;if(!(this instanceof Ie))return new Ie(e,t);this.options=t=t?pe(t):{},pe(ja,t,!1);var n=t.value;typeof n=="string"?n=new pt(n,t.mode,null,t.lineSeparator,t.direction):t.mode&&(n.modeOption=t.mode),this.doc=n;var i=new Ie.inputStyles[t.inputStyle](this),o=this.display=new Lu(e,n,i,t);o.wrapper.CodeMirror=this,Ka(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),$s(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new Et,keySeq:null,specialChars:null},t.autofocus&&!I&&o.input.focus(),B&&W<11&&setTimeout(function(){return r.display.input.reset(!0)},20),hf(this),Uu(),Wn(this),this.curOp.forceUpdate=!0,ia(this,n),t.autofocus&&!I||this.hasFocus()?setTimeout(function(){r.hasFocus()&&!r.state.focused&&xo(r)},20):rr(this);for(var s in Ri)Ri.hasOwnProperty(s)&&Ri[s](this,t[s],hr);Zs(this),t.finishInit&&t.finishInit(this);for(var a=0;a<_o.length;++a)_o[a](this);Fn(this),A&&t.lineWrapping&&getComputedStyle(o.lineDiv).textRendering=="optimizelegibility"&&(o.lineDiv.style.textRendering="auto")}Ie.defaults=ja,Ie.optionHandlers=Ri;function hf(e){var t=e.display;ue(t.scroller,"mousedown",Xe(e,_a)),B&&W<11?ue(t.scroller,"dblclick",Xe(e,function(l){if(!Ne(e,l)){var u=An(e,l);if(!(!u||qo(e,l)||tn(e.display,l))){nt(l);var p=e.findWordAt(u);Ai(e.doc,p.anchor,p.head)}}})):ue(t.scroller,"dblclick",function(l){return Ne(e,l)||nt(l)}),ue(t.scroller,"contextmenu",function(l){return Ga(e,l)}),ue(t.input.getField(),"contextmenu",function(l){t.scroller.contains(l.target)||Ga(e,l)});var r,n={end:0};function i(){t.activeTouch&&(r=setTimeout(function(){return t.activeTouch=null},1e3),n=t.activeTouch,n.end=+new Date)}function o(l){if(l.touches.length!=1)return!1;var u=l.touches[0];return u.radiusX<=1&&u.radiusY<=1}function s(l,u){if(u.left==null)return!0;var p=u.left-l.left,y=u.top-l.top;return p*p+y*y>20*20}ue(t.scroller,"touchstart",function(l){if(!Ne(e,l)&&!o(l)&&!qo(e,l)){t.input.ensurePolled(),clearTimeout(r);var u=+new Date;t.activeTouch={start:u,moved:!1,prev:u-n.end<=300?n:null},l.touches.length==1&&(t.activeTouch.left=l.touches[0].pageX,t.activeTouch.top=l.touches[0].pageY)}}),ue(t.scroller,"touchmove",function(){t.activeTouch&&(t.activeTouch.moved=!0)}),ue(t.scroller,"touchend",function(l){var u=t.activeTouch;if(u&&!tn(t,l)&&u.left!=null&&!u.moved&&new Date-u.start<300){var p=e.coordsChar(t.activeTouch,"page"),y;!u.prev||s(u,u.prev)?y=new xe(p,p):!u.prev.prev||s(u,u.prev.prev)?y=e.findWordAt(p):y=new xe(N(p.line,0),de(e.doc,N(p.line+1,0))),e.setSelection(y.anchor,y.head),e.focus(),nt(l)}i()}),ue(t.scroller,"touchcancel",i),ue(t.scroller,"scroll",function(){t.scroller.clientHeight&&(Pr(e,t.scroller.scrollTop),Hn(e,t.scroller.scrollLeft,!0),Ae(e,"scroll",e))}),ue(t.scroller,"mousewheel",function(l){return ea(e,l)}),ue(t.scroller,"DOMMouseScroll",function(l){return ea(e,l)}),ue(t.wrapper,"scroll",function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),t.dragFunctions={enter:function(l){Ne(e,l)||dn(l)},over:function(l){Ne(e,l)||(zu(e,l),dn(l))},start:function(l){return _u(e,l)},drop:Xe(e,qu),leave:function(l){Ne(e,l)||Ia(e)}};var a=t.input.getField();ue(a,"keyup",function(l){return Ra.call(e,l)}),ue(a,"keydown",Xe(e,Pa)),ue(a,"keypress",Xe(e,qa)),ue(a,"focus",function(l){return xo(e,l)}),ue(a,"blur",function(l){return rr(e,l)})}var _o=[];Ie.defineInitHook=function(e){return _o.push(e)};function ni(e,t,r,n){var i=e.doc,o;r==null&&(r="add"),r=="smart"&&(i.mode.indent?o=Br(e,t).state:r="prev");var s=e.options.tabSize,a=se(i,t),l=be(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var u=a.text.match(/^\s*/)[0],p;if(!n&&!/\S/.test(a.text))p=0,r="not";else if(r=="smart"&&(p=i.mode.indent(o,a.text.slice(u.length),a.text),p==St||p>150)){if(!n)return;r="prev"}r=="prev"?t>i.first?p=be(se(i,t-1).text,null,s):p=0:r=="add"?p=l+e.options.indentUnit:r=="subtract"?p=l-e.options.indentUnit:typeof r=="number"&&(p=l+r),p=Math.max(0,p);var y="",L=0;if(e.options.indentWithTabs)for(var k=Math.floor(p/s);k;--k)L+=s,y+="	";if(L<p&&(y+=ln(p-L)),y!=u)return ur(i,y,N(t,0),N(t,u.length),"+input"),a.stateAfter=null,!0;for(var D=0;D<i.sel.ranges.length;D++){var _=i.sel.ranges[D];if(_.head.line==t&&_.head.ch<u.length){var K=N(t,u.length);Ho(i,D,new xe(K,K));break}}}var Rt=null;function qi(e){Rt=e}function zo(e,t,r,n,i){var o=e.doc;e.display.shift=!1,n||(n=o.sel);var s=+new Date-200,a=i=="paste"||e.state.pasteIncoming>s,l=It(t),u=null;if(a&&n.ranges.length>1)if(Rt&&Rt.text.join(`
`)==t){if(n.ranges.length%Rt.text.length==0){u=[];for(var p=0;p<Rt.text.length;p++)u.push(o.splitLines(Rt.text[p]))}}else l.length==n.ranges.length&&e.options.pasteLinesPerSelection&&(u=Tn(l,function(Q){return[Q]}));for(var y=e.curOp.updateInput,L=n.ranges.length-1;L>=0;L--){var k=n.ranges[L],D=k.from(),_=k.to();k.empty()&&(r&&r>0?D=N(D.line,D.ch-r):e.state.overwrite&&!a?_=N(_.line,Math.min(se(o,_.line).text.length,_.ch+me(l).length)):a&&Rt&&Rt.lineWise&&Rt.text.join(`
`)==l.join(`
`)&&(D=_=N(D.line,0)));var K={from:D,to:_,text:u?u[L%u.length]:l,origin:i||(a?"paste":e.state.cutIncoming>s?"cut":"+input")};lr(e.doc,K),je(e,"inputRead",e,K)}t&&!a&&$a(e,t),ir(e),e.curOp.updateInput<2&&(e.curOp.updateInput=y),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Xa(e,t){var r=e.clipboardData&&e.clipboardData.getData("Text");if(r)return e.preventDefault(),!t.isReadOnly()&&!t.options.disableInput&&t.hasFocus()&&wt(t,function(){return zo(t,r,0,null,"paste")}),!0}function $a(e,t){if(!(!e.options.electricChars||!e.options.smartIndent))for(var r=e.doc.sel,n=r.ranges.length-1;n>=0;n--){var i=r.ranges[n];if(!(i.head.ch>100||n&&r.ranges[n-1].head.line==i.head.line)){var o=e.getModeAt(i.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(t.indexOf(o.electricChars.charAt(a))>-1){s=ni(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(se(e.doc,i.head.line).text.slice(0,i.head.ch))&&(s=ni(e,i.head.line,"smart"));s&&je(e,"electricInput",e,i.head.line)}}}function Ya(e){for(var t=[],r=[],n=0;n<e.doc.sel.ranges.length;n++){var i=e.doc.sel.ranges[n].head.line,o={anchor:N(i,0),head:N(i+1,0)};r.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:r}}function Uo(e,t,r,n){e.setAttribute("autocorrect",r?"on":"off"),e.setAttribute("autocapitalize",n?"on":"off"),e.setAttribute("spellcheck",!!t)}function Ja(){var e=g("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),t=g("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return A?e.style.width="1000px":e.setAttribute("wrap","off"),x&&(e.style.border="1px solid black"),t}function pf(e){var t=e.optionHandlers,r=e.helpers={};e.prototype={constructor:e,focus:function(){ce(this).focus(),this.display.input.focus()},setOption:function(n,i){var o=this.options,s=o[n];o[n]==i&&n!="mode"||(o[n]=i,t.hasOwnProperty(n)&&Xe(this,t[n])(this,i,s),Ae(this,"optionChange",this,n))},getOption:function(n){return this.options[n]},getDoc:function(){return this.doc},addKeyMap:function(n,i){this.state.keyMaps[i?"push":"unshift"](Fi(n))},removeKeyMap:function(n){for(var i=this.state.keyMaps,o=0;o<i.length;++o)if(i[o]==n||i[o].name==n)return i.splice(o,1),!0},addOverlay:at(function(n,i){var o=n.token?n:e.getMode(this.options,n);if(o.startState)throw new Error("Overlays may not be stateful.");$i(this.state.overlays,{mode:o,modeSpec:n,opaque:i&&i.opaque,priority:i&&i.priority||0},function(s){return s.priority}),this.state.modeGen++,ht(this)}),removeOverlay:at(function(n){for(var i=this.state.overlays,o=0;o<i.length;++o){var s=i[o].modeSpec;if(s==n||typeof n=="string"&&s.name==n){i.splice(o,1),this.state.modeGen++,ht(this);return}}}),indentLine:at(function(n,i,o){typeof i!="string"&&typeof i!="number"&&(i==null?i=this.options.smartIndent?"smart":"prev":i=i?"add":"subtract"),R(this.doc,n)&&ni(this,n,i,o)}),indentSelection:at(function(n){for(var i=this.doc.sel.ranges,o=-1,s=0;s<i.length;s++){var a=i[s];if(a.empty())a.head.line>o&&(ni(this,a.head.line,n,!0),o=a.head.line,s==this.doc.sel.primIndex&&ir(this));else{var l=a.from(),u=a.to(),p=Math.max(o,l.line);o=Math.min(this.lastLine(),u.line-(u.ch?0:1))+1;for(var y=p;y<o;++y)ni(this,y,n);var L=this.doc.sel.ranges;l.ch==0&&i.length==L.length&&L[s].from().ch>0&&Ho(this.doc,s,new xe(l,L[s].to()),Qe)}}}),getTokenAt:function(n,i){return ss(this,n,i)},getLineTokens:function(n,i){return ss(this,N(n),i,!0)},getTokenTypeAt:function(n){n=de(this.doc,n);var i=rs(this,se(this.doc,n.line)),o=0,s=(i.length-1)/2,a=n.ch,l;if(a==0)l=i[2];else for(;;){var u=o+s>>1;if((u?i[u*2-1]:0)>=a)s=u;else if(i[u*2+1]<a)o=u+1;else{l=i[u*2+2];break}}var p=l?l.indexOf("overlay "):-1;return p<0?l:p==0?null:l.slice(0,p-1)},getModeAt:function(n){var i=this.doc.mode;return i.innerMode?e.innerMode(i,this.getTokenAt(n).state).mode:i},getHelper:function(n,i){return this.getHelpers(n,i)[0]},getHelpers:function(n,i){var o=[];if(!r.hasOwnProperty(i))return o;var s=r[i],a=this.getModeAt(n);if(typeof a[i]=="string")s[a[i]]&&o.push(s[a[i]]);else if(a[i])for(var l=0;l<a[i].length;l++){var u=s[a[i][l]];u&&o.push(u)}else a.helperType&&s[a.helperType]?o.push(s[a.helperType]):s[a.name]&&o.push(s[a.name]);for(var p=0;p<s._global.length;p++){var y=s._global[p];y.pred(a,this)&&he(o,y.val)==-1&&o.push(y.val)}return o},getStateAfter:function(n,i){var o=this.doc;return n=es(o,n??o.first+o.size-1),Br(this,n+1,i).state},cursorCoords:function(n,i){var o,s=this.doc.sel.primary();return n==null?o=s.head:typeof n=="object"?o=de(this.doc,n):o=n?s.from():s.to(),Ft(this,o,i||"page")},charCoords:function(n,i){return Si(this,de(this.doc,n),i||"page")},coordsChar:function(n,i){return n=Ds(this,n,i||"page"),ho(this,n.left,n.top)},lineAtHeight:function(n,i){return n=Ds(this,{top:n,left:0},i||"page").top,m(this.doc,n+this.display.viewOffset)},heightAtLine:function(n,i,o){var s=!1,a;if(typeof n=="number"){var l=this.doc.first+this.doc.size-1;n<this.doc.first?n=this.doc.first:n>l&&(n=l,s=!0),a=se(this.doc,n)}else a=n;return xi(this,a,{top:0,left:0},i||"page",o||s).top+(s?this.doc.height-en(a):0)},defaultTextHeight:function(){return tr(this.display)},defaultCharWidth:function(){return nr(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(n,i,o,s,a){var l=this.display;n=Ft(this,de(this.doc,n));var u=n.bottom,p=n.left;if(i.style.position="absolute",i.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(i),l.sizer.appendChild(i),s=="over")u=n.top;else if(s=="above"||s=="near"){var y=Math.max(l.wrapper.clientHeight,this.doc.height),L=Math.max(l.sizer.clientWidth,l.lineSpace.clientWidth);(s=="above"||n.bottom+i.offsetHeight>y)&&n.top>i.offsetHeight?u=n.top-i.offsetHeight:n.bottom+i.offsetHeight<=y&&(u=n.bottom),p+i.offsetWidth>L&&(p=L-i.offsetWidth)}i.style.top=u+"px",i.style.left=i.style.right="",a=="right"?(p=l.sizer.clientWidth-i.offsetWidth,i.style.right="0px"):(a=="left"?p=0:a=="middle"&&(p=(l.sizer.clientWidth-i.offsetWidth)/2),i.style.left=p+"px"),o&&fu(this,{left:p,top:u,right:p+i.offsetWidth,bottom:u+i.offsetHeight})},triggerOnKeyDown:at(Pa),triggerOnKeyPress:at(qa),triggerOnKeyUp:Ra,triggerOnMouseDown:at(_a),execCommand:function(n){if(Qr.hasOwnProperty(n))return Qr[n].call(null,this)},triggerElectric:at(function(n){$a(this,n)}),findPosH:function(n,i,o,s){var a=1;i<0&&(a=-1,i=-i);for(var l=de(this.doc,n),u=0;u<i&&(l=Go(this.doc,l,a,o,s),!l.hitSide);++u);return l},moveH:at(function(n,i){var o=this;this.extendSelectionsBy(function(s){return o.display.shift||o.doc.extend||s.empty()?Go(o.doc,s.head,n,i,o.options.rtlMoveVisually):n<0?s.from():s.to()},st)}),deleteH:at(function(n,i){var o=this.doc.sel,s=this.doc;o.somethingSelected()?s.replaceSelection("",null,"+delete"):dr(this,function(a){var l=Go(s,a.head,n,i,!1);return n<0?{from:l,to:a.head}:{from:a.head,to:l}})}),findPosV:function(n,i,o,s){var a=1,l=s;i<0&&(a=-1,i=-i);for(var u=de(this.doc,n),p=0;p<i;++p){var y=Ft(this,u,"div");if(l==null?l=y.left:y.left=l,u=Za(this,y,a,o),u.hitSide)break}return u},moveV:at(function(n,i){var o=this,s=this.doc,a=[],l=!this.display.shift&&!s.extend&&s.sel.somethingSelected();if(s.extendSelectionsBy(function(p){if(l)return n<0?p.from():p.to();var y=Ft(o,p.head,"div");p.goalColumn!=null&&(y.left=p.goalColumn),a.push(y.left);var L=Za(o,y,n,i);return i=="page"&&p==s.sel.primary()&&ko(o,Si(o,L,"div").top-y.top),L},st),a.length)for(var u=0;u<s.sel.ranges.length;u++)s.sel.ranges[u].goalColumn=a[u]}),findWordAt:function(n){var i=this.doc,o=se(i,n.line).text,s=n.ch,a=n.ch;if(o){var l=this.getHelper(n,"wordChars");(n.sticky=="before"||a==o.length)&&s?--s:++a;for(var u=o.charAt(s),p=Yt(u,l)?function(y){return Yt(y,l)}:/\s/.test(u)?function(y){return/\s/.test(y)}:function(y){return!/\s/.test(y)&&!Yt(y)};s>0&&p(o.charAt(s-1));)--s;for(;a<o.length&&p(o.charAt(a));)++a}return new xe(N(n.line,s),N(n.line,a))},toggleOverwrite:function(n){n!=null&&n==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Ee(this.display.cursorDiv,"CodeMirror-overwrite"):J(this.display.cursorDiv,"CodeMirror-overwrite"),Ae(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Te(yt(this))},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:at(function(n,i){Fr(this,n,i)}),getScrollInfo:function(){var n=this.display.scroller;return{left:n.scrollLeft,top:n.scrollTop,height:n.scrollHeight-Kt(this)-this.display.barHeight,width:n.scrollWidth-Kt(this)-this.display.barWidth,clientHeight:lo(this),clientWidth:Bn(this)}},scrollIntoView:at(function(n,i){n==null?(n={from:this.doc.sel.primary().head,to:null},i==null&&(i=this.options.cursorScrollMargin)):typeof n=="number"?n={from:N(n,0),to:null}:n.from==null&&(n={from:n,to:null}),n.to||(n.to=n.from),n.margin=i||0,n.from.line!=null?cu(this,n):Gs(this,n.from,n.to,n.margin)}),setSize:at(function(n,i){var o=this,s=function(l){return typeof l=="number"||/^\d+$/.test(String(l))?l+"px":l};n!=null&&(this.display.wrapper.style.width=s(n)),i!=null&&(this.display.wrapper.style.height=s(i)),this.options.lineWrapping&&As(this);var a=this.display.viewFrom;this.doc.iter(a,this.display.viewTo,function(l){if(l.widgets){for(var u=0;u<l.widgets.length;u++)if(l.widgets[u].noHScroll){mn(o,a,"widget");break}}++a}),this.curOp.forceUpdate=!0,Ae(this,"refresh",this)}),operation:function(n){return wt(this,n)},startOperation:function(){return Wn(this)},endOperation:function(){return Fn(this)},refresh:at(function(){var n=this.display.cachedTextHeight;ht(this),this.curOp.forceUpdate=!0,Dr(this),Fr(this,this.doc.scrollLeft,this.doc.scrollTop),Eo(this.display),(n==null||Math.abs(n-tr(this.display))>.5||this.options.lineWrapping)&&mo(this),Ae(this,"refresh",this)}),swapDoc:at(function(n){var i=this.doc;return i.cm=null,this.state.selectingText&&this.state.selectingText(),ia(this,n),Dr(this),this.display.input.reset(),Fr(this,n.scrollLeft,n.scrollTop),this.curOp.forceScroll=!0,je(this,"swapDoc",this,i),i}),phrase:function(n){var i=this.options.phrases;return i&&Object.prototype.hasOwnProperty.call(i,n)?i[n]:n},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ot(e),e.registerHelper=function(n,i,o){r.hasOwnProperty(n)||(r[n]=e[n]={_global:[]}),r[n][i]=o},e.registerGlobalHelper=function(n,i,o,s){e.registerHelper(n,i,s),r[n]._global.push({pred:o,val:s})}}function Go(e,t,r,n,i){var o=t,s=r,a=se(e,t.line),l=i&&e.direction=="rtl"?-r:r;function u(){var ne=t.line+l;return ne<e.first||ne>=e.first+e.size?!1:(t=new N(ne,t.ch,t.sticky),a=se(e,ne))}function p(ne){var V;if(n=="codepoint"){var ie=a.text.charCodeAt(t.ch+(r>0?0:-1));if(isNaN(ie))V=null;else{var fe=r>0?ie>=55296&&ie<56320:ie>=56320&&ie<57343;V=new N(t.line,Math.max(0,Math.min(a.text.length,t.ch+r*(fe?2:1))),-r)}}else i?V=$u(e.cm,a,t,r):V=Wo(a,t,r);if(V==null)if(!ne&&u())t=Fo(i,e.cm,a,t.line,l);else return!1;else t=V;return!0}if(n=="char"||n=="codepoint")p();else if(n=="column")p(!0);else if(n=="word"||n=="group")for(var y=null,L=n=="group",k=e.cm&&e.cm.getHelper(t,"wordChars"),D=!0;!(r<0&&!p(!D));D=!1){var _=a.text.charAt(t.ch)||`
`,K=Yt(_,k)?"w":L&&_==`
`?"n":!L||/\s/.test(_)?null:"p";if(L&&!D&&!K&&(K="s"),y&&y!=K){r<0&&(r=1,p(),t.sticky="after");break}if(K&&(y=K),r>0&&!p(!D))break}var Q=Hi(e,t,o,s,!0);return we(o,Q)&&(Q.hitSide=!0),Q}function Za(e,t,r,n){var i=e.doc,o=t.left,s;if(n=="page"){var a=Math.min(e.display.wrapper.clientHeight,ce(e).innerHeight||i(e).documentElement.clientHeight),l=Math.max(a-.5*tr(e.display),3);s=(r>0?t.bottom:t.top)+r*l}else n=="line"&&(s=r>0?t.bottom+3:t.top-3);for(var u;u=ho(e,o,s),!!u.outside;){if(r<0?s<=0:s>=i.height){u.hitSide=!0;break}s+=r*5}return u}var ke=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Et,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};ke.prototype.init=function(e){var t=this,r=this,n=r.cm,i=r.div=e.lineDiv;i.contentEditable=!0,Uo(i,n.options.spellcheck,n.options.autocorrect,n.options.autocapitalize);function o(a){for(var l=a.target;l;l=l.parentNode){if(l==i)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(l.className))break}return!1}ue(i,"paste",function(a){!o(a)||Ne(n,a)||Xa(a,n)||W<=11&&setTimeout(Xe(n,function(){return t.updateFromDOM()}),20)}),ue(i,"compositionstart",function(a){t.composing={data:a.data,done:!1}}),ue(i,"compositionupdate",function(a){t.composing||(t.composing={data:a.data,done:!1})}),ue(i,"compositionend",function(a){t.composing&&(a.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),ue(i,"touchstart",function(){return r.forceCompositionEnd()}),ue(i,"input",function(){t.composing||t.readFromDOMSoon()});function s(a){if(!(!o(a)||Ne(n,a))){if(n.somethingSelected())qi({lineWise:!1,text:n.getSelections()}),a.type=="cut"&&n.replaceSelection("",null,"cut");else if(n.options.lineWiseCopyCut){var l=Ya(n);qi({lineWise:!0,text:l.text}),a.type=="cut"&&n.operation(function(){n.setSelections(l.ranges,0,Qe),n.replaceSelection("",null,"cut")})}else return;if(a.clipboardData){a.clipboardData.clearData();var u=Rt.text.join(`
`);if(a.clipboardData.setData("Text",u),a.clipboardData.getData("Text")==u){a.preventDefault();return}}var p=Ja(),y=p.firstChild;Uo(y),n.display.lineSpace.insertBefore(p,n.display.lineSpace.firstChild),y.value=Rt.text.join(`
`);var L=Te(Me(i));Bt(y),setTimeout(function(){n.display.lineSpace.removeChild(p),L.focus(),L==i&&r.showPrimarySelection()},50)}}ue(i,"copy",s),ue(i,"cut",s)},ke.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},ke.prototype.prepareSelection=function(){var e=_s(this.cm,!1);return e.focus=Te(Me(this.div))==this.div,e},ke.prototype.showSelection=function(e,t){!e||!this.cm.display.view.length||((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},ke.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},ke.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,r=t.doc.sel.primary(),n=r.from(),i=r.to();if(t.display.viewTo==t.display.viewFrom||n.line>=t.display.viewTo||i.line<t.display.viewFrom){e.removeAllRanges();return}var o=_i(t,e.anchorNode,e.anchorOffset),s=_i(t,e.focusNode,e.focusOffset);if(!(o&&!o.bad&&s&&!s.bad&&ee(Zn(o,s),n)==0&&ee(dt(o,s),i)==0)){var a=t.display.view,l=n.line>=t.display.viewFrom&&Qa(t,n)||{node:a[0].measure.map[2],offset:0},u=i.line<t.display.viewTo&&Qa(t,i);if(!u){var p=a[a.length-1].measure,y=p.maps?p.maps[p.maps.length-1]:p.map;u={node:y[y.length-1],offset:y[y.length-2]-y[y.length-3]}}if(!l||!u){e.removeAllRanges();return}var L=e.rangeCount&&e.getRangeAt(0),k;try{k=Se(l.node,l.offset,u.offset,u.node)}catch{}k&&(!w&&t.state.focused?(e.collapse(l.node,l.offset),k.collapsed||(e.removeAllRanges(),e.addRange(k))):(e.removeAllRanges(),e.addRange(k)),L&&e.anchorNode==null?e.addRange(L):w&&this.startGracePeriod()),this.rememberSelection()}},ke.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},ke.prototype.showMultipleSelections=function(e){z(this.cm.display.cursorDiv,e.cursors),z(this.cm.display.selectionDiv,e.selection)},ke.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},ke.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Ce(this.div,t)},ke.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||Te(Me(this.div))!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},ke.prototype.blur=function(){this.div.blur()},ke.prototype.getField=function(){return this.div},ke.prototype.supportsTouch=function(){return!0},ke.prototype.receivedFocus=function(){var e=this,t=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):wt(this.cm,function(){return t.cm.curOp.selectionChanged=!0});function r(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,r))}this.polling.set(this.cm.options.pollInterval,r)},ke.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},ke.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var e=this.getSelection(),t=this.cm;if(E&&P&&this.cm.display.gutterSpecs.length&&vf(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var r=_i(t,e.anchorNode,e.anchorOffset),n=_i(t,e.focusNode,e.focusOffset);r&&n&&wt(t,function(){rt(t.doc,bn(r,n),Qe),(r.bad||n.bad)&&(t.curOp.selectionChanged=!0)})}}},ke.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,t=e.display,r=e.doc.sel.primary(),n=r.from(),i=r.to();if(n.ch==0&&n.line>e.firstLine()&&(n=N(n.line-1,se(e.doc,n.line-1).length)),i.ch==se(e.doc,i.line).text.length&&i.line<e.lastLine()&&(i=N(i.line+1,0)),n.line<t.viewFrom||i.line>t.viewTo-1)return!1;var o,s,a;n.line==t.viewFrom||(o=Nn(e,n.line))==0?(s=f(t.view[0].line),a=t.view[0].node):(s=f(t.view[o].line),a=t.view[o-1].node.nextSibling);var l=Nn(e,i.line),u,p;if(l==t.view.length-1?(u=t.viewTo-1,p=t.lineDiv.lastChild):(u=f(t.view[l+1].line)-1,p=t.view[l+1].node.previousSibling),!a)return!1;for(var y=e.doc.splitLines(gf(e,a,p,s,u)),L=Qt(e.doc,N(s,0),N(u,se(e.doc,u).text.length));y.length>1&&L.length>1;)if(me(y)==me(L))y.pop(),L.pop(),u--;else if(y[0]==L[0])y.shift(),L.shift(),s++;else break;for(var k=0,D=0,_=y[0],K=L[0],Q=Math.min(_.length,K.length);k<Q&&_.charCodeAt(k)==K.charCodeAt(k);)++k;for(var ne=me(y),V=me(L),ie=Math.min(ne.length-(y.length==1?k:0),V.length-(L.length==1?k:0));D<ie&&ne.charCodeAt(ne.length-D-1)==V.charCodeAt(V.length-D-1);)++D;if(y.length==1&&L.length==1&&s==n.line)for(;k&&k>n.ch&&ne.charCodeAt(ne.length-D-1)==V.charCodeAt(V.length-D-1);)k--,D++;y[y.length-1]=ne.slice(0,ne.length-D).replace(/^\u200b+/,""),y[0]=y[0].slice(k).replace(/\u200b+$/,"");var fe=N(s,k),le=N(u,L.length?me(L).length-D:0);if(y.length>1||y[0]||ee(fe,le))return ur(e.doc,y,fe,le,"+input"),!0},ke.prototype.ensurePolled=function(){this.forceCompositionEnd()},ke.prototype.reset=function(){this.forceCompositionEnd()},ke.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},ke.prototype.readFromDOMSoon=function(){var e=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing)if(e.composing.done)e.composing=null;else return;e.updateFromDOM()},80))},ke.prototype.updateFromDOM=function(){var e=this;(this.cm.isReadOnly()||!this.pollContent())&&wt(this.cm,function(){return ht(e.cm)})},ke.prototype.setUneditable=function(e){e.contentEditable="false"},ke.prototype.onKeyPress=function(e){e.charCode==0||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Xe(this.cm,zo)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0))},ke.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")},ke.prototype.onContextMenu=function(){},ke.prototype.resetPosition=function(){},ke.prototype.needsContentAttribute=!0;function Qa(e,t){var r=uo(e,t.line);if(!r||r.hidden)return null;var n=se(e.doc,t.line),i=Ts(r,n,t.line),o=ye(n,e.doc.direction),s="left";if(o){var a=cn(o,t.ch);s=a%2?"right":"left"}var l=Bs(i.map,t.ch,s);return l.offset=l.collapse=="right"?l.end:l.start,l}function vf(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function pr(e,t){return t&&(e.bad=!0),e}function gf(e,t,r,n,i){var o="",s=!1,a=e.doc.lineSeparator(),l=!1;function u(k){return function(D){return D.id==k}}function p(){s&&(o+=a,l&&(o+=a),s=l=!1)}function y(k){k&&(p(),o+=k)}function L(k){if(k.nodeType==1){var D=k.getAttribute("cm-text");if(D){y(D);return}var _=k.getAttribute("cm-marker"),K;if(_){var Q=e.findMarks(N(n,0),N(i+1,0),u(+_));Q.length&&(K=Q[0].find(0))&&y(Qt(e.doc,K.from,K.to).join(a));return}if(k.getAttribute("contenteditable")=="false")return;var ne=/^(pre|div|p|li|table|br)$/i.test(k.nodeName);if(!/^br$/i.test(k.nodeName)&&k.textContent.length==0)return;ne&&p();for(var V=0;V<k.childNodes.length;V++)L(k.childNodes[V]);/^(pre|p)$/i.test(k.nodeName)&&(l=!0),ne&&(s=!0)}else k.nodeType==3&&y(k.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;L(t),t!=r;)t=t.nextSibling,l=!1;return o}function _i(e,t,r){var n;if(t==e.display.lineDiv){if(n=e.display.lineDiv.childNodes[r],!n)return pr(e.clipPos(N(e.display.viewTo-1)),!0);t=null,r=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==n)return mf(o,t,r)}}function mf(e,t,r){var n=e.text.firstChild,i=!1;if(!t||!Ce(n,t))return pr(N(f(e.line),0),!0);if(t==n&&(i=!0,t=n.childNodes[r],r=0,!t)){var o=e.rest?me(e.rest):e.line;return pr(N(f(o),o.text.length),i)}var s=t.nodeType==3?t:null,a=t;for(!s&&t.childNodes.length==1&&t.firstChild.nodeType==3&&(s=t.firstChild,r&&(r=s.nodeValue.length));a.parentNode!=n;)a=a.parentNode;var l=e.measure,u=l.maps;function p(K,Q,ne){for(var V=-1;V<(u?u.length:0);V++)for(var ie=V<0?l.map:u[V],fe=0;fe<ie.length;fe+=3){var le=ie[fe+2];if(le==K||le==Q){var ve=f(V<0?e.line:e.rest[V]),Le=ie[fe]+ne;return(ne<0||le!=K)&&(Le=ie[fe+(ne?1:0)]),N(ve,Le)}}}var y=p(s,a,r);if(y)return pr(y,i);for(var L=a.nextSibling,k=s?s.nodeValue.length-r:0;L;L=L.nextSibling){if(y=p(L,L.firstChild,0),y)return pr(N(y.line,y.ch-k),i);k+=L.textContent.length}for(var D=a.previousSibling,_=r;D;D=D.previousSibling){if(y=p(D,D.firstChild,-1),y)return pr(N(y.line,y.ch+_),i);_+=D.textContent.length}}var Fe=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Et,this.hasSelection=!1,this.composing=null,this.resetting=!1};Fe.prototype.init=function(e){var t=this,r=this,n=this.cm;this.createField(e);var i=this.textarea;e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),x&&(i.style.width="0px"),ue(i,"input",function(){B&&W>=9&&t.hasSelection&&(t.hasSelection=null),r.poll()}),ue(i,"paste",function(s){Ne(n,s)||Xa(s,n)||(n.state.pasteIncoming=+new Date,r.fastPoll())});function o(s){if(!Ne(n,s)){if(n.somethingSelected())qi({lineWise:!1,text:n.getSelections()});else if(n.options.lineWiseCopyCut){var a=Ya(n);qi({lineWise:!0,text:a.text}),s.type=="cut"?n.setSelections(a.ranges,null,Qe):(r.prevInput="",i.value=a.text.join(`
`),Bt(i))}else return;s.type=="cut"&&(n.state.cutIncoming=+new Date)}}ue(i,"cut",o),ue(i,"copy",o),ue(e.scroller,"paste",function(s){if(!(tn(e,s)||Ne(n,s))){if(!i.dispatchEvent){n.state.pasteIncoming=+new Date,r.focus();return}var a=new Event("paste");a.clipboardData=s.clipboardData,i.dispatchEvent(a)}}),ue(e.lineSpace,"selectstart",function(s){tn(e,s)||nt(s)}),ue(i,"compositionstart",function(){var s=n.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:s,range:n.markText(s,n.getCursor("to"),{className:"CodeMirror-composing"})}}),ue(i,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},Fe.prototype.createField=function(e){this.wrapper=Ja(),this.textarea=this.wrapper.firstChild;var t=this.cm.options;Uo(this.textarea,t.spellcheck,t.autocorrect,t.autocapitalize)},Fe.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},Fe.prototype.prepareSelection=function(){var e=this.cm,t=e.display,r=e.doc,n=_s(e);if(e.options.moveInputWithCursor){var i=Ft(e,r.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),s=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,i.top+s.top-o.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,i.left+s.left-o.left))}return n},Fe.prototype.showSelection=function(e){var t=this.cm,r=t.display;z(r.cursorDiv,e.cursors),z(r.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Fe.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing&&e)){var t=this.cm;if(this.resetting=!0,t.somethingSelected()){this.prevInput="";var r=t.getSelection();this.textarea.value=r,t.state.focused&&Bt(this.textarea),B&&W>=9&&(this.hasSelection=r)}else e||(this.prevInput=this.textarea.value="",B&&W>=9&&(this.hasSelection=null));this.resetting=!1}},Fe.prototype.getField=function(){return this.textarea},Fe.prototype.supportsTouch=function(){return!1},Fe.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!I||Te(Me(this.textarea))!=this.textarea))try{this.textarea.focus()}catch{}},Fe.prototype.blur=function(){this.textarea.blur()},Fe.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Fe.prototype.receivedFocus=function(){this.slowPoll()},Fe.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},Fe.prototype.fastPoll=function(){var e=!1,t=this;t.pollingFast=!0;function r(){var n=t.poll();!n&&!e?(e=!0,t.polling.set(60,r)):(t.pollingFast=!1,t.slowPoll())}t.polling.set(20,r)},Fe.prototype.poll=function(){var e=this,t=this.cm,r=this.textarea,n=this.prevInput;if(this.contextMenuPending||this.resetting||!t.state.focused||pn(r)&&!n&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=r.value;if(i==n&&!t.somethingSelected())return!1;if(B&&W>=9&&this.hasSelection===i||F&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=i.charCodeAt(0);if(o==8203&&!n&&(n="​"),o==8666)return this.reset(),this.cm.execCommand("undo")}for(var s=0,a=Math.min(n.length,i.length);s<a&&n.charCodeAt(s)==i.charCodeAt(s);)++s;return wt(t,function(){zo(t,i.slice(s),n.length-s,null,e.composing?"*compose":null),i.length>1e3||i.indexOf(`
`)>-1?r.value=e.prevInput="":e.prevInput=i,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Fe.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Fe.prototype.onKeyPress=function(){B&&W>=9&&(this.hasSelection=null),this.fastPoll()},Fe.prototype.onContextMenu=function(e){var t=this,r=t.cm,n=r.display,i=t.textarea;t.contextMenuPending&&t.contextMenuPending();var o=An(r,e),s=n.scroller.scrollTop;if(!o||q)return;var a=r.options.resetSelectionOnContextMenu;a&&r.doc.sel.contains(o)==-1&&Xe(r,rt)(r.doc,bn(o),Qe);var l=i.style.cssText,u=t.wrapper.style.cssText,p=t.wrapper.offsetParent.getBoundingClientRect();t.wrapper.style.cssText="position: static",i.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(e.clientY-p.top-5)+"px; left: "+(e.clientX-p.left-5)+`px;
      z-index: 1000; background: `+(B?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var y;A&&(y=i.ownerDocument.defaultView.scrollY),n.input.focus(),A&&i.ownerDocument.defaultView.scrollTo(null,y),n.input.reset(),r.somethingSelected()||(i.value=t.prevInput=" "),t.contextMenuPending=k,n.selForContextMenu=r.doc.sel,clearTimeout(n.detectingSelectAll);function L(){if(i.selectionStart!=null){var _=r.somethingSelected(),K="​"+(_?i.value:"");i.value="⇚",i.value=K,t.prevInput=_?"":"​",i.selectionStart=1,i.selectionEnd=K.length,n.selForContextMenu=r.doc.sel}}function k(){if(t.contextMenuPending==k&&(t.contextMenuPending=!1,t.wrapper.style.cssText=u,i.style.cssText=l,B&&W<9&&n.scrollbars.setScrollTop(n.scroller.scrollTop=s),i.selectionStart!=null)){(!B||B&&W<9)&&L();var _=0,K=function(){n.selForContextMenu==r.doc.sel&&i.selectionStart==0&&i.selectionEnd>0&&t.prevInput=="​"?Xe(r,ma)(r):_++<10?n.detectingSelectAll=setTimeout(K,500):(n.selForContextMenu=null,n.input.reset())};n.detectingSelectAll=setTimeout(K,200)}}if(B&&W>=9&&L(),U){dn(e);var D=function(){tt(window,"mouseup",D),setTimeout(k,20)};ue(window,"mouseup",D)}else setTimeout(k,50)},Fe.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled=e=="nocursor",this.textarea.readOnly=!!e},Fe.prototype.setUneditable=function(){},Fe.prototype.needsContentAttribute=!1;function yf(e,t){if(t=t?pe(t):{},t.value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),t.autofocus==null){var r=Te(Me(e));t.autofocus=r==e||e.getAttribute("autofocus")!=null&&r==document.body}function n(){e.value=a.getValue()}var i;if(e.form&&(ue(e.form,"submit",n),!t.leaveSubmitMethodAlone)){var o=e.form;i=o.submit;try{var s=o.submit=function(){n(),o.submit=i,o.submit(),o.submit=s}}catch{}}t.finishInit=function(l){l.save=n,l.getTextArea=function(){return e},l.toTextArea=function(){l.toTextArea=isNaN,n(),e.parentNode.removeChild(l.getWrapperElement()),e.style.display="",e.form&&(tt(e.form,"submit",n),!t.leaveSubmitMethodAlone&&typeof e.form.submit=="function"&&(e.form.submit=i))}},e.style.display="none";var a=Ie(function(l){return e.parentNode.insertBefore(l,e.nextSibling)},t);return a}function bf(e){e.off=tt,e.on=ue,e.wheelEventPixels=Cu,e.Doc=pt,e.splitLines=It,e.countColumn=be,e.findColumn=Oe,e.isWordChar=Cr,e.Pass=St,e.signal=Ae,e.Line=Qn,e.changeEnd=wn,e.scrollbarModel=Xs,e.Pos=N,e.cmpPos=ee,e.modes=jn,e.mimeModes=Ht,e.resolveMode=Xn,e.getMode=$n,e.modeExtensions=vn,e.extendMode=Yn,e.copyState=Ut,e.startState=Jn,e.innerMode=Ir,e.commands=Qr,e.keyMap=rn,e.keyName=Na,e.isModifierKey=Oa,e.lookupKey=cr,e.normalizeKeyMap=Xu,e.StringStream=He,e.SharedTextMarker=Yr,e.TextMarker=Sn,e.LineWidget=$r,e.e_preventDefault=nt,e.e_stopPropagation=Gn,e.e_stop=dn,e.addClass=Ee,e.contains=Ce,e.rmClass=J,e.keyNames=kn}ff(Ie),pf(Ie);var wf="iter insert remove copy getEditor constructor".split(" ");for(var zi in pt.prototype)pt.prototype.hasOwnProperty(zi)&&he(wf,zi)<0&&(Ie.prototype[zi]=function(e){return function(){return e.apply(this.doc,arguments)}}(pt.prototype[zi]));return Ot(pt),Ie.inputStyles={textarea:Fe,contenteditable:ke},Ie.defineMode=function(e){!Ie.defaults.mode&&e!="null"&&(Ie.defaults.mode=e),Dt.apply(this,arguments)},Ie.defineMIME=Mn,Ie.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),Ie.defineMIME("text/plain","null"),Ie.defineExtension=function(e,t){Ie.prototype[e]=t},Ie.defineDocExtension=function(e,t){pt.prototype[e]=t},Ie.fromTextArea=yf,bf(Ie),Ie.version="5.65.20",Ie})}(Xo)),Xo.exports}var kf=En();const Lf=Sf(kf);(function(d,h){(function(c){c(En())})(function(c){c.defineMode("javascript",function(v,w){var S=v.indentUnit,T=w.statementIndent,O=w.jsonld,B=w.json||O,W=w.trackScope!==!1,A=w.typescript,j=w.wordCharacters||/[\w$\xa1-\uffff]/,P=function(){function f(Ke){return{type:Ke,style:"keyword"}}var m=f("keyword a"),R=f("keyword b"),G=f("keyword c"),N=f("keyword d"),ee=f("operator"),we={type:"atom",style:"atom"};return{if:f("if"),while:m,with:m,else:R,do:R,try:R,finally:R,return:N,break:N,continue:N,new:f("new"),delete:G,void:G,throw:G,debugger:f("debugger"),var:f("var"),const:f("var"),let:f("var"),function:f("function"),catch:f("catch"),for:f("for"),switch:f("switch"),case:f("case"),default:f("default"),in:ee,typeof:ee,instanceof:ee,true:we,false:we,null:we,undefined:we,NaN:we,Infinity:we,this:f("this"),class:f("class"),super:f("atom"),yield:G,export:f("export"),import:f("import"),extends:G,await:G}}(),$=/[+\-*&%=<>!?|~^@]/,q=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function re(f){for(var m=!1,R,G=!1;(R=f.next())!=null;){if(!m){if(R=="/"&&!G)return;R=="["?G=!0:G&&R=="]"&&(G=!1)}m=!m&&R=="\\"}}var te,b;function x(f,m,R){return te=f,b=R,m}function E(f,m){var R=f.next();if(R=='"'||R=="'")return m.tokenize=I(R),m.tokenize(f,m);if(R=="."&&f.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return x("number","number");if(R=="."&&f.match(".."))return x("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(R))return x(R);if(R=="="&&f.eat(">"))return x("=>","operator");if(R=="0"&&f.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return x("number","number");if(/\d/.test(R))return f.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),x("number","number");if(R=="/")return f.eat("*")?(m.tokenize=F,F(f,m)):f.eat("/")?(f.skipToEnd(),x("comment","comment")):Lt(f,m,1)?(re(f),f.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),x("regexp","string-2")):(f.eat("="),x("operator","operator",f.current()));if(R=="`")return m.tokenize=X,X(f,m);if(R=="#"&&f.peek()=="!")return f.skipToEnd(),x("meta","meta");if(R=="#"&&f.eatWhile(j))return x("variable","property");if(R=="<"&&f.match("!--")||R=="-"&&f.match("->")&&!/\S/.test(f.string.slice(0,f.start)))return f.skipToEnd(),x("comment","comment");if($.test(R))return(R!=">"||!m.lexical||m.lexical.type!=">")&&(f.eat("=")?(R=="!"||R=="=")&&f.eat("="):/[<>*+\-|&?]/.test(R)&&(f.eat(R),R==">"&&f.eat(R))),R=="?"&&f.eat(".")?x("."):x("operator","operator",f.current());if(j.test(R)){f.eatWhile(j);var G=f.current();if(m.lastType!="."){if(P.propertyIsEnumerable(G)){var N=P[G];return x(N.type,N.style,G)}if(G=="async"&&f.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return x("async","keyword",G)}return x("variable","variable",G)}}function I(f){return function(m,R){var G=!1,N;if(O&&m.peek()=="@"&&m.match(q))return R.tokenize=E,x("jsonld-keyword","meta");for(;(N=m.next())!=null&&!(N==f&&!G);)G=!G&&N=="\\";return G||(R.tokenize=E),x("string","string")}}function F(f,m){for(var R=!1,G;G=f.next();){if(G=="/"&&R){m.tokenize=E;break}R=G=="*"}return x("comment","comment")}function X(f,m){for(var R=!1,G;(G=f.next())!=null;){if(!R&&(G=="`"||G=="$"&&f.eat("{"))){m.tokenize=E;break}R=!R&&G=="\\"}return x("quasi","string-2",f.current())}var C="([{}])";function H(f,m){m.fatArrowAt&&(m.fatArrowAt=null);var R=f.string.indexOf("=>",f.start);if(!(R<0)){if(A){var G=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(f.string.slice(f.start,R));G&&(R=G.index)}for(var N=0,ee=!1,we=R-1;we>=0;--we){var Ke=f.string.charAt(we),dt=C.indexOf(Ke);if(dt>=0&&dt<3){if(!N){++we;break}if(--N==0){Ke=="("&&(ee=!0);break}}else if(dt>=3&&dt<6)++N;else if(j.test(Ke))ee=!0;else if(/["'\/`]/.test(Ke))for(;;--we){if(we==0)return;var Zn=f.string.charAt(we-1);if(Zn==Ke&&f.string.charAt(we-2)!="\\"){we--;break}}else if(ee&&!N){++we;break}}ee&&!N&&(m.fatArrowAt=we)}}var Z={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function U(f,m,R,G,N,ee){this.indented=f,this.column=m,this.type=R,this.prev=N,this.info=ee,G!=null&&(this.align=G)}function Y(f,m){if(!W)return!1;for(var R=f.localVars;R;R=R.next)if(R.name==m)return!0;for(var G=f.context;G;G=G.prev)for(var R=G.vars;R;R=R.next)if(R.name==m)return!0}function J(f,m,R,G,N){var ee=f.cc;for(M.state=f,M.stream=N,M.marked=null,M.cc=ee,M.style=m,f.lexical.hasOwnProperty("align")||(f.lexical.align=!0);;){var we=ee.length?ee.pop():B?he:be;if(we(R,G)){for(;ee.length&&ee[ee.length-1].lex;)ee.pop()();return M.marked?M.marked:R=="variable"&&Y(f,G)?"variable-2":m}}}var M={state:null,marked:null,cc:null};function z(){for(var f=arguments.length-1;f>=0;f--)M.cc.push(arguments[f])}function g(){return z.apply(null,arguments),!0}function ge(f,m){for(var R=m;R;R=R.next)if(R.name==f)return!0;return!1}function Se(f){var m=M.state;if(M.marked="def",!!W){if(m.context){if(m.lexical.info=="var"&&m.context&&m.context.block){var R=Ce(f,m.context);if(R!=null){m.context=R;return}}else if(!ge(f,m.localVars)){m.localVars=new Re(f,m.localVars);return}}w.globalVars&&!ge(f,m.globalVars)&&(m.globalVars=new Re(f,m.globalVars))}}function Ce(f,m){if(m)if(m.block){var R=Ce(f,m.prev);return R?R==m.prev?m:new Ee(R,m.vars,!0):null}else return ge(f,m.vars)?m:new Ee(m.prev,new Re(f,m.vars),!1);else return null}function Te(f){return f=="public"||f=="private"||f=="protected"||f=="abstract"||f=="readonly"}function Ee(f,m,R){this.prev=f,this.vars=m,this.block=R}function Re(f,m){this.name=f,this.next=m}var Bt=new Re("this",new Re("arguments",null));function ot(){M.state.context=new Ee(M.state.context,M.state.localVars,!1),M.state.localVars=Bt}function yt(){M.state.context=new Ee(M.state.context,M.state.localVars,!0),M.state.localVars=null}ot.lex=yt.lex=!0;function Me(){M.state.localVars=M.state.context.vars,M.state.context=M.state.context.prev}Me.lex=!0;function ce(f,m){var R=function(){var G=M.state,N=G.indented;if(G.lexical.type=="stat")N=G.lexical.indented;else for(var ee=G.lexical;ee&&ee.type==")"&&ee.align;ee=ee.prev)N=ee.indented;G.lexical=new U(N,M.stream.column(),f,null,G.lexical,m)};return R.lex=!0,R}function ae(){var f=M.state;f.lexical.prev&&(f.lexical.type==")"&&(f.indented=f.lexical.indented),f.lexical=f.lexical.prev)}ae.lex=!0;function pe(f){function m(R){return R==f?g():f==";"||R=="}"||R==")"||R=="]"?z():g(m)}return m}function be(f,m){return f=="var"?g(ce("vardef",m),Gn,pe(";"),ae):f=="keyword a"?g(ce("form"),St,be,ae):f=="keyword b"?g(ce("form"),be,ae):f=="keyword d"?M.stream.match(/^\s*$/,!1)?g():g(ce("stat"),kt,pe(";"),ae):f=="debugger"?g(pe(";")):f=="{"?g(ce("}"),yt,zt,ae,Me):f==";"?g():f=="if"?(M.state.lexical.info=="else"&&M.state.cc[M.state.cc.length-1]==ae&&M.state.cc.pop()(),g(ce("form"),St,be,ae,Kn)):f=="function"?g(It):f=="for"?g(ce("form"),yt,ci,be,Me,ae):f=="class"||A&&m=="interface"?(M.marked="keyword",g(ce("form",f=="class"?f:m),jn,ae)):f=="variable"?A&&m=="declare"?(M.marked="keyword",g(be)):A&&(m=="module"||m=="enum"||m=="type")&&M.stream.match(/^\s*\w/,!1)?(M.marked="keyword",m=="enum"?g(se):m=="type"?g(di,pe("operator"),ye,pe(";")):g(ce("form"),ct,pe("{"),ce("}"),zt,ae,ae)):A&&m=="namespace"?(M.marked="keyword",g(ce("form"),he,be,ae)):A&&m=="abstract"?(M.marked="keyword",g(be)):g(ce("stat"),Yi):f=="switch"?g(ce("form"),St,pe("{"),ce("}","switch"),yt,zt,ae,ae,Me):f=="case"?g(he,pe(":")):f=="default"?g(pe(":")):f=="catch"?g(ce("form"),ot,Et,be,ae,Me):f=="export"?g(ce("stat"),Xn,ae):f=="import"?g(ce("stat"),vn,ae):f=="async"?g(be):m=="@"?g(he,be):z(ce("stat"),he,pe(";"),ae)}function Et(f){if(f=="(")return g(Nt,pe(")"))}function he(f,m){return Qe(f,m,!1)}function Ue(f,m){return Qe(f,m,!0)}function St(f){return f!="("?z():g(ce(")"),kt,pe(")"),ae)}function Qe(f,m,R){if(M.state.fatArrowAt==M.stream.start){var G=R?Tn:me;if(f=="(")return g(ot,ce(")"),qe(Nt,")"),ae,pe("=>"),G,Me);if(f=="variable")return z(ot,ct,pe("=>"),G,Me)}var N=R?Oe:st;return Z.hasOwnProperty(f)?g(N):f=="function"?g(It,N):f=="class"||A&&m=="interface"?(M.marked="keyword",g(ce("form"),Qi,ae)):f=="keyword c"||f=="async"?g(R?Ue:he):f=="("?g(ce(")"),kt,pe(")"),ae,N):f=="operator"||f=="spread"?g(R?Ue:he):f=="["?g(ce("]"),He,ae,N):f=="{"?un(Yt,"}",null,N):f=="quasi"?z(We,N):f=="new"?g($i(R)):g()}function kt(f){return f.match(/[;\}\)\],]/)?z():z(he)}function st(f,m){return f==","?g(kt):Oe(f,m,!1)}function Oe(f,m,R){var G=R==!1?st:Oe,N=R==!1?he:Ue;if(f=="=>")return g(ot,R?Tn:me,Me);if(f=="operator")return/\+\+|--/.test(m)||A&&m=="!"?g(G):A&&m=="<"&&M.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?g(ce(">"),qe(ye,">"),ae,G):m=="?"?g(he,pe(":"),N):g(N);if(f=="quasi")return z(We,G);if(f!=";"){if(f=="(")return un(Ue,")","call",G);if(f==".")return g(Cr,G);if(f=="[")return g(ce("]"),kt,pe("]"),ae,G);if(A&&m=="as")return M.marked="keyword",g(ye,G);if(f=="regexp")return M.state.lastType=M.marked="operator",M.stream.backUp(M.stream.pos-M.stream.start-1),g(N)}}function We(f,m){return f!="quasi"?z():m.slice(m.length-2)!="${"?g(We):g(kt,ln)}function ln(f){if(f=="}")return M.marked="string-2",M.state.tokenize=X,g(We)}function me(f){return H(M.stream,M.state),z(f=="{"?be:he)}function Tn(f){return H(M.stream,M.state),z(f=="{"?be:Ue)}function $i(f){return function(m){return m=="."?g(f?li:ai):m=="variable"&&A?g(bt,f?Oe:st):z(f?Ue:he)}}function ai(f,m){if(m=="target")return M.marked="keyword",g(st)}function li(f,m){if(m=="target")return M.marked="keyword",g(Oe)}function Yi(f){return f==":"?g(ae,be):z(st,pe(";"),ae)}function Cr(f){if(f=="variable")return M.marked="property",g()}function Yt(f,m){if(f=="async")return M.marked="property",g(Yt);if(f=="variable"||M.style=="keyword"){if(M.marked="property",m=="get"||m=="set")return g(ui);var R;return A&&M.state.fatArrowAt==M.stream.start&&(R=M.stream.match(/^\s*:\s*/,!1))&&(M.state.fatArrowAt=M.stream.pos+R[0].length),g(Jt)}else{if(f=="number"||f=="string")return M.marked=O?"property":M.style+" property",g(Jt);if(f=="jsonld-keyword")return g(Jt);if(A&&Te(m))return M.marked="keyword",g(Yt);if(f=="[")return g(he,fn,pe("]"),Jt);if(f=="spread")return g(Ue,Jt);if(m=="*")return M.marked="keyword",g(Yt);if(f==":")return z(Jt)}}function ui(f){return f!="variable"?z(Jt):(M.marked="property",g(It))}function Jt(f){if(f==":")return g(Ue);if(f=="(")return z(It)}function qe(f,m,R){function G(N,ee){if(R?R.indexOf(N)>-1:N==","){var we=M.state.lexical;return we.info=="call"&&(we.pos=(we.pos||0)+1),g(function(Ke,dt){return Ke==m||dt==m?z():z(f)},G)}return N==m||ee==m?g():R&&R.indexOf(";")>-1?z(f):g(pe(m))}return function(N,ee){return N==m||ee==m?g():z(f,G)}}function un(f,m,R){for(var G=3;G<arguments.length;G++)M.cc.push(arguments[G]);return g(ce(m,R),qe(f,m),ae)}function zt(f){return f=="}"?g():z(be,zt)}function fn(f,m){if(A){if(f==":")return g(ye);if(m=="?")return g(fn)}}function In(f,m){if(A&&(f==":"||m=="in"))return g(ye)}function cn(f){if(A&&f==":")return M.stream.match(/^\s*\w+\s+is\b/,!1)?g(he,Ji,ye):g(ye)}function Ji(f,m){if(m=="is")return M.marked="keyword",g()}function ye(f,m){if(m=="keyof"||m=="typeof"||m=="infer"||m=="readonly")return M.marked="keyword",g(m=="typeof"?Ue:ye);if(f=="variable"||m=="void")return M.marked="type",g(Tt);if(m=="|"||m=="&")return g(ye);if(f=="string"||f=="number"||f=="atom")return g(Tt);if(f=="[")return g(ce("]"),qe(ye,"]",","),ae,Tt);if(f=="{")return g(ce("}"),ue,ae,Tt);if(f=="(")return g(qe(Ne,")"),fi,Tt);if(f=="<")return g(qe(ye,">"),ye);if(f=="quasi")return z(tt,Tt)}function fi(f){if(f=="=>")return g(ye)}function ue(f){return f.match(/[\}\)\]]/)?g():f==","||f==";"?g(ue):z(Zt,ue)}function Zt(f,m){if(f=="variable"||M.style=="keyword")return M.marked="property",g(Zt);if(m=="?"||f=="number"||f=="string")return g(Zt);if(f==":")return g(ye);if(f=="[")return g(pe("variable"),In,pe("]"),Zt);if(f=="(")return z(pn,Zt);if(!f.match(/[;\}\)\],]/))return g()}function tt(f,m){return f!="quasi"?z():m.slice(m.length-2)!="${"?g(tt):g(ye,Ae)}function Ae(f){if(f=="}")return M.marked="string-2",M.state.tokenize=X,g(tt)}function Ne(f,m){return f=="variable"&&M.stream.match(/^\s*[?:]/,!1)||m=="?"?g(Ne):f==":"?g(ye):f=="spread"?g(Ne):z(ye)}function Tt(f,m){if(m=="<")return g(ce(">"),qe(ye,">"),ae,Tt);if(m=="|"||f=="."||m=="&")return g(ye);if(f=="[")return g(ye,pe("]"),Tt);if(m=="extends"||m=="implements")return M.marked="keyword",g(ye);if(m=="?")return g(ye,pe(":"),ye)}function bt(f,m){if(m=="<")return g(ce(">"),qe(ye,">"),ae,Tt)}function Ot(){return z(ye,nt)}function nt(f,m){if(m=="=")return g(ye)}function Gn(f,m){return m=="enum"?(M.marked="keyword",g(se)):z(ct,fn,At,Zi)}function ct(f,m){if(A&&Te(m))return M.marked="keyword",g(ct);if(f=="variable")return Se(m),g();if(f=="spread")return g(ct);if(f=="[")return un(Er,"]");if(f=="{")return un(dn,"}")}function dn(f,m){return f=="variable"&&!M.stream.match(/^\s*:/,!1)?(Se(m),g(At)):(f=="variable"&&(M.marked="property"),f=="spread"?g(ct):f=="}"?z():f=="["?g(he,pe("]"),pe(":"),dn):g(pe(":"),ct,At))}function Er(){return z(ct,At)}function At(f,m){if(m=="=")return g(Ue)}function Zi(f){if(f==",")return g(Gn)}function Kn(f,m){if(f=="keyword b"&&m=="else")return g(ce("form","else"),be,ae)}function ci(f,m){if(m=="await")return g(ci);if(f=="(")return g(ce(")"),Tr,ae)}function Tr(f){return f=="var"?g(Gn,hn):f=="variable"?g(hn):z(hn)}function hn(f,m){return f==")"?g():f==";"?g(hn):m=="in"||m=="of"?(M.marked="keyword",g(he,hn)):z(he,hn)}function It(f,m){if(m=="*")return M.marked="keyword",g(It);if(f=="variable")return Se(m),g(It);if(f=="(")return g(ot,ce(")"),qe(Nt,")"),ae,cn,be,Me);if(A&&m=="<")return g(ce(">"),qe(Ot,">"),ae,It)}function pn(f,m){if(m=="*")return M.marked="keyword",g(pn);if(f=="variable")return Se(m),g(pn);if(f=="(")return g(ot,ce(")"),qe(Nt,")"),ae,cn,Me);if(A&&m=="<")return g(ce(">"),qe(Ot,">"),ae,pn)}function di(f,m){if(f=="keyword"||f=="variable")return M.marked="type",g(di);if(m=="<")return g(ce(">"),qe(Ot,">"),ae)}function Nt(f,m){return m=="@"&&g(he,Nt),f=="spread"?g(Nt):A&&Te(m)?(M.marked="keyword",g(Nt)):A&&f=="this"?g(fn,At):z(ct,fn,At)}function Qi(f,m){return f=="variable"?jn(f,m):Ht(f,m)}function jn(f,m){if(f=="variable")return Se(m),g(Ht)}function Ht(f,m){if(m=="<")return g(ce(">"),qe(Ot,">"),ae,Ht);if(m=="extends"||m=="implements"||A&&f==",")return m=="implements"&&(M.marked="keyword"),g(A?ye:he,Ht);if(f=="{")return g(ce("}"),Dt,ae)}function Dt(f,m){if(f=="async"||f=="variable"&&(m=="static"||m=="get"||m=="set"||A&&Te(m))&&M.stream.match(/^\s+#?[\w$\xa1-\uffff]/,!1))return M.marked="keyword",g(Dt);if(f=="variable"||M.style=="keyword")return M.marked="property",g(Mn,Dt);if(f=="number"||f=="string")return g(Mn,Dt);if(f=="[")return g(he,fn,pe("]"),Mn,Dt);if(m=="*")return M.marked="keyword",g(Dt);if(A&&f=="(")return z(pn,Dt);if(f==";"||f==",")return g(Dt);if(f=="}")return g();if(m=="@")return g(he,Dt)}function Mn(f,m){if(m=="!"||m=="?")return g(Mn);if(f==":")return g(ye,At);if(m=="=")return g(Ue);var R=M.state.lexical.prev,G=R&&R.info=="interface";return z(G?pn:It)}function Xn(f,m){return m=="*"?(M.marked="keyword",g(Jn,pe(";"))):m=="default"?(M.marked="keyword",g(he,pe(";"))):f=="{"?g(qe($n,"}"),Jn,pe(";")):z(be)}function $n(f,m){if(m=="as")return M.marked="keyword",g(pe("variable"));if(f=="variable")return z(Ue,$n)}function vn(f){return f=="string"?g():f=="("?z(he):f=="."?z(st):z(Yn,Ut,Jn)}function Yn(f,m){return f=="{"?un(Yn,"}"):(f=="variable"&&Se(m),m=="*"&&(M.marked="keyword"),g(Ir))}function Ut(f){if(f==",")return g(Yn,Ut)}function Ir(f,m){if(m=="as")return M.marked="keyword",g(Yn)}function Jn(f,m){if(m=="from")return M.marked="keyword",g(he)}function He(f){return f=="]"?g():z(qe(Ue,"]"))}function se(){return z(ce("form"),ct,pe("{"),ce("}"),qe(Qt,"}"),ae,ae)}function Qt(){return z(ct,At)}function Mr(f,m){return f.lastType=="operator"||f.lastType==","||$.test(m.charAt(0))||/[,.]/.test(m.charAt(0))}function Lt(f,m,R){return m.tokenize==E&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(m.lastType)||m.lastType=="quasi"&&/\{\s*$/.test(f.string.slice(0,f.pos-(R||0)))}return{startState:function(f){var m={tokenize:E,lastType:"sof",cc:[],lexical:new U((f||0)-S,0,"block",!1),localVars:w.localVars,context:w.localVars&&new Ee(null,null,!1),indented:f||0};return w.globalVars&&typeof w.globalVars=="object"&&(m.globalVars=w.globalVars),m},token:function(f,m){if(f.sol()&&(m.lexical.hasOwnProperty("align")||(m.lexical.align=!1),m.indented=f.indentation(),H(f,m)),m.tokenize!=F&&f.eatSpace())return null;var R=m.tokenize(f,m);return te=="comment"?R:(m.lastType=te=="operator"&&(b=="++"||b=="--")?"incdec":te,J(m,R,te,b,f))},indent:function(f,m){if(f.tokenize==F||f.tokenize==X)return c.Pass;if(f.tokenize!=E)return 0;var R=m&&m.charAt(0),G=f.lexical,N;if(!/^\s*else\b/.test(m))for(var ee=f.cc.length-1;ee>=0;--ee){var we=f.cc[ee];if(we==ae)G=G.prev;else if(we!=Kn&&we!=Me)break}for(;(G.type=="stat"||G.type=="form")&&(R=="}"||(N=f.cc[f.cc.length-1])&&(N==st||N==Oe)&&!/^[,\.=+\-*:?[\(]/.test(m));)G=G.prev;T&&G.type==")"&&G.prev.type=="stat"&&(G=G.prev);var Ke=G.type,dt=R==Ke;return Ke=="vardef"?G.indented+(f.lastType=="operator"||f.lastType==","?G.info.length+1:0):Ke=="form"&&R=="{"?G.indented:Ke=="form"?G.indented+S:Ke=="stat"?G.indented+(Mr(f,m)?T||S:0):G.info=="switch"&&!dt&&w.doubleIndentSwitch!=!1?G.indented+(/^(?:case|default)\b/.test(m)?S:2*S):G.align?G.column+(dt?0:1):G.indented+(dt?0:S)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:B?null:"/*",blockCommentEnd:B?null:"*/",blockCommentContinue:B?null:" * ",lineComment:B?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:B?"json":"javascript",jsonldMode:O,jsonMode:B,expressionAllowed:Lt,skipExpression:function(f){J(f,"atom","atom","true",new c.StringStream("",2,null))}}}),c.registerHelper("wordChars","javascript",/[\w$]/),c.defineMIME("text/javascript","javascript"),c.defineMIME("text/ecmascript","javascript"),c.defineMIME("application/javascript","javascript"),c.defineMIME("application/x-javascript","javascript"),c.defineMIME("application/ecmascript","javascript"),c.defineMIME("application/json",{name:"javascript",json:!0}),c.defineMIME("application/x-json",{name:"javascript",json:!0}),c.defineMIME("application/manifest+json",{name:"javascript",json:!0}),c.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),c.defineMIME("text/typescript",{name:"javascript",typescript:!0}),c.defineMIME("application/typescript",{name:"javascript",typescript:!0})})})();(function(d,h){(function(c){c(En())})(function(c){var v={pairs:`()[]{}''""`,closeBefore:`)]}'":;>`,triples:"",explode:"[]{}"},w=c.Pos;c.defineOption("autoCloseBrackets",!1,function(b,x,E){E&&E!=c.Init&&(b.removeKeyMap(T),b.state.closeBrackets=null),x&&(O(S(x,"pairs")),b.state.closeBrackets=x,b.addKeyMap(T))});function S(b,x){return x=="pairs"&&typeof b=="string"?b:typeof b=="object"&&b[x]!=null?b[x]:v[x]}var T={Backspace:A,Enter:j};function O(b){for(var x=0;x<b.length;x++){var E=b.charAt(x),I="'"+E+"'";T[I]||(T[I]=B(E))}}O(v.pairs+"`");function B(b){return function(x){return q(x,b)}}function W(b){var x=b.state.closeBrackets;if(!x||x.override)return x;var E=b.getModeAt(b.getCursor());return E.closeBrackets||x}function A(b){var x=W(b);if(!x||b.getOption("disableInput"))return c.Pass;for(var E=S(x,"pairs"),I=b.listSelections(),F=0;F<I.length;F++){if(!I[F].empty())return c.Pass;var X=re(b,I[F].head);if(!X||E.indexOf(X)%2!=0)return c.Pass}for(var F=I.length-1;F>=0;F--){var C=I[F].head;b.replaceRange("",w(C.line,C.ch-1),w(C.line,C.ch+1),"+delete")}}function j(b){var x=W(b),E=x&&S(x,"explode");if(!E||b.getOption("disableInput"))return c.Pass;for(var I=b.listSelections(),F=0;F<I.length;F++){if(!I[F].empty())return c.Pass;var X=re(b,I[F].head);if(!X||E.indexOf(X)%2!=0)return c.Pass}b.operation(function(){var C=b.lineSeparator()||`
`;b.replaceSelection(C+C,null),P(b,-1),I=b.listSelections();for(var H=0;H<I.length;H++){var Z=I[H].head.line;b.indentLine(Z,null,!0),b.indentLine(Z+1,null,!0)}})}function P(b,x){for(var E=[],I=b.listSelections(),F=0,X=0;X<I.length;X++){var C=I[X];C.head==b.getCursor()&&(F=X);var H=C.head.ch||x>0?{line:C.head.line,ch:C.head.ch+x}:{line:C.head.line-1};E.push({anchor:H,head:H})}b.setSelections(E,F)}function $(b){var x=c.cmpPos(b.anchor,b.head)>0;return{anchor:new w(b.anchor.line,b.anchor.ch+(x?-1:1)),head:new w(b.head.line,b.head.ch+(x?1:-1))}}function q(b,x){var E=W(b);if(!E||b.getOption("disableInput"))return c.Pass;var I=S(E,"pairs"),F=I.indexOf(x);if(F==-1)return c.Pass;for(var X=S(E,"closeBefore"),C=S(E,"triples"),H=I.charAt(F+1)==x,Z=b.listSelections(),U=F%2==0,Y,J=0;J<Z.length;J++){var M=Z[J],z=M.head,g,ge=b.getRange(z,w(z.line,z.ch+1));if(U&&!M.empty())g="surround";else if((H||!U)&&ge==x)H&&te(b,z)?g="both":C.indexOf(x)>=0&&b.getRange(z,w(z.line,z.ch+3))==x+x+x?g="skipThree":g="skip";else if(H&&z.ch>1&&C.indexOf(x)>=0&&b.getRange(w(z.line,z.ch-2),z)==x+x){if(z.ch>2&&/\bstring/.test(b.getTokenTypeAt(w(z.line,z.ch-2))))return c.Pass;g="addFour"}else if(H){var Se=z.ch==0?" ":b.getRange(w(z.line,z.ch-1),z);if(!c.isWordChar(ge)&&Se!=x&&!c.isWordChar(Se))g="both";else return c.Pass}else if(U&&(ge.length===0||/\s/.test(ge)||X.indexOf(ge)>-1))g="both";else return c.Pass;if(!Y)Y=g;else if(Y!=g)return c.Pass}var Ce=F%2?I.charAt(F-1):x,Te=F%2?x:I.charAt(F+1);b.operation(function(){if(Y=="skip")P(b,1);else if(Y=="skipThree")P(b,3);else if(Y=="surround"){for(var Ee=b.getSelections(),Re=0;Re<Ee.length;Re++)Ee[Re]=Ce+Ee[Re]+Te;b.replaceSelections(Ee,"around"),Ee=b.listSelections().slice();for(var Re=0;Re<Ee.length;Re++)Ee[Re]=$(Ee[Re]);b.setSelections(Ee)}else Y=="both"?(b.replaceSelection(Ce+Te,null),b.triggerElectric(Ce+Te),P(b,-1)):Y=="addFour"&&(b.replaceSelection(Ce+Ce+Ce+Ce,"before"),P(b,1))})}function re(b,x){var E=b.getRange(w(x.line,x.ch-1),w(x.line,x.ch+1));return E.length==2?E:null}function te(b,x){var E=b.getTokenAt(w(x.line,x.ch+1));return/\bstring/.test(E.type)&&E.start==x.ch&&(x.ch==0||!/\bstring/.test(b.getTokenTypeAt(x)))}})})();(function(d,h){(function(c){c(En())})(function(c){var v=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8),w=c.Pos,S={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function T(P){return P&&P.bracketRegex||/[(){}[\]]/}function O(P,$,q){var re=P.getLineHandle($.line),te=$.ch-1,b=q&&q.afterCursor;b==null&&(b=/(^| )cm-fat-cursor($| )/.test(P.getWrapperElement().className));var x=T(q),E=!b&&te>=0&&x.test(re.text.charAt(te))&&S[re.text.charAt(te)]||x.test(re.text.charAt(te+1))&&S[re.text.charAt(++te)];if(!E)return null;var I=E.charAt(1)==">"?1:-1;if(q&&q.strict&&I>0!=(te==$.ch))return null;var F=P.getTokenTypeAt(w($.line,te+1)),X=B(P,w($.line,te+(I>0?1:0)),I,F,q);return X==null?null:{from:w($.line,te),to:X&&X.pos,match:X&&X.ch==E.charAt(0),forward:I>0}}function B(P,$,q,re,te){for(var b=te&&te.maxScanLineLength||1e4,x=te&&te.maxScanLines||1e3,E=[],I=T(te),F=q>0?Math.min($.line+x,P.lastLine()+1):Math.max(P.firstLine()-1,$.line-x),X=$.line;X!=F;X+=q){var C=P.getLine(X);if(C){var H=q>0?0:C.length-1,Z=q>0?C.length:-1;if(!(C.length>b))for(X==$.line&&(H=$.ch-(q<0?1:0));H!=Z;H+=q){var U=C.charAt(H);if(I.test(U)&&(re===void 0||(P.getTokenTypeAt(w(X,H+1))||"")==(re||""))){var Y=S[U];if(Y&&Y.charAt(1)==">"==q>0)E.push(U);else if(E.length)E.pop();else return{pos:w(X,H),ch:U}}}}}return X-q==(q>0?P.lastLine():P.firstLine())?!1:null}function W(P,$,q){for(var re=P.state.matchBrackets.maxHighlightLineLength||1e3,te=q&&q.highlightNonMatching,b=[],x=P.listSelections(),E=0;E<x.length;E++){var I=x[E].empty()&&O(P,x[E].head,q);if(I&&(I.match||te!==!1)&&P.getLine(I.from.line).length<=re){var F=I.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";b.push(P.markText(I.from,w(I.from.line,I.from.ch+1),{className:F})),I.to&&P.getLine(I.to.line).length<=re&&b.push(P.markText(I.to,w(I.to.line,I.to.ch+1),{className:F}))}}if(b.length){v&&P.state.focused&&P.focus();var X=function(){P.operation(function(){for(var C=0;C<b.length;C++)b[C].clear()})};if($)setTimeout(X,800);else return X}}function A(P){P.operation(function(){P.state.matchBrackets.currentlyHighlighted&&(P.state.matchBrackets.currentlyHighlighted(),P.state.matchBrackets.currentlyHighlighted=null),P.state.matchBrackets.currentlyHighlighted=W(P,!1,P.state.matchBrackets)})}function j(P){P.state.matchBrackets&&P.state.matchBrackets.currentlyHighlighted&&(P.state.matchBrackets.currentlyHighlighted(),P.state.matchBrackets.currentlyHighlighted=null)}c.defineOption("matchBrackets",!1,function(P,$,q){q&&q!=c.Init&&(P.off("cursorActivity",A),P.off("focus",A),P.off("blur",j),j(P)),$&&(P.state.matchBrackets=typeof $=="object"?$:{},P.on("cursorActivity",A),P.on("focus",A),P.on("blur",j))}),c.defineExtension("matchBrackets",function(){W(this,!0)}),c.defineExtension("findMatchingBracket",function(P,$,q){return(q||typeof $=="boolean")&&(q?(q.strict=$,$=q):$=$?{strict:!0}:null),O(this,P,$)}),c.defineExtension("scanForBracket",function(P,$,q,re){return B(this,P,$,q,re)})})})();(function(d,h){(function(c){c(En())})(function(c){var v="CodeMirror-hint",w="CodeMirror-hint-active";c.showHint=function(b,x,E){if(!x)return b.showHint(E);E&&E.async&&(x.async=!0);var I={hint:x};if(E)for(var F in E)I[F]=E[F];return b.showHint(I)},c.defineExtension("showHint",function(b){b=B(this,this.getCursor("start"),b);var x=this.listSelections();if(!(x.length>1)){if(this.somethingSelected()){if(!b.hint.supportsSelection)return;for(var E=0;E<x.length;E++)if(x[E].head.line!=x[E].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var I=this.state.completionActive=new S(this,b);I.options.hint&&(c.signal(this,"startCompletion",this),I.update(!0))}}),c.defineExtension("closeHint",function(){this.state.completionActive&&this.state.completionActive.close()});function S(b,x){if(this.cm=b,this.options=x,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length,this.options.updateOnCursorActivity){var E=this;b.on("cursorActivity",this.activityFunc=function(){E.cursorActivity()})}}var T=window.requestAnimationFrame||function(b){return setTimeout(b,1e3/60)},O=window.cancelAnimationFrame||clearTimeout;S.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.options.updateOnCursorActivity&&this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&c.signal(this.data,"close"),this.widget&&this.widget.close(),c.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(b,x){var E=b.list[x],I=this;this.cm.operation(function(){E.hint?E.hint(I.cm,b,E):I.cm.replaceRange(W(E),E.from||b.from,E.to||b.to,"complete"),c.signal(b,"pick",E),I.cm.scrollIntoView()}),this.options.closeOnPick&&this.close()},cursorActivity:function(){this.debounce&&(O(this.debounce),this.debounce=0);var b=this.startPos;this.data&&(b=this.data.from);var x=this.cm.getCursor(),E=this.cm.getLine(x.line);if(x.line!=this.startPos.line||E.length-x.ch!=this.startLen-this.startPos.ch||x.ch<b.ch||this.cm.somethingSelected()||!x.ch||this.options.closeCharacters.test(E.charAt(x.ch-1)))this.close();else{var I=this;this.debounce=T(function(){I.update()}),this.widget&&this.widget.disable()}},update:function(b){if(this.tick!=null){var x=this,E=++this.tick;q(this.options.hint,this.cm,this.options,function(I){x.tick==E&&x.finishUpdate(I,b)})}},finishUpdate:function(b,x){this.data&&c.signal(this.data,"update");var E=this.widget&&this.widget.picked||x&&this.options.completeSingle;this.widget&&this.widget.close(),this.data=b,b&&b.list.length&&(E&&b.list.length==1?this.pick(b,0):(this.widget=new P(this,b),c.signal(b,"shown")))}};function B(b,x,E){var I=b.options.hintOptions,F={};for(var X in te)F[X]=te[X];if(I)for(var X in I)I[X]!==void 0&&(F[X]=I[X]);if(E)for(var X in E)E[X]!==void 0&&(F[X]=E[X]);return F.hint.resolve&&(F.hint=F.hint.resolve(b,x)),F}function W(b){return typeof b=="string"?b:b.text}function A(b,x){var E={Up:function(){x.moveFocus(-1)},Down:function(){x.moveFocus(1)},PageUp:function(){x.moveFocus(-x.menuSize()+1,!0)},PageDown:function(){x.moveFocus(x.menuSize()-1,!0)},Home:function(){x.setFocus(0)},End:function(){x.setFocus(x.length-1)},Enter:x.pick,Tab:x.pick,Esc:x.close},I=/Mac/.test(navigator.platform);I&&(E["Ctrl-P"]=function(){x.moveFocus(-1)},E["Ctrl-N"]=function(){x.moveFocus(1)});var F=b.options.customKeys,X=F?{}:E;function C(U,Y){var J;typeof Y!="string"?J=function(M){return Y(M,x)}:E.hasOwnProperty(Y)?J=E[Y]:J=Y,X[U]=J}if(F)for(var H in F)F.hasOwnProperty(H)&&C(H,F[H]);var Z=b.options.extraKeys;if(Z)for(var H in Z)Z.hasOwnProperty(H)&&C(H,Z[H]);return X}function j(b,x){for(;x&&x!=b;){if(x.nodeName.toUpperCase()==="LI"&&x.parentNode==b)return x;x=x.parentNode}}function P(b,x){this.id="cm-complete-"+Math.floor(Math.random(1e6)),this.completion=b,this.data=x,this.picked=!1;var E=this,I=b.cm,F=I.getInputField().ownerDocument,X=F.defaultView||F.parentWindow,C=this.hints=F.createElement("ul");C.setAttribute("role","listbox"),C.setAttribute("aria-expanded","true"),C.id=this.id;var H=b.cm.options.theme;C.className="CodeMirror-hints "+H,this.selectedHint=x.selectedHint||0;for(var Z=x.list,U=0;U<Z.length;++U){var Y=C.appendChild(F.createElement("li")),J=Z[U],M=v+(U!=this.selectedHint?"":" "+w);J.className!=null&&(M=J.className+" "+M),Y.className=M,U==this.selectedHint&&Y.setAttribute("aria-selected","true"),Y.id=this.id+"-"+U,Y.setAttribute("role","option"),J.render?J.render(Y,x,J):Y.appendChild(F.createTextNode(J.displayText||W(J))),Y.hintId=U}var z=b.options.container||F.body,g=I.cursorCoords(b.options.alignWithWord?x.from:null),ge=g.left,Se=g.bottom,Ce=!0,Te=0,Ee=0;if(z!==F.body){var Re=["absolute","relative","fixed"].indexOf(X.getComputedStyle(z).position)!==-1,Bt=Re?z:z.offsetParent,ot=Bt.getBoundingClientRect(),yt=F.body.getBoundingClientRect();Te=ot.left-yt.left-Bt.scrollLeft,Ee=ot.top-yt.top-Bt.scrollTop}C.style.left=ge-Te+"px",C.style.top=Se-Ee+"px";var Me=X.innerWidth||Math.max(F.body.offsetWidth,F.documentElement.offsetWidth),ce=X.innerHeight||Math.max(F.body.offsetHeight,F.documentElement.offsetHeight);z.appendChild(C),I.getInputField().setAttribute("aria-autocomplete","list"),I.getInputField().setAttribute("aria-owns",this.id),I.getInputField().setAttribute("aria-activedescendant",this.id+"-"+this.selectedHint);var ae=b.options.moveOnOverlap?C.getBoundingClientRect():new DOMRect,pe=b.options.paddingForScrollbar?C.scrollHeight>C.clientHeight+1:!1,be;setTimeout(function(){be=I.getScrollInfo()});var Et=ae.bottom-ce;if(Et>0){var he=ae.bottom-ae.top,Ue=ae.top-(g.bottom-g.top)-2;ce-ae.top<Ue?(he>Ue&&(C.style.height=(he=Ue)+"px"),C.style.top=(Se=g.top-he)-Ee+"px",Ce=!1):C.style.height=ce-ae.top-2+"px"}var St=ae.right-Me;if(pe&&(St+=I.display.nativeBarWidth),St>0&&(ae.right-ae.left>Me&&(C.style.width=Me-5+"px",St-=ae.right-ae.left-Me),C.style.left=(ge=Math.max(g.left-St-Te,0))+"px"),pe)for(var Qe=C.firstChild;Qe;Qe=Qe.nextSibling)Qe.style.paddingRight=I.display.nativeBarWidth+"px";if(I.addKeyMap(this.keyMap=A(b,{moveFocus:function(Oe,We){E.changeActive(E.selectedHint+Oe,We)},setFocus:function(Oe){E.changeActive(Oe)},menuSize:function(){return E.screenAmount()},length:Z.length,close:function(){b.close()},pick:function(){E.pick()},data:x})),b.options.closeOnUnfocus){var kt;I.on("blur",this.onBlur=function(){kt=setTimeout(function(){b.close()},100)}),I.on("focus",this.onFocus=function(){clearTimeout(kt)})}I.on("scroll",this.onScroll=function(){var Oe=I.getScrollInfo(),We=I.getWrapperElement().getBoundingClientRect();be||(be=I.getScrollInfo());var ln=Se+be.top-Oe.top,me=ln-(X.pageYOffset||(F.documentElement||F.body).scrollTop);if(Ce||(me+=C.offsetHeight),me<=We.top||me>=We.bottom)return b.close();C.style.top=ln+"px",C.style.left=ge+be.left-Oe.left+"px"}),c.on(C,"dblclick",function(Oe){var We=j(C,Oe.target||Oe.srcElement);We&&We.hintId!=null&&(E.changeActive(We.hintId),E.pick())}),c.on(C,"click",function(Oe){var We=j(C,Oe.target||Oe.srcElement);We&&We.hintId!=null&&(E.changeActive(We.hintId),b.options.completeOnSingleClick&&E.pick())}),c.on(C,"mousedown",function(){setTimeout(function(){I.focus()},20)});var st=this.getSelectedHintRange();return(st.from!==0||st.to!==0)&&this.scrollToActive(),c.signal(x,"select",Z[this.selectedHint],C.childNodes[this.selectedHint]),!0}P.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode&&this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var b=this.completion.cm.getInputField();b.removeAttribute("aria-activedescendant"),b.removeAttribute("aria-owns");var x=this.completion.cm;this.completion.options.closeOnUnfocus&&(x.off("blur",this.onBlur),x.off("focus",this.onFocus)),x.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var b=this;this.keyMap={Enter:function(){b.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(b,x){if(b>=this.data.list.length?b=x?this.data.list.length-1:0:b<0&&(b=x?0:this.data.list.length-1),this.selectedHint!=b){var E=this.hints.childNodes[this.selectedHint];E&&(E.className=E.className.replace(" "+w,""),E.removeAttribute("aria-selected")),E=this.hints.childNodes[this.selectedHint=b],E.className+=" "+w,E.setAttribute("aria-selected","true"),this.completion.cm.getInputField().setAttribute("aria-activedescendant",E.id),this.scrollToActive(),c.signal(this.data,"select",this.data.list[this.selectedHint],E)}},scrollToActive:function(){var b=this.getSelectedHintRange(),x=this.hints.childNodes[b.from],E=this.hints.childNodes[b.to],I=this.hints.firstChild;x.offsetTop<this.hints.scrollTop?this.hints.scrollTop=x.offsetTop-I.offsetTop:E.offsetTop+E.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=E.offsetTop+E.offsetHeight-this.hints.clientHeight+I.offsetTop)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1},getSelectedHintRange:function(){var b=this.completion.options.scrollMargin||0;return{from:Math.max(0,this.selectedHint-b),to:Math.min(this.data.list.length-1,this.selectedHint+b)}}};function $(b,x){if(!b.somethingSelected())return x;for(var E=[],I=0;I<x.length;I++)x[I].supportsSelection&&E.push(x[I]);return E}function q(b,x,E,I){if(b.async)b(x,I,E);else{var F=b(x,E);F&&F.then?F.then(I):I(F)}}function re(b,x){var E=b.getHelpers(x,"hint"),I;if(E.length){var F=function(X,C,H){var Z=$(X,E);function U(Y){if(Y==Z.length)return C(null);q(Z[Y],X,H,function(J){J&&J.list.length>0?C(J):U(Y+1)})}U(0)};return F.async=!0,F.supportsSelection=!0,F}else return(I=b.getHelper(b.getCursor(),"hintWords"))?function(X){return c.hint.fromList(X,{words:I})}:c.hint.anyword?function(X,C){return c.hint.anyword(X,C)}:function(){}}c.registerHelper("hint","auto",{resolve:re}),c.registerHelper("hint","fromList",function(b,x){var E=b.getCursor(),I=b.getTokenAt(E),F,X=c.Pos(E.line,I.start),C=E;I.start<E.ch&&/\w/.test(I.string.charAt(E.ch-I.start-1))?F=I.string.substr(0,E.ch-I.start):(F="",X=E);for(var H=[],Z=0;Z<x.words.length;Z++){var U=x.words[Z];U.slice(0,F.length)==F&&H.push(U)}if(H.length)return{list:H,from:X,to:C}}),c.commands.autocomplete=c.showHint;var te={hint:c.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnPick:!0,closeOnUnfocus:!0,updateOnCursorActivity:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null,paddingForScrollbar:!0,moveOnOverlap:!0};c.defineOption("hintOptions",null)})})();(function(d,h){(function(c){c(En())})(function(c){var v=c.Pos;function w(b,x){for(var E=0,I=b.length;E<I;++E)x(b[E])}function S(b,x){if(!Array.prototype.indexOf){for(var E=b.length;E--;)if(b[E]===x)return!0;return!1}return b.indexOf(x)!=-1}function T(b,x,E,I){var F=b.getCursor(),X=E(b,F);if(!/\b(?:string|comment)\b/.test(X.type)){var C=c.innerMode(b.getMode(),X.state);if(C.mode.helperType!=="json"){X.state=C.state,/^[\w$_]*$/.test(X.string)?X.end>F.ch&&(X.end=F.ch,X.string=X.string.slice(0,F.ch-X.start)):X={start:F.ch,end:F.ch,string:"",state:X.state,type:X.string=="."?"property":null};for(var H=X;H.type=="property";){if(H=E(b,v(F.line,H.start)),H.string!=".")return;if(H=E(b,v(F.line,H.start)),!Z)var Z=[];Z.push(H)}return{list:te(X,Z,x,I),from:v(F.line,X.start),to:v(F.line,X.end)}}}}function O(b,x){return T(b,$,function(E,I){return E.getTokenAt(I)},x)}c.registerHelper("hint","javascript",O);function B(b,x){var E=b.getTokenAt(x);return x.ch==E.start+1&&E.string.charAt(0)=="."?(E.end=E.start,E.string=".",E.type="property"):/^\.[\w$_]*$/.test(E.string)&&(E.type="property",E.start++,E.string=E.string.replace(/\./,"")),E}function W(b,x){return T(b,q,B,x)}c.registerHelper("hint","coffeescript",W);var A="charAt charCodeAt indexOf lastIndexOf substring substr slice trim trimLeft trimRight toUpperCase toLowerCase split concat match replace search".split(" "),j="length concat join splice push pop shift unshift slice reverse sort indexOf lastIndexOf every some filter forEach map reduce reduceRight ".split(" "),P="prototype apply call bind".split(" "),$="break case catch class const continue debugger default delete do else export extends false finally for function if in import instanceof new null return super switch this throw true try typeof var void while with yield".split(" "),q="and break catch class continue delete do else extends false finally for if in instanceof isnt new no not null of off on or return switch then throw true try typeof until void while with yes".split(" ");function re(b,x){if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)for(var E in b)x(E);else for(var I=b;I;I=Object.getPrototypeOf(I))Object.getOwnPropertyNames(I).forEach(x)}function te(b,x,E,I){var F=[],X=b.string,C=I&&I.globalScope||window;function H(g){g.lastIndexOf(X,0)==0&&!S(F,g)&&F.push(g)}function Z(g){typeof g=="string"?w(A,H):g instanceof Array?w(j,H):g instanceof Function&&w(P,H),re(g,H)}if(x&&x.length){var U=x.pop(),Y;for(U.type&&U.type.indexOf("variable")===0?(I&&I.additionalContext&&(Y=I.additionalContext[U.string]),(!I||I.useGlobalScope!==!1)&&(Y=Y||C[U.string])):U.type=="string"?Y="":U.type=="atom"?Y=1:U.type=="function"&&(C.jQuery!=null&&(U.string=="$"||U.string=="jQuery")&&typeof C.jQuery=="function"?Y=C.jQuery():C._!=null&&U.string=="_"&&typeof C._=="function"&&(Y=C._()));Y!=null&&x.length;)Y=Y[x.pop().string];Y!=null&&Z(Y)}else{for(var J=b.state.localVars;J;J=J.next)H(J.name);for(var M=b.state.context;M;M=M.prev)for(var J=M.vars;J;J=J.next)H(J.name);for(var J=b.state.globalVars;J;J=J.next)H(J.name);if(I&&I.additionalContext!=null)for(var z in I.additionalContext)H(z);(!I||I.useGlobalScope!==!1)&&Z(C),w(E,H)}return F}})})();(function(d,h){(function(c){c(En())})(function(c){var v="CodeMirror-lint-markers",w="CodeMirror-lint-line-";function S(C,H,Z){var U=document.createElement("div");U.className="CodeMirror-lint-tooltip cm-s-"+C.options.theme,U.appendChild(Z.cloneNode(!0)),C.state.lint.options.selfContain?C.getWrapperElement().appendChild(U):document.body.appendChild(U);function Y(J){if(!U.parentNode)return c.off(document,"mousemove",Y);var M=Math.max(0,J.clientY-U.offsetHeight-5),z=Math.max(0,Math.min(J.clientX+5,U.ownerDocument.defaultView.innerWidth-U.offsetWidth));U.style.top=M+"px",U.style.left=z+"px"}return c.on(document,"mousemove",Y),Y(H),U.style.opacity!=null&&(U.style.opacity=1),U}function T(C){C.parentNode&&C.parentNode.removeChild(C)}function O(C){C.parentNode&&(C.style.opacity==null&&T(C),C.style.opacity=0,setTimeout(function(){T(C)},600))}function B(C,H,Z,U){var Y=S(C,H,Z);function J(){c.off(U,"mouseout",J),Y&&(O(Y),Y=null)}var M=setInterval(function(){if(Y)for(var z=U;;z=z.parentNode){if(z&&z.nodeType==11&&(z=z.host),z==document.body)return;if(!z){J();break}}if(!Y)return clearInterval(M)},400);c.on(U,"mouseout",J)}function W(C,H,Z){this.marked=[],H instanceof Function&&(H={getAnnotations:H}),(!H||H===!0)&&(H={}),this.options={},this.linterOptions=H.options||{};for(var U in A)this.options[U]=A[U];for(var U in H)A.hasOwnProperty(U)?H[U]!=null&&(this.options[U]=H[U]):H.options||(this.linterOptions[U]=H[U]);this.timeout=null,this.hasGutter=Z,this.onMouseOver=function(Y){X(C,Y)},this.waitingFor=0}var A={highlightLines:!1,tooltips:!0,delay:500,lintOnChange:!0,getAnnotations:null,async:!1,selfContain:null,formatAnnotation:null,onUpdateLinting:null};function j(C){var H=C.state.lint;H.hasGutter&&C.clearGutter(v),H.options.highlightLines&&P(C);for(var Z=0;Z<H.marked.length;++Z)H.marked[Z].clear();H.marked.length=0}function P(C){C.eachLine(function(H){var Z=H.wrapClass&&/\bCodeMirror-lint-line-\w+\b/.exec(H.wrapClass);Z&&C.removeLineClass(H,"wrap",Z[0])})}function $(C,H,Z,U,Y){var J=document.createElement("div"),M=J;return J.className="CodeMirror-lint-marker CodeMirror-lint-marker-"+Z,U&&(M=J.appendChild(document.createElement("div")),M.className="CodeMirror-lint-marker CodeMirror-lint-marker-multiple"),Y!=!1&&c.on(M,"mouseover",function(z){B(C,z,H,M)}),J}function q(C,H){return C=="error"?C:H}function re(C){for(var H=[],Z=0;Z<C.length;++Z){var U=C[Z],Y=U.from.line;(H[Y]||(H[Y]=[])).push(U)}return H}function te(C){var H=C.severity;H||(H="error");var Z=document.createElement("div");return Z.className="CodeMirror-lint-message CodeMirror-lint-message-"+H,typeof C.messageHTML<"u"?Z.innerHTML=C.messageHTML:Z.appendChild(document.createTextNode(C.message)),Z}function b(C,H){var Z=C.state.lint,U=++Z.waitingFor;function Y(){U=-1,C.off("change",Y)}C.on("change",Y),H(C.getValue(),function(J,M){C.off("change",Y),Z.waitingFor==U&&(M&&J instanceof c&&(J=M),C.operation(function(){E(C,J)}))},Z.linterOptions,C)}function x(C){var H=C.state.lint;if(H){var Z=H.options,U=Z.getAnnotations||C.getHelper(c.Pos(0,0),"lint");if(U)if(Z.async||U.async)b(C,U);else{var Y=U(C.getValue(),H.linterOptions,C);if(!Y)return;Y.then?Y.then(function(J){C.operation(function(){E(C,J)})}):C.operation(function(){E(C,Y)})}}}function E(C,H){var Z=C.state.lint;if(Z){var U=Z.options;j(C);for(var Y=re(H),J=0;J<Y.length;++J){var M=Y[J];if(M){for(var z=null,g=Z.hasGutter&&document.createDocumentFragment(),ge=0;ge<M.length;++ge){var Se=M[ge],Ce=Se.severity;Ce||(Ce="error"),z=q(z,Ce),U.formatAnnotation&&(Se=U.formatAnnotation(Se)),Z.hasGutter&&g.appendChild(te(Se)),Se.to&&Z.marked.push(C.markText(Se.from,Se.to,{className:"CodeMirror-lint-mark CodeMirror-lint-mark-"+Ce,__annotation:Se}))}Z.hasGutter&&C.setGutterMarker(J,v,$(C,g,z,M.length>1,U.tooltips)),U.highlightLines&&C.addLineClass(J,"wrap",w+z)}}U.onUpdateLinting&&U.onUpdateLinting(H,Y,C)}}function I(C){var H=C.state.lint;H&&(clearTimeout(H.timeout),H.timeout=setTimeout(function(){x(C)},H.options.delay))}function F(C,H,Z){for(var U=Z.target||Z.srcElement,Y=document.createDocumentFragment(),J=0;J<H.length;J++){var M=H[J];Y.appendChild(te(M))}B(C,Z,Y,U)}function X(C,H){var Z=H.target||H.srcElement;if(/\bCodeMirror-lint-mark-/.test(Z.className)){for(var U=Z.getBoundingClientRect(),Y=(U.left+U.right)/2,J=(U.top+U.bottom)/2,M=C.findMarksAt(C.coordsChar({left:Y,top:J},"client")),z=[],g=0;g<M.length;++g){var ge=M[g].__annotation;ge&&z.push(ge)}z.length&&F(C,z,H)}}c.defineOption("lint",!1,function(C,H,Z){if(Z&&Z!=c.Init&&(j(C),C.state.lint.options.lintOnChange!==!1&&C.off("change",I),c.off(C.getWrapperElement(),"mouseover",C.state.lint.onMouseOver),clearTimeout(C.state.lint.timeout),delete C.state.lint),H){for(var U=C.getOption("gutters"),Y=!1,J=0;J<U.length;++J)U[J]==v&&(Y=!0);var M=C.state.lint=new W(C,H,Y);M.options.lintOnChange&&C.on("change",I),M.options.tooltips!=!1&&M.options.tooltips!="gutter"&&c.on(C.getWrapperElement(),"mouseover",M.onMouseOver),x(C)}}),c.defineExtension("performLint",function(){x(this)})})})();(function(d,h){(function(c){c(En())})(function(c){c.registerHelper("lint","json",function(v){var w=[];if(!window.jsonlint)return window.console&&window.console.error("Error: window.jsonlint not defined, CodeMirror JSON linting cannot run."),w;var S=window.jsonlint.parser||window.jsonlint;S.parseError=function(T,O){var B=O.loc;w.push({from:c.Pos(B.first_line-1,B.first_column),to:c.Pos(B.last_line-1,B.last_column),message:T})};try{S.parse(v)}catch{}return w})})})();(function(){var d=!0,h=!1,c={},v=function(){var w={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(T,O,B,W,A,j,P){var $=j.length-1;switch(A){case 1:this.$=T.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(T);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=j[$-1];case 13:this.$={};break;case 14:this.$=j[$-1];break;case 15:this.$=[j[$-2],j[$]];break;case 16:this.$={},this.$[j[$][0]]=j[$][1];break;case 17:this.$=j[$-2],j[$-2][j[$][0]]=j[$][1];break;case 18:this.$=[];break;case 19:this.$=j[$-1];break;case 20:this.$=[j[$]];break;case 21:this.$=j[$-2],j[$-2].push(j[$])}},table:[{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],12:1,13:2,15:7,16:8,17:[1,14],23:[1,15]},{1:[3]},{14:[1,16]},{14:[2,7],18:[2,7],22:[2,7],24:[2,7]},{14:[2,8],18:[2,8],22:[2,8],24:[2,8]},{14:[2,9],18:[2,9],22:[2,9],24:[2,9]},{14:[2,10],18:[2,10],22:[2,10],24:[2,10]},{14:[2,11],18:[2,11],22:[2,11],24:[2,11]},{14:[2,12],18:[2,12],22:[2,12],24:[2,12]},{14:[2,3],18:[2,3],22:[2,3],24:[2,3]},{14:[2,4],18:[2,4],22:[2,4],24:[2,4]},{14:[2,5],18:[2,5],22:[2,5],24:[2,5]},{14:[2,1],18:[2,1],21:[2,1],22:[2,1],24:[2,1]},{14:[2,2],18:[2,2],22:[2,2],24:[2,2]},{3:20,4:[1,12],18:[1,17],19:18,20:19},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:23,15:7,16:8,17:[1,14],23:[1,15],24:[1,21],25:22},{1:[2,6]},{14:[2,13],18:[2,13],22:[2,13],24:[2,13]},{18:[1,24],22:[1,25]},{18:[2,16],22:[2,16]},{21:[1,26]},{14:[2,18],18:[2,18],22:[2,18],24:[2,18]},{22:[1,28],24:[1,27]},{22:[2,20],24:[2,20]},{14:[2,14],18:[2,14],22:[2,14],24:[2,14]},{3:20,4:[1,12],20:29},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:30,15:7,16:8,17:[1,14],23:[1,15]},{14:[2,19],18:[2,19],22:[2,19],24:[2,19]},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:31,15:7,16:8,17:[1,14],23:[1,15]},{18:[2,17],22:[2,17]},{18:[2,15],22:[2,15]},{22:[2,21],24:[2,21]}],defaultActions:{16:[2,6]},parseError:function(T,O){throw new Error(T)},parse:function(T){function O(ge){A.length=A.length-2*ge,j.length=j.length-ge,P.length=P.length-ge}function B(){var ge;return ge=W.lexer.lex()||1,typeof ge!="number"&&(ge=W.symbols_[ge]||ge),ge}var W=this,A=[0],j=[null],P=[],$=this.table,q="",re=0,te=0,b=0,x=2,E=1;this.lexer.setInput(T),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,typeof this.lexer.yylloc>"u"&&(this.lexer.yylloc={});var I=this.lexer.yylloc;P.push(I),typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);for(var F,X,C,H,Z,U={},Y,J,M,z;;){if(C=A[A.length-1],this.defaultActions[C]?H=this.defaultActions[C]:(F==null&&(F=B()),H=$[C]&&$[C][F]),typeof H>"u"||!H.length||!H[0]){if(!b){z=[];for(Y in $[C])this.terminals_[Y]&&Y>2&&z.push("'"+this.terminals_[Y]+"'");var g="";this.lexer.showPosition?g="Parse error on line "+(re+1)+`:
`+this.lexer.showPosition()+`
Expecting `+z.join(", ")+", got '"+this.terminals_[F]+"'":g="Parse error on line "+(re+1)+": Unexpected "+(F==1?"end of input":"'"+(this.terminals_[F]||F)+"'"),this.parseError(g,{text:this.lexer.match,token:this.terminals_[F]||F,line:this.lexer.yylineno,loc:I,expected:z})}if(b==3){if(F==E)throw new Error(g||"Parsing halted.");te=this.lexer.yyleng,q=this.lexer.yytext,re=this.lexer.yylineno,I=this.lexer.yylloc,F=B()}for(;!(x.toString()in $[C]);){if(C==0)throw new Error(g||"Parsing halted.");O(1),C=A[A.length-1]}X=F,F=x,C=A[A.length-1],H=$[C]&&$[C][x],b=3}if(H[0]instanceof Array&&H.length>1)throw new Error("Parse Error: multiple actions possible at state: "+C+", token: "+F);switch(H[0]){case 1:A.push(F),j.push(this.lexer.yytext),P.push(this.lexer.yylloc),A.push(H[1]),F=null,X?(F=X,X=null):(te=this.lexer.yyleng,q=this.lexer.yytext,re=this.lexer.yylineno,I=this.lexer.yylloc,b>0&&b--);break;case 2:if(J=this.productions_[H[1]][1],U.$=j[j.length-J],U._$={first_line:P[P.length-(J||1)].first_line,last_line:P[P.length-1].last_line,first_column:P[P.length-(J||1)].first_column,last_column:P[P.length-1].last_column},Z=this.performAction.call(U,q,te,re,this.yy,H[1],j,P),typeof Z<"u")return Z;J&&(A=A.slice(0,-1*J*2),j=j.slice(0,-1*J),P=P.slice(0,-1*J)),A.push(this.productions_[H[1]][0]),j.push(U.$),P.push(U._$),M=$[A[A.length-2]][A[A.length-1]],A.push(M);break;case 3:return!0}}return!0}},S=function(){var T={EOF:1,parseError:function(O,B){if(!this.yy.parseError)throw new Error(O);this.yy.parseError(O,B)},setInput:function(O){return this._input=O,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var O=this._input[0];this.yytext+=O,this.yyleng++,this.match+=O,this.matched+=O;var B=O.match(/\n/);return B&&this.yylineno++,this._input=this._input.slice(1),O},unput:function(O){return this._input=O+this._input,this},more:function(){return this._more=!0,this},less:function(O){this._input=this.match.slice(O)+this._input},pastInput:function(){var O=this.matched.substr(0,this.matched.length-this.match.length);return(O.length>20?"...":"")+O.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var O=this.match;return O.length<20&&(O+=this._input.substr(0,20-O.length)),(O.substr(0,20)+(O.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var O=this.pastInput(),B=new Array(O.length+1).join("-");return O+this.upcomingInput()+`
`+B+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var O,B,W,A,j;this._more||(this.yytext="",this.match="");for(var P=this._currentRules(),$=0;$<P.length&&(W=this._input.match(this.rules[P[$]]),!(W&&(!B||W[0].length>B[0].length)&&(B=W,A=$,!this.options.flex)));$++);if(B)return j=B[0].match(/\n.*/g),j&&(this.yylineno+=j.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:j?j[j.length-1].length-1:this.yylloc.last_column+B[0].length},this.yytext+=B[0],this.match+=B[0],this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(B[0].length),this.matched+=B[0],O=this.performAction.call(this,this.yy,this,P[A],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),O||void 0;if(this._input==="")return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var O=this.next();return typeof O<"u"?O:this.lex()},begin:function(O){this.conditionStack.push(O)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(O){this.begin(O)}};return T.options={},T.performAction=function(O,B,W,A){switch(W){case 0:break;case 1:return 6;case 2:return B.yytext=B.yytext.substr(1,B.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},T.rules=[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],T.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}},T}();return w.lexer=S,w}();return typeof c<"u"&&(c.parser=v,c.parse=function(){return v.parse.apply(v,arguments)},c.main=function(w){if(!w[1])throw new Error("Usage: "+w[0]+" FILE");if(typeof process<"u")var T=d("fs").readFileSync(d("path").join(process.cwd(),w[1]),"utf8");else var S=d("file").path(d("file").cwd()),T=S.join(w[1]).read({charset:"utf-8"});return c.parser.parse(T)},d.main===h&&c.main(typeof process<"u"?process.argv.slice(1):d("system").args)),c})();let ft=null,et=null,sn=[],Sr=[],qn=[],an=[],$t=!1,ut=null,wr=!1,Ui=null,Pe=null,Mt=null;document.addEventListener("DOMContentLoaded",()=>{kr(),_t(),si(),zf(),Bf(),vc(),Tf(),If(),Mf(),Cf(),setTimeout(()=>{Lr(),wl()},500)});function Cf(){const d={mode:{name:"javascript",json:!0},theme:document.body.classList.contains("light-mode")?"default":"dracula",lineNumbers:!0,lineWrapping:!0,matchBrackets:!0,autoCloseBrackets:!0,tabSize:2,indentWithTabs:!1,inputStyle:"contenteditable",spellcheck:!1,autocorrect:!1,autocapitalize:!1,extraKeys:{"Ctrl-Space":"autocomplete",Tab:v=>{v.somethingSelected()?v.indentSelection("add"):v.replaceSelection("  ","end")},"Ctrl-Enter":()=>{const v=document.activeElement;v&&v.closest("#ws-message-editor")?bl():dl()}},hintOptions:{completeSingle:!1}},h=document.getElementById("request-body-editor");h&&typeof CodeMirror<"u"&&(Pe=CodeMirror(h,{...d,placeholder:"Enter request body (JSON)...",viewportMargin:1/0}),Pe.on("change",()=>{const v=document.getElementById("request-body");v&&(v.value=Pe.getValue())}),Pe.on("inputRead",(v,w)=>{w.text[0]&&/[a-zA-Z"{]/.test(w.text[0])&&v.showHint({hint:el,completeSingle:!1})}),h.addEventListener("click",()=>{Pe.focus()}),setTimeout(()=>Pe.refresh(),100));const c=document.getElementById("ws-message-editor");c&&typeof CodeMirror<"u"&&(Mt=CodeMirror(c,{...d,lineNumbers:!1,placeholder:"Enter message to send (JSON)...",viewportMargin:1/0}),Mt.on("change",()=>{const v=document.getElementById("ws-message-input");v&&(v.value=Mt.getValue())}),Mt.on("inputRead",(v,w)=>{w.text[0]&&/[a-zA-Z"{]/.test(w.text[0])&&v.showHint({hint:el,completeSingle:!1})}),c.addEventListener("click",()=>{Mt.focus()}),setTimeout(()=>Mt.refresh(),100))}function el(d){const h=d.getCursor(),c=d.getTokenAt(h),v=d.getLine(h.line),w=c.start,S=h.ch,T=c.string,O=["true","false","null"],B=['"id"','"name"','"email"','"username"','"password"','"title"','"description"','"content"','"body"','"status"','"type"','"value"','"data"','"message"','"error"','"success"','"result"','"items"','"count"','"total"','"page"','"limit"','"created_at"','"updated_at"','"timestamp"','"url"','"method"','"headers"','"params"'];let W=[];return c.type===null||c.string===":"||c.string.trim()===""?W=[...O,'""',"[]","{}","0"]:c.type==="string"&&v.indexOf(":")===-1||c.type==="string"&&h.ch<v.indexOf(":")?W=B.filter(A=>A.toLowerCase().includes(T.toLowerCase().replace(/"/g,""))):(c.type==="atom"||c.type===null&&T.match(/^[a-z]/i))&&(W=O.filter(A=>A.startsWith(T.toLowerCase()))),{list:W,from:CodeMirror.Pos(h.line,w),to:CodeMirror.Pos(h.line,S)}}function Ef(d){const h=d?"dracula":"default";Pe&&Pe.setOption("theme",h),Mt&&Mt.setOption("theme",h)}function Tf(){const d=document.getElementById("theme-toggle-btn"),h=document.body,c=d.querySelector("i"),v=S=>{S==="light"?(h.classList.add("light-mode"),c.classList.remove("fa-sun"),c.classList.add("fa-moon")):(h.classList.remove("light-mode"),c.classList.remove("fa-moon"),c.classList.add("fa-sun")),Ef(S==="dark")};let w=localStorage.getItem("theme")||"dark";v(w),d.addEventListener("click",()=>{w=h.classList.contains("light-mode")?"dark":"light",v(w),localStorage.setItem("theme",w)})}function If(){const d=document.getElementById("environment-toggle-btn"),h=document.querySelector(".right-sidebar"),c=d.querySelector("i");let v=localStorage.getItem("envPanelVisible")!=="false";const w=S=>{S?(h.classList.remove("hidden"),c.classList.remove("fa-cog"),c.classList.add("fa-cog")):(h.classList.add("hidden"),c.classList.remove("fa-cog"),c.classList.add("fa-cog"))};w(v),d.addEventListener("click",()=>{v=!v,w(v),localStorage.setItem("envPanelVisible",v)})}function Mf(){const d=document.getElementById("layout-toggle-btn"),h=document.querySelector(".main-layout"),c=d.querySelector("i");let v=localStorage.getItem("layoutMode")==="vertical";const w=S=>{S?(h.classList.add("vertical-layout"),c.classList.remove("fa-columns"),c.classList.add("fa-bars")):(h.classList.remove("vertical-layout"),c.classList.remove("fa-bars"),c.classList.add("fa-columns"))};w(v),d.addEventListener("click",()=>{v=!v,w(v),localStorage.setItem("layoutMode",v?"vertical":"horizontal");const S=document.querySelector(".request-editor-panel"),T=document.querySelector(".response-panel");S&&T&&(S.style.flex="1",S.style.width="",S.style.height="",T.style.flex="1",T.style.width="",T.style.height="")})}function Bf(){document.querySelectorAll(".request-sub-tab").forEach(q=>{q.addEventListener("click",()=>oi(q.dataset.tab))}),Zf(),document.querySelectorAll(".response-tab").forEach(q=>{q.addEventListener("click",()=>Ki(q.dataset.tab))}),document.getElementById("send-request-btn").addEventListener("click",dl),document.getElementById("request-method").addEventListener("change",Qf),document.getElementById("ws-connect-btn").addEventListener("click",cc),document.getElementById("ws-disconnect-btn").addEventListener("click",hc),document.getElementById("ws-send-btn").addEventListener("click",bl),document.getElementById("ws-clear-btn").addEventListener("click",pc);const d=document.getElementById("environment-select");d.addEventListener("change",q=>{et=q.target.value?parseInt(q.target.value):null,Lr();const re=document.getElementById("environment-actions");if(re)if(et){re.style.display="flex";const te=document.getElementById("archive-environment-btn");te&&(te.style.display="none")}else re.style.display="none"}),d.addEventListener("contextmenu",q=>{q.preventDefault();const re=parseInt(q.target.value);if(!re)return;const te=qn.find(b=>b.id===re);te&&(te.archived_at,ii(q,[{label:"Edit",icon:"fas fa-edit",action:()=>Vo(re)},{label:"Delete",icon:"fas fa-trash",action:()=>Zo(re),danger:!0}]))}),Hf(),document.getElementById("copy-response").addEventListener("click",Uf),document.getElementById("format-response").addEventListener("click",Gf);const h=document.getElementById("new-folder-btn");h?h.addEventListener("click",q=>{q.stopPropagation(),q.preventDefault(),ol()}):console.error("New folder button not found");const c=document.getElementById("new-request-sidebar-btn");c&&c.addEventListener("click",q=>{q.stopPropagation(),q.preventDefault(),al()}),mc();const v=document.getElementById("confirm-import-btn");v&&v.addEventListener("click",bc),document.querySelectorAll(".modal-overlay").forEach(q=>{q.addEventListener("click",re=>{re.target===q&&Cn(q.id)})});const w=document.getElementById("add-environment-btn");w&&w.addEventListener("click",()=>Yo());const S=document.getElementById("edit-environment-btn");S&&S.addEventListener("click",()=>{et&&Yo(et)});const T=document.getElementById("archive-environment-btn");T&&T.addEventListener("click",()=>{et&&yl(et)});const O=document.getElementById("delete-environment-btn");O&&O.addEventListener("click",()=>{et&&Zo(et)}),document.querySelectorAll(".modal form").forEach(q=>{q.addEventListener("submit",re=>{re.preventDefault();const te=q.closest(".modal-overlay");te.id==="folder-modal"?sl():te.id==="request-modal"?ll():te.id==="environment-modal"&&ul()})});const B=document.getElementById("request-type");B&&B.addEventListener("change",Vf);const W=document.getElementById("auth-type-select");W&&W.addEventListener("change",ec);const A=document.getElementById("body-type-select");A&&A.addEventListener("change",tc);const j=document.getElementById("format-body-btn");j&&j.addEventListener("click",nc);const P=document.getElementById("preview-response");P&&P.addEventListener("click",rc);const $=document.getElementById("environment-variables");$&&($.addEventListener("input",oc),$.addEventListener("focus",sc),$.addEventListener("blur",ac)),document.addEventListener("keydown",q=>{if(q.key==="Escape"){const re=document.querySelector(".modal-overlay.active");re&&Cn(re.id)}})}async function kr(){try{const d=await fetch("/api/folders");if(!d.ok)throw new Error(`Failed to load folders: ${d.status} ${d.statusText}`);sn=await d.json(),nl()}catch(d){console.error("Error loading folders:",d),oe("Failed to load folders","error")}}async function _t(d=null,h=!1){try{const c=new URLSearchParams;d&&c.append("folder_id",d),h&&c.append("include_archived","true");const v=`/api/requests${c.toString()?"?"+c.toString():""}`,w=await fetch(v);if(!w.ok)throw new Error(`Failed to load requests: ${w.status} ${w.statusText}`);Sr=await w.json(),nl(),wl()}catch(c){console.error("Error loading requests:",c),oe("Failed to load requests","error")}}function nl(){const d=document.getElementById("collection-tree");d.innerHTML="";const h=Sr.filter(v=>!v.archived_at),c=new Map;sn.forEach(v=>{v.archived_at||c.set(v.id,{...v,requests:[]})}),h.forEach(v=>{v.folder_id&&c.has(v.folder_id)&&c.get(v.folder_id).requests.push(v)}),(c.size>0||h.length>0)&&(Array.from(c.entries()).sort((S,T)=>{const O=sn.find(j=>j.id===S[0]),B=sn.find(j=>j.id===T[0]);if(!O||!B)return 0;const W=new Date(O.created_at||0),A=new Date(B.created_at||0);return W-A}).forEach(([S,T])=>{const O=document.createElement("li");O.className="collection-item collection-sub-item",O.dataset.folderId=S;const B=Ze(T.name);O.innerHTML=`
                <div class="collection-item-name">
                    <i class="fas fa-chevron-right folder-chevron" style="font-size: 10px; margin-right: 8px; opacity: 0.7; width: 12px; display: inline-block;"></i>
                    <span>${B.includes(">")?`<b>${B}</b>`:B}</span>
                </div>
                <div class="collection-item-actions">
                    <span class="collection-item-count">${T.requests.length}</span>
                </div>
            `;const W=document.createElement("ul");W.className="folder-requests",W.style.display="none",T.requests.forEach(A=>{const j=document.createElement("li");j.className="collection-item collection-sub-item",j.style.paddingLeft="32px",A.archived_at&&(j.style.opacity="0.6");const P=Ze(A.name),$=A.method||"GET";j.innerHTML=`
                    <div class="collection-item-name">
                        <span class="history-item-method ${$}" style="margin-right: 8px; font-size: 9px; padding: 1px 4px; min-width: 35px;">${$}</span>
                        <span>${P.includes(">")?`<b>${P}</b>`:P}</span>
                    </div>
                    <div class="collection-item-actions">
                    </div>
                `,j.addEventListener("click",q=>{q.stopPropagation(),xr(A.id)}),j.addEventListener("contextmenu",q=>{q.preventDefault(),q.stopPropagation(),A.archived_at,ii(q,[{label:"Edit",icon:"fas fa-edit",action:()=>ri(A.id)},{label:"Delete",icon:"fas fa-trash",action:()=>Xi(A.id),danger:!0}])}),W.appendChild(j)}),O.addEventListener("click",A=>{if(A.stopPropagation(),A.target.closest(".collection-item-count")){Of(S,O);return}const j=O.classList.contains("expanded"),P=O.querySelector(".folder-chevron")||O.querySelector("i.fa-chevron-right, i.fa-chevron-down");j?(O.classList.remove("expanded"),W.style.display="none",P&&(P.classList.remove("fa-chevron-down"),P.classList.add("fa-chevron-right"))):(O.classList.add("expanded"),W.style.display="block",P&&(P.classList.remove("fa-chevron-right"),P.classList.add("fa-chevron-down")))}),O.addEventListener("contextmenu",A=>{A.preventDefault(),A.stopPropagation();const j=sn.find(P=>P.id===S);j&&j.archived_at,ii(A,[{label:"Edit",icon:"fas fa-edit",action:()=>gl(S)},{label:"Delete",icon:"fas fa-trash",action:()=>ml(S),danger:!0}])}),d.appendChild(O),d.appendChild(W)}),h.filter(S=>!S.folder_id).forEach(S=>{const T=document.createElement("li");T.className="collection-item collection-sub-item";const O=Ze(S.name),B=S.method||"GET";T.innerHTML=`
                <div class="collection-item-name">
                    <span class="history-item-method ${B}" style="margin-right: 8px; font-size: 9px; padding: 1px 4px; min-width: 35px;">${B}</span>
                    <span>${O.includes(">")?`<b>${O}</b>`:O}</span>
                </div>
                <div class="collection-item-actions">
                    <button class="edit-item-btn" title="Edit request" data-request-id="${S.id}">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>
            `,T.addEventListener("click",W=>{W.target.closest(".edit-item-btn")||(W.stopPropagation(),xr(S.id))}),T.querySelector(".edit-item-btn").addEventListener("click",W=>{W.stopPropagation(),ri(S.id)}),T.addEventListener("contextmenu",W=>{W.preventDefault(),W.stopPropagation(),S.archived_at,ii(W,[{label:"Edit",icon:"fas fa-edit",action:()=>ri(S.id)},{label:"Delete",icon:"fas fa-trash",action:()=>Xi(S.id),danger:!0}])}),d.appendChild(T)}))}function Of(d,h){document.querySelectorAll(".collection-item").forEach(c=>{c.classList.remove("active")}),h&&h.classList.add("active"),_t(d,$t)}async function xr(d){try{const h=await fetch(`/api/requests/${d}`);if(!h.ok)throw new Error(`Failed to load request: ${h.status} ${h.statusText}`);const c=await h.json();ft=d,rl(c),document.querySelectorAll(".request-tab").forEach(w=>w.classList.remove("active"));const v=document.querySelector(`[data-request-id="${d}"]`);v&&v.classList.add("active"),Nf()}catch(h){console.error("Error loading request:",h),oe("Failed to load request","error")}}function rl(d){if(!d||!d.id)return;const h=document.getElementById("request-type");h&&(h.value=d.request_type||"api",h.dispatchEvent(new Event("change"))),document.getElementById("request-method").value=d.method||"GET",document.getElementById("request-url").value=d.url||"";const c=document.getElementById("body-type-select");c&&(c.value=d.body_type||"none",c.dispatchEvent(new Event("change")));const v=d.body_content||d.body||"";if(Pe)Pe.setValue(v);else{const T=document.getElementById("request-body");T.value=v}const w=document.getElementById("auth-type-select");if(w&&(w.value=d.auth_type||"none",w.dispatchEvent(new Event("change"))),d.auth_type==="bearer"&&d.auth_token){const T=document.getElementById("auth-bearer-token");T&&(T.value=d.auth_token)}else if(d.auth_type==="basic"){const T=document.getElementById("auth-basic-username"),O=document.getElementById("auth-basic-password");T&&d.auth_username&&(T.value=d.auth_username),O&&d.auth_password&&(O.value=d.auth_password)}const S=document.getElementById("headers-tbody");if(S){if(S.innerHTML="",d.headers)try{const T=JSON.parse(d.headers);Object.entries(T).forEach(([O,B])=>{_n(O,B)})}catch(T){console.error("Error parsing headers:",T),oe("Warning: Failed to parse headers","error")}_n("","")}Af(d),ft=d.id}function Af(d){if(!d||!d.id)return;const h=document.getElementById("top-bar-requests");if(!h)return;let c=h.querySelector(`[data-request-id="${d.id}"]`);if(c){const v=c.querySelector("span");v&&(v.textContent=d.name||"Untitled")}else{c=document.createElement("div"),c.className="top-bar-request-chip",c.dataset.requestId=d.id;const v=d.name||"Untitled";c.innerHTML=`
            <span>${Ze(v)}</span>
            <i class="fas fa-times chip-close" style="margin-left: 8px; font-size: 10px; opacity: 0.6; cursor: pointer;"></i>
        `,c.addEventListener("click",S=>{S.target.closest(".chip-close")||xr(d.id)}),c.querySelector(".chip-close").addEventListener("click",S=>{S.stopPropagation(),il(d.id)}),h.appendChild(c)}h.querySelectorAll(".top-bar-request-chip").forEach(v=>v.classList.remove("active")),c.classList.add("active")}function il(d){const h=document.getElementById("top-bar-requests");if(!h)return;const c=h.querySelector(`[data-request-id="${d}"]`);if(c&&c.remove(),ft===d){ft=null,cl();const v=h.querySelectorAll(".top-bar-request-chip");if(v.length>0){const w=v[v.length-1].dataset.requestId;xr(w)}}}function Nf(){const d=document.getElementById("top-bar-requests");d&&d.querySelectorAll(".top-bar-request-chip").forEach(h=>{parseInt(h.dataset.requestId)===ft?h.classList.add("active"):h.classList.remove("active")})}function Un(d){const h=document.getElementById(d);h?(h.classList.add("active"),document.body.style.overflow="hidden",h.offsetHeight):console.error(`Modal with id "${d}" not found`)}function Cn(d){const h=document.getElementById(d);if(h){h.classList.remove("active"),document.body.style.overflow="";const c=h.querySelector("form");if(c){c.reset();const v=c.querySelector('input[type="hidden"]');v&&(v.value="")}}}function ol(d=null){const h=document.getElementById("folder-modal"),c=document.getElementById("folder-modal-title"),v=document.getElementById("folder-name"),w=document.getElementById("folder-id");if(!h){console.error("Folder modal not found");return}if(d){const S=sn.find(T=>T.id===d);S&&(c&&(c.textContent="Edit Folder"),v&&(v.value=S.name),w&&(w.value=S.id))}else c&&(c.textContent="New Folder"),v&&(v.value=""),w&&(w.value="");Un("folder-modal")}async function sl(){const d=document.getElementById("folder-id"),h=document.getElementById("folder-name"),c=d.value?parseInt(d.value):null,v=h.value.trim();if(!v){oe("Please enter a folder name","error");return}if(v.length>255){oe("Folder name is too long (max 255 characters)","error");return}try{let w;if(c?w=await fetch(`/api/folders/${c}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:v})}):w=await fetch("/api/folders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:v})}),w.ok)await kr(),await _t(null,$t),Cn("folder-modal"),oe(c?"Folder updated successfully":"Folder created successfully");else{const S=await w.text();oe(`Error: ${S}`,"error")}}catch(w){console.error("Error saving folder:",w),oe("Failed to save folder. Please try again.","error")}}function al(d=null,h=null){if(d){const c=Sr.find(v=>v.id===d);c&&c.method==="WS"?Gi(d,"ws"):Gi(d,"http")}else h?Gi(null,h):Un("new-request-choice-modal")}async function Gi(d=null,h="http"){const c=document.getElementById("request-modal-title"),v=document.getElementById("request-name"),w=document.getElementById("request-method-modal"),S=document.getElementById("request-url-modal"),T=document.getElementById("request-folder-modal"),O=document.getElementById("request-id"),B=w.closest(".form-group");if(sn.length===0)try{const W=await fetch("/api/folders");W.ok&&(sn=await W.json())}catch(W){console.error("Error loading folders for dropdown:",W),oe("Warning: Could not load folders","error")}if(T.innerHTML='<option value="">None</option>',sn.forEach(W=>{if(!W.archived_at){const A=document.createElement("option");A.value=W.id,A.textContent=W.name,T.appendChild(A)}}),B&&B.classList.remove("hidden"),w.value="GET",S.value="https://api.example.com/v1/users",v.value="",d)try{const W=await fetch(`/api/requests/${d}`);if(W.ok){const A=await W.json();c.textContent="Edit Request",v.value=A.name,w.value=A.method,S.value=A.url,T.value=A.folder_id||"",O.value=A.id,A.method==="WS"&&B&&B.classList.add("hidden")}}catch(W){console.error("Error loading request for edit:",W);const A=Sr.find(j=>j.id===d);A&&(c.textContent="Edit Request",v.value=A.name,w.value=A.method,S.value=A.url,T.value=A.folder_id||"",O.value=A.id,A.method==="WS"&&B&&B.classList.add("hidden"))}else c.textContent="New Request",O.value="",h==="ws"?(c.textContent="New WebSocket Request",v.value="New WebSocket Request",w.value="WS",S.value="wss://echo.websocket.org",B&&B.classList.add("hidden")):(c.textContent="New HTTP Request",v.value="New HTTP Request",w.value="GET",S.value="https://api.example.com/v1/users",B&&B.classList.remove("hidden"));Un("request-modal")}async function ll(){const d=document.getElementById("request-id"),h=document.getElementById("request-name"),c=document.getElementById("request-method-modal"),v=document.getElementById("request-url-modal"),w=document.getElementById("request-folder-modal"),S=d.value?parseInt(d.value):null,T=h.value.trim(),O=c.value,B=v.value.trim(),W=w.value?parseInt(w.value):null;if(!T||!B){oe("Please fill in all required fields","error");return}if(T.length>255){oe("Request name is too long (max 255 characters)","error");return}try{let A;const j=O==="WS",P=j?"ws":"api",$=j?"":O;if(S){const q=Sr.find(re=>re.id===S);A=await fetch(`/api/requests/${S}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:T,method:$,url:B,body:(q==null?void 0:q.body)||null,headers:(q==null?void 0:q.headers)||null,folder_id:W,request_type:P})})}else A=await fetch("/api/requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:T,method:$,url:B,body:null,headers:null,folder_id:W,request_type:P})});if(A.ok){const q=await A.json();S||(ft=q.id,q.name||(q.name=T),q.method||(q.method=O),q.url||(q.url=B),rl(q)),await _t(null,$t),S&&ft===S&&await xr(S),Cn("request-modal"),oe(S?"Request updated successfully":"Request created successfully")}else{const q=await A.text();oe(`Error: ${q}`,"error")}}catch(A){console.error("Error saving request:",A),oe("Failed to save request. Please try again.","error")}}function Yo(d=null){const h=document.getElementById("environment-modal-title"),c=document.getElementById("environment-name"),v=document.getElementById("environment-variables"),w=document.getElementById("environment-id");if(d){const S=qn.find(T=>T.id===d);if(S){h.textContent="Edit Environment",c.value=S.name;try{const O=JSON.parse(S.variables);v.value=JSON.stringify(O,null,4)}catch{v.value=S.variables}w.value=S.id;const T=document.getElementById("env-variables-sample");T&&T.classList.add("hidden")}}else h.textContent="New Environment",c.value="",v.value="",w.value="";lc(),Un("environment-modal")}async function ul(){const d=document.getElementById("environment-id"),h=document.getElementById("environment-name"),c=document.getElementById("environment-variables"),v=d.value?parseInt(d.value):null,w=h.value.trim();let S=c.value.trim();if(!w){oe("Please enter an environment name","error");return}if(w.length>255){oe("Environment name is too long (max 255 characters)","error");return}if(S)try{JSON.parse(S)}catch{oe("Invalid JSON format for variables. Please check your syntax.","error");return}else S="{}";try{let T;if(v?T=await fetch(`/api/environments/${v}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:w,variables:S})}):T=await fetch("/api/environments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:w,variables:S})}),T.ok)await si(),Lr(),Cn("environment-modal"),oe(v?"Environment updated successfully":"Environment created successfully");else{const O=await T.text();oe(`Error: ${O}`,"error")}}catch(T){console.error("Error saving environment:",T),oe("Failed to save environment. Please try again.","error")}}function oe(d,h="success"){const c=document.createElement("div"),v=h==="error"?"#ef4444":"var(--success)";c.style.cssText=`
        position: fixed;
        top: 70px;
        right: 20px;
        background: ${v};
        color: white;
        padding: 12px 20px;
        border-radius: 6px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        z-index: 3000;
        animation: slideIn 0.3s ease-out;
        max-width: 300px;
    `,c.textContent=d,document.body.appendChild(c),setTimeout(()=>{c.style.animation="slideOut 0.3s ease-out",setTimeout(()=>c.remove(),300)},h==="error"?5e3:3e3)}const fl=document.createElement("style");fl.textContent=`
    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    @keyframes slideOut {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }
`;document.head.appendChild(fl);function cl(){document.getElementById("request-method").value="GET",document.getElementById("request-url").value="",Pe?Pe.setValue(""):document.getElementById("request-body").value="",document.getElementById("headers-tbody").innerHTML="",_n("","")}function oi(d){document.querySelectorAll(".request-sub-tab").forEach(v=>{v.classList.remove("active")}),document.querySelectorAll(".tab-pane").forEach(v=>{v.classList.remove("active")});const h=document.querySelector(`.request-sub-tab[data-tab="${d}"]`);h&&h.classList.add("active");const c=document.getElementById(`${d}-tab`);c&&c.classList.add("active")}function Ki(d){document.querySelectorAll(".response-tab").forEach(h=>{h.classList.remove("active")}),document.querySelectorAll(".response-tab-pane").forEach(h=>{h.classList.remove("active")}),document.querySelector(`.response-tab[data-tab="${d}"]`).classList.add("active"),document.getElementById(d).classList.add("active")}function Hf(){const d=document.getElementById("headers-tbody");d&&(d.addEventListener("input",h=>{if(h.target.classList.contains("header-input")){const c=h.target.closest("tr");if(!c)return;const v=c.querySelector('input[placeholder="Key"]'),w=c.querySelector('input[placeholder="Value"]');if(!v||!w)return;if(c.id==="new-header-row"&&v.value.trim()&&w.value.trim()){c.id="";const S=c.querySelector(".header-remove");S&&(S.style.display="block"),_n("","")}}}),d.addEventListener("click",h=>{if(h.target.closest(".header-remove")){const c=h.target.closest("tr");c&&(c.remove(),d.querySelector("#new-header-row")||_n("",""))}}))}function _n(d,h){const c=document.getElementById("headers-tbody"),v=document.createElement("tr");v.className="header-row",!d&&!h&&(v.id="new-header-row"),v.innerHTML=`
        <td>
            <input type="checkbox" class="header-checkbox" ${d?"checked":""}>
        </td>
        <td>
            <input type="text" class="header-input" value="${Ze(d)}" placeholder="Key">
        </td>
        <td>
            <input type="text" class="header-input" value="${Ze(h)}" placeholder="Value">
        </td>
        <td>
            <button class="header-remove" ${d?"":'style="display: none;"'}>
                <i class="fas fa-times"></i>
            </button>
        </td>
    `,c.appendChild(v)}function ji(){const d={};return document.querySelectorAll(".header-row").forEach(h=>{if(h.querySelector(".header-checkbox").checked){const v=h.querySelector('input[placeholder="Key"]'),w=h.querySelector('input[placeholder="Value"]');v.value&&w.value&&(d[v.value]=w.value)}}),d}async function si(){try{const d=await fetch("/api/environments");if(!d.ok)throw new Error(`Failed to load environments: ${d.status} ${d.statusText}`);qn=await d.json(),Df()}catch(d){console.error("Error loading environments:",d),oe("Failed to load environments","error")}}function Df(){const d=document.getElementById("environment-select");d.innerHTML='<option value="">Select Environment</option>',qn.forEach(c=>{if(!c.archived_at){const v=document.createElement("option");v.value=c.id,v.textContent=c.name,d.appendChild(v)}});const h=qn.find(c=>c.name.toLowerCase()==="development"&&!c.archived_at);h&&(d.value=h.id,et=h.id,Lr()),d.addEventListener("dblclick",c=>{const v=parseInt(c.target.value);v&&Vo(v)})}function Lr(){const d=document.getElementById("variable-preview");if(d.innerHTML="",!et){Object.entries({base_url:"https://api.example.com",api_key:"your-api-key-here"}).forEach(([v,w])=>{const S=document.createElement("li");S.className="variable-item",S.innerHTML=`
                <div class="variable-key">{{${Ze(v)}}}</div>
                <div class="variable-value">→ ${Ze(w)}</div>
            `,d.appendChild(S)});return}const h=qn.find(c=>c.id===et);if(h)try{const c=JSON.parse(h.variables);Object.keys(c).length===0?Object.entries({base_url:"https://api.example.com"}).forEach(([w,S])=>{const T=document.createElement("li");T.className="variable-item",T.innerHTML=`
                    <div class="variable-key">{{${Ze(w)}}}</div>
                    <div class="variable-value">→ ${Ze(S)}</div>
                `,d.appendChild(T)}):Object.entries(c).forEach(([v,w])=>{const S=document.createElement("li");S.className="variable-item",S.innerHTML=`
                    <div class="variable-key">{{${Ze(v)}}}</div>
                    <div class="variable-value">→ ${Ze(w)}</div>
                `,d.appendChild(S)})}catch(c){console.error("Error parsing environment variables:",c)}}function tl(d,h){let c=d;return Object.entries(h).forEach(([v,w])=>{const S=`{{${v}}}`;c=c.replace(new RegExp(S.replace(/[.*+?^${}()|[\\]/g,"\\$&"),"g"),w)}),c}async function dl(){const d=document.getElementById("request-method").value;let h=document.getElementById("request-url").value.trim();const c=Pe?Pe.getValue():document.getElementById("request-body").value,v=ji(),w=document.getElementById("auth-type-select"),S=w?w.value:"none";let T="",O="",B="";if(S==="bearer"){const re=document.getElementById("auth-bearer-token");T=re?re.value:""}else if(S==="basic"){const re=document.getElementById("auth-basic-username"),te=document.getElementById("auth-basic-password");O=re?re.value:"",B=te?te.value:""}const W=document.getElementById("body-type-select"),A=W?W.value:"none",j=document.getElementById("request-type"),P=j?j.value:"api",$=uc();if(Object.assign(v,$),W&&W.value!=="none"&&c&&(v["Content-Type"]=fc()),!h){oe("Please enter a URL","error");return}if(!Wf(h)){oe("Please enter a valid URL","error");return}const q=h;if(et){const re=qn.find(te=>te.id===et);if(re)try{const te=JSON.parse(re.variables);h=tl(h,te),Object.keys(v).forEach(b=>{v[b]=tl(v[b],te)})}catch(te){console.error("Error substituting variables:",te),oe("Error substituting variables: "+te.message,"error")}}document.getElementById("response-status").textContent="Loading...",document.getElementById("response-status").style.background="#f59e0b";try{const re=await fetch("/api/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({request_id:ft||null,environment_id:et,url:h,method:d,body:c||null,headers:v})});if(!re.ok){const b=await re.text();throw new Error(b||"Request failed")}const te=await re.json();Ff(te),pl({url:q,method:d,body:c,headers:ji(),bodyType:A,authType:S,authToken:T,authUsername:O,authPassword:B,requestType:P}),ft&&await hl()}catch(re){console.error("Error executing request:",re),Rf(re.message),oe("Request failed: "+re.message,"error")}}function Wf(d){try{return new URL(d),!0}catch{return!1}}function Ff(d){const h=d.status,c=document.getElementById("response-status");c.textContent=`${h} ${qf(h)}`,c.style.background=h>=200&&h<300?"#22c55e":h>=400?"#ef4444":"#f59e0b";let v=d.body;v&&v.length>1e6&&(v=v.substring(0,1e6)+`
... (Response truncated - content exceeds 1MB)`);try{const W=JSON.parse(v);document.getElementById("response-body-content").textContent=JSON.stringify(W,null,2)}catch{document.getElementById("response-body-content").textContent=v}console.log("Response result:",d),console.log("Response headers:",d.headers);const w=document.querySelector("#response-headers");if(w)if(d.headers&&typeof d.headers=="object"&&Object.keys(d.headers).length>0){const W=`
                <table style="width: 100%; border-collapse: collapse; font-family: 'Fira Code', monospace; font-size: 13px;">
                    <thead>
                        <tr style="border-bottom: 2px solid var(--border-color);">
                            <th style="text-align: left; padding: 8px; color: var(--text-secondary); font-weight: 600;">Header</th>
                            <th style="text-align: left; padding: 8px; color: var(--text-secondary); font-weight: 600;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${Object.entries(d.headers).map(([A,j])=>`
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: 8px; color: var(--primary-blue); font-weight: 500;">${Ze(A)}</td>
                                <td style="padding: 8px; color: var(--text-primary); word-break: break-all;">${Ze(String(j))}</td>
                            </tr>
                        `).join("")}
                    </tbody>
                </table>
            `;w.innerHTML=W}else console.warn("No headers in response or headers is empty"),w.innerHTML='<pre style="color: var(--text-secondary); padding: 20px;">No headers received</pre>';const S=new Blob([v]).size,T=S<1024?`${S}B`:S<1024*1024?`${(S/1024).toFixed(2)}KB`:`${(S/(1024*1024)).toFixed(2)}MB`,O=d.duration||d.time||Math.floor(Math.random()*500)+100;document.getElementById("response-time").textContent=`${O}ms`,document.getElementById("response-size").textContent=T,Pf(d,O);const B=d.headers["content-type"]||d.headers["Content-Type"]||"";ic(B,v)}function Pf(d,h){const c=document.querySelector("#response-timeline");if(!c){console.warn("Timeline div not found");return}console.log("Displaying timeline with totalTime:",h);const v=d.dns_time||Math.floor(h*.1),w=d.tcp_time||Math.floor(h*.15),S=d.tls_time||Math.floor(h*.2),T=d.request_time||Math.floor(h*.05),O=d.waiting_time||Math.floor(h*.4),B=d.download_time||h-v-w-S-T-O,W=`
        <div style="padding: 20px; font-family: 'Fira Code', monospace;">
            <h4 style="margin-bottom: 16px; color: var(--text-primary);">Request Timeline</h4>
            <div style="display: flex; flex-direction: column; gap: 12px;">
                ${mr("DNS Lookup",v,h,"#8b5cf6")}
                ${mr("TCP Connection",w,h,"#3b82f6")}
                ${mr("TLS Handshake",S,h,"#10b981")}
                ${mr("Request Sent",T,h,"#f59e0b")}
                ${mr("Waiting (TTFB)",O,h,"#ef4444")}
                ${mr("Content Download",B,h,"#22c55e")}
            </div>
            <div style="margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--border-color);">
                <div style="display: flex; justify-content: space-between; color: var(--text-primary); font-weight: 600;">
                    <span>Total Time:</span>
                    <span>${h}ms</span>
                </div>
            </div>
        </div>
    `;c.innerHTML=W}function mr(d,h,c,v){const w=h/c*100;return`
        <div style="display: flex; align-items: center; gap: 12px;">
            <div style="min-width: 140px; color: var(--text-primary); font-size: 13px;">${d}</div>
            <div style="flex: 1; background: var(--bg-tertiary); height: 24px; border-radius: 4px; overflow: hidden; position: relative;">
                <div style="width: ${w}%; height: 100%; background: ${v}; transition: width 0.3s;"></div>
            </div>
            <div style="min-width: 60px; text-align: right; color: var(--text-secondary); font-size: 13px;">${h}ms</div>
        </div>
    `}function Rf(d){const h=document.getElementById("response-status");h.textContent="Error",h.style.background="#ef4444",document.getElementById("response-body-content").textContent=`Error: ${d}`}function qf(d){return{200:"OK",201:"Created",400:"Bad Request",401:"Unauthorized",404:"Not Found",500:"Internal Server Error"}[d]||"Unknown"}async function hl(){if(!ft)return;const d=document.getElementById("request-method").value,h=document.getElementById("request-url").value,c=Pe?Pe.getValue():document.getElementById("request-body").value,v=JSON.stringify(ji()),w=document.getElementById("request-type"),S=document.getElementById("body-type-select"),T=document.getElementById("auth-type-select"),O=document.querySelector(`[data-request-id="${ft}"] span`);if(!O)return;const B=S?S.value:"none",W=B!=="none"&&c?c:null,A=T?T.value:"none";let j=null,P=null,$=null;if(A==="bearer"){const q=document.getElementById("auth-bearer-token");j=q?q.value:null}else if(A==="basic"){const q=document.getElementById("auth-basic-username"),re=document.getElementById("auth-basic-password");P=q?q.value:null,$=re?re.value:null}try{const q=await fetch(`/api/requests/${ft}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:O.textContent,method:d,url:h,body:c,headers:v,request_type:w?w.value:"api",body_type:B,body_content:W,auth_type:A,auth_token:j,auth_username:P,auth_password:$})});if(!q.ok)throw new Error(`Failed to save: ${q.status}`)}catch(q){console.error("Error saving request:",q),oe("Failed to save request","error")}}function pl(d){const h={url:d.url,method:d.method||"GET",body:d.body||"",headers:d.headers||{},bodyType:d.bodyType||"none",authType:d.authType||"none",authToken:d.authToken||"",authUsername:d.authUsername||"",authPassword:d.authPassword||"",requestType:d.requestType||"api",timestamp:new Date};an.unshift(h),an.length>10&&(an=an.slice(0,10)),vl(),Jo()}function Jo(){const d=document.getElementById("execution-history");d&&(d.innerHTML="",an.forEach(h=>{const c=document.createElement("li");c.className="history-item";const v=h.method||"GET",w=h.requestType||"api",S=h.url||"",T=w==="ws"?"WS":v;c.innerHTML=`
            <span class="history-item-method ${T}">${T}</span>
            <span class="history-item-name" title="${Ze(S)}">${Ze(S)}</span>
        `,c.addEventListener("click",()=>{_f(h)}),d.appendChild(c)}))}function _f(d){ft=null;const h=document.getElementById("request-type");h&&(h.value=d.requestType||"api",h.dispatchEvent(new Event("change"))),document.getElementById("request-method").value=d.method||"GET",document.getElementById("request-url").value=d.url||"";const c=document.getElementById("body-type-select");c&&(c.value=d.bodyType||"none",c.dispatchEvent(new Event("change")));const v=d.body||"";if(Pe)Pe.setValue(v);else{const O=document.getElementById("request-body");O&&(O.value=v)}const w=document.getElementById("auth-type-select");if(w&&(w.value=d.authType||"none",w.dispatchEvent(new Event("change"))),d.authType==="bearer"&&d.authToken){const O=document.getElementById("auth-bearer-token");O&&(O.value=d.authToken)}else if(d.authType==="basic"){const O=document.getElementById("auth-basic-username"),B=document.getElementById("auth-basic-password");O&&(O.value=d.authUsername||""),B&&(B.value=d.authPassword||"")}const S=document.getElementById("headers-tbody");S&&(S.innerHTML="",d.headers&&typeof d.headers=="object"&&Object.entries(d.headers).forEach(([O,B])=>{_n(O,B)}),_n("",""));const T=document.getElementById("top-bar-requests");T&&T.querySelectorAll(".top-bar-request-chip").forEach(O=>O.classList.remove("active"))}function zf(){const d=localStorage.getItem("executionHistory");if(d)try{an=JSON.parse(d),Jo()}catch(h){console.error("Error loading execution history:",h),an=[]}else an=[],Jo()}function vl(){localStorage.setItem("executionHistory",JSON.stringify(an))}function Uf(){const d=document.getElementById("response-body-content").textContent;navigator.clipboard.writeText(d).then(()=>{const h=document.getElementById("copy-response"),c=h.innerHTML;h.innerHTML='<i class="fas fa-check"></i> Copied!',setTimeout(()=>{h.innerHTML=c},2e3)})}function Gf(){const d=document.getElementById("response-body-content").textContent;try{const h=JSON.parse(d);document.getElementById("response-body-content").textContent=JSON.stringify(h,null,2)}catch{}}function Ze(d){const h=document.createElement("div");return h.textContent=d,h.innerHTML}function gl(d){ol(d)}function ri(d){Gi(d)}function Vo(d){Yo(d)}let qt=null;function Kf(){return qt&&qt.remove(),qt=document.createElement("div"),qt.className="context-menu",document.body.appendChild(qt),qt}function ii(d,h){d.preventDefault(),d.stopPropagation(),$o();const c=Kf();c.innerHTML="",h.forEach(S=>{const T=document.createElement("div");T.className=`context-menu-item ${S.danger?"danger":""}`,T.innerHTML=`<i class="${S.icon}"></i><span>${S.label}</span>`,T.addEventListener("click",O=>{O.stopPropagation(),S.action(),$o()}),c.appendChild(T)});const v=d.pageX||d.clientX,w=d.pageY||d.clientY;c.style.left=`${v}px`,c.style.top=`${w}px`,c.style.position="fixed",c.style.zIndex="10000",c.classList.add("active"),requestAnimationFrame(()=>{c.classList.add("active")}),setTimeout(()=>{const S=T=>{c.contains(T.target)||($o(),document.removeEventListener("click",S),document.removeEventListener("contextmenu",S))};document.addEventListener("click",S,{once:!1}),document.addEventListener("contextmenu",S,{once:!1})},0)}function $o(){qt&&(qt.classList.remove("active"),setTimeout(()=>{qt&&(qt.remove(),qt=null)},200))}async function jf(d){try{(await fetch(`/api/folders/${d}/archive`,{method:"PUT"})).ok?(await kr(),await _t(null,$t),oe("Folder archived successfully")):oe("Failed to archive folder","error")}catch(h){console.error("Error archiving folder:",h),oe("Failed to archive folder","error")}}async function Xf(d){try{(await fetch(`/api/folders/${d}/unarchive`,{method:"PUT"})).ok?(await kr(),await _t(null,$t),oe("Folder unarchived successfully")):oe("Failed to unarchive folder","error")}catch(h){console.error("Error unarchiving folder:",h),oe("Failed to unarchive folder","error")}}async function ml(d){try{(await fetch(`/api/folders/${d}`,{method:"DELETE"})).ok?(await kr(),await _t(null,$t),oe("Folder deleted successfully")):oe("Failed to delete folder","error")}catch(h){console.error("Error deleting folder:",h),oe("Failed to delete folder","error")}}async function $f(d){try{(await fetch(`/api/requests/${d}/archive`,{method:"PUT"})).ok?(await _t(null,$t),oe("Request archived successfully")):oe("Failed to archive request","error")}catch(h){console.error("Error archiving request:",h),oe("Failed to archive request","error")}}async function Yf(d){try{(await fetch(`/api/requests/${d}/unarchive`,{method:"PUT"})).ok?(await _t(null,$t),oe("Request unarchived successfully")):oe("Failed to unarchive request","error")}catch(h){console.error("Error unarchiving request:",h),oe("Failed to unarchive request","error")}}async function Xi(d){try{(await fetch(`/api/requests/${d}`,{method:"DELETE"})).ok?(await _t(null,$t),ft===d&&(ft=null,cl()),il(d),oe("Request deleted successfully")):oe("Failed to delete request","error")}catch(h){console.error("Error deleting request:",h),oe("Failed to delete request","error")}}async function yl(d){if(confirm("Are you sure you want to archive this environment?"))try{if((await fetch(`/api/environments/${d}/archive`,{method:"PUT"})).ok){if(await si(),et===d){et=null,Lr();const c=document.getElementById("environment-actions");c&&(c.style.display="none");const v=document.getElementById("environment-select");v&&(v.value="")}oe("Environment archived successfully")}else oe("Failed to archive environment","error")}catch(h){console.error("Error archiving environment:",h),oe("Failed to archive environment","error")}}async function Jf(d){try{(await fetch(`/api/environments/${d}/unarchive`,{method:"PUT"})).ok?(await si(),oe("Environment unarchived successfully")):oe("Failed to unarchive environment","error")}catch(h){console.error("Error unarchiving environment:",h),oe("Failed to unarchive environment","error")}}async function Zo(d){if(confirm("Are you sure you want to permanently delete this environment? This action cannot be undone."))try{if((await fetch(`/api/environments/${d}`,{method:"DELETE"})).ok){if(await si(),et===d){et=null,Lr();const c=document.getElementById("environment-actions");c&&(c.style.display="none");const v=document.getElementById("environment-select");v&&(v.value="")}oe("Environment deleted successfully")}else oe("Failed to delete environment","error")}catch(h){console.error("Error deleting environment:",h),oe("Failed to delete environment","error")}}setInterval(vl,5e3);function Zf(){const d=document.getElementById("panel-resizer"),h=document.querySelector(".request-editor-panel"),c=document.querySelector(".response-panel"),v=document.querySelector(".main-layout"),w=document.querySelector(".panels-container");if(!d||!h||!c||!w)return;let S=!1,T=0,O=0,B=0,W=0,A=0,j=0;const P=d.querySelector(".resizer-handle"),$=()=>v.classList.contains("vertical-layout"),q=te=>{S=!0;const b=te.touches?te.touches[0].clientX:te.clientX,x=te.touches?te.touches[0].clientY:te.clientY;T=b,O=x,B=h.offsetWidth,W=h.offsetHeight,A=c.offsetWidth,j=c.offsetHeight,d.classList.add("resizing"),$()?document.body.style.cursor="row-resize":document.body.style.cursor="col-resize",document.body.style.userSelect="none",te.preventDefault(),te.stopPropagation()};d.addEventListener("mousedown",q),P&&P.addEventListener("mousedown",q),document.addEventListener("mousemove",te=>{if(S)if($()){const b=te.clientY-O,x=W+b,E=j-b,I=200,X=w.offsetHeight-I-16;x>=I&&x<=X&&E>=I&&(h.style.flex="none",h.style.height=x+"px",c.style.flex="1")}else{const b=te.clientX-T,x=B+b,E=A-b,I=300,X=w.offsetWidth-I-16;x>=I&&x<=X&&E>=I&&(h.style.flex="none",h.style.width=x+"px",c.style.flex="1")}}),document.addEventListener("mouseup",()=>{S&&(S=!1,d.classList.remove("resizing"),document.body.style.cursor="",document.body.style.userSelect="")});const re=te=>{S=!0,O=te.touches[0].clientY,W=h.offsetHeight,j=c.offsetHeight,d.classList.add("resizing"),te.preventDefault(),te.stopPropagation()};d.addEventListener("touchstart",re),P&&P.addEventListener("touchstart",re),document.addEventListener("touchmove",te=>{if(!S)return;const b=te.touches[0].clientY-O,x=W+b,E=j-b,I=150,F=w.offsetHeight-I-100;x>=I&&x<=F&&E>=I&&(h.style.flex="none",h.style.height=x+"px",c.style.flex="1")}),document.addEventListener("touchend",()=>{S&&(S=!1,d.classList.remove("resizing"))}),d.addEventListener("dblclick",()=>{h.style.flex="",h.style.height="",c.style.flex="1"})}function Qf(d){const h=d.target.value,c=document.getElementById("send-request-btn"),v=document.getElementById("ws-connect-btn"),w=document.getElementById("ws-disconnect-btn"),S=document.querySelector(".ws-tab"),T=document.getElementById("request-url");if(h==="WS")c.classList.add("hidden"),v.classList.remove("hidden"),S.classList.remove("hidden"),T.placeholder="Enter WebSocket URL (ws:// or wss://)",!T.value.startsWith("ws://")&&!T.value.startsWith("wss://")&&(T.value="wss://echo.websocket.org"),oi("websocket"),zn();else{c.classList.remove("hidden"),v.classList.add("hidden"),w.classList.add("hidden"),S.classList.add("hidden"),T.placeholder="Enter request URL",(T.value.startsWith("ws://")||T.value.startsWith("wss://"))&&(T.value="https://api.example.com/v1/users");const O=document.querySelector(".request-sub-tab.active");O&&O.dataset.tab==="websocket"&&oi("headers")}}function zn(){const d=document.getElementById("ws-connect-btn"),h=document.getElementById("ws-disconnect-btn");wr?(d.classList.add("hidden"),h.classList.remove("hidden")):(d.classList.remove("hidden"),h.classList.add("hidden"))}function br(d,h){const c=document.querySelector(".ws-status-indicator"),v=document.getElementById("ws-status-text"),w=document.getElementById("ws-send-btn");c.className="ws-status-indicator "+d,v.textContent=h,d==="connected"?w.disabled=!1:w.disabled=!0}function Vf(d){const h=d.target.value,c=document.getElementById("request-type"),v=document.getElementById("request-method"),w=document.getElementById("send-request-btn"),S=document.getElementById("ws-connect-btn"),T=document.getElementById("ws-disconnect-btn"),O=document.querySelector(".ws-tab"),B=document.querySelector('[data-tab="body"]'),W=document.getElementById("request-url"),A=document.getElementById("response-ws-tab"),j=document.querySelector('.response-tab[data-tab="response-body"]'),P=document.querySelector('.response-tab[data-tab="response-headers"]'),$=document.querySelector('.response-tab[data-tab="response-timeline"]'),q=document.getElementById("response-preview-tab");if(h==="ws")c.classList.add("ws-type"),v.classList.add("hidden"),w.classList.add("hidden"),S.classList.remove("hidden"),O.classList.remove("hidden"),B&&B.classList.add("hidden"),A&&A.classList.remove("hidden"),j&&j.classList.add("hidden"),P&&P.classList.add("hidden"),$&&$.classList.add("hidden"),q&&q.classList.add("hidden"),Ki("response-ws-messages"),W.placeholder="Enter WebSocket URL (ws:// or wss://)",!W.value.startsWith("ws://")&&!W.value.startsWith("wss://")&&(W.value="wss://echo.websocket.org"),oi("websocket"),zn();else{c.classList.remove("ws-type"),v.classList.remove("hidden"),w.classList.remove("hidden"),S.classList.add("hidden"),T.classList.add("hidden"),O.classList.add("hidden"),B&&B.classList.remove("hidden"),A&&A.classList.add("hidden"),j&&j.classList.remove("hidden"),P&&P.classList.remove("hidden"),$&&$.classList.remove("hidden"),Ki("response-body"),W.placeholder="Enter request URL",(W.value.startsWith("ws://")||W.value.startsWith("wss://"))&&(W.value="https://api.example.com/v1/users");const re=document.querySelector(".request-sub-tab.active");re&&re.dataset.tab==="websocket"&&oi("headers")}}function ec(d){const h=d.target.value,c=document.getElementById("auth-none-section"),v=document.getElementById("auth-bearer-section"),w=document.getElementById("auth-basic-section");switch(c&&c.classList.add("hidden"),v&&v.classList.add("hidden"),w&&w.classList.add("hidden"),h){case"none":c&&c.classList.remove("hidden");break;case"bearer":v&&v.classList.remove("hidden");break;case"basic":w&&w.classList.remove("hidden");break}}function tc(d){const h=d.target.value,c=document.getElementById("format-body-btn"),v=document.getElementById("request-body");if(c&&(h==="json"?c.classList.remove("hidden"):c.classList.add("hidden")),v)switch(h){case"none":v.placeholder="No body for this request",v.disabled=!0;break;case"json":v.placeholder=`{
    "key": "value"
}`,v.disabled=!1;break;case"xml":v.placeholder=`<?xml version="1.0"?>
<root>
    <element>value</element>
</root>`,v.disabled=!1;break;case"text":v.placeholder="Enter plain text...",v.disabled=!1;break;case"form":v.placeholder="key1=value1&key2=value2",v.disabled=!1;break;case"multipart":v.placeholder="Multipart form data (use key=value format)",v.disabled=!1;break;case"binary":v.placeholder="Binary data (base64 encoded)",v.disabled=!1;break}}function nc(){var v;const d=document.getElementById("body-type-select"),h=d?d.value:"json",c=Pe?Pe.getValue():(v=document.getElementById("request-body"))==null?void 0:v.value;if(!(!c||!c.trim())&&h==="json")try{const w=JSON.parse(c),S=JSON.stringify(w,null,2);Pe?Pe.setValue(S):document.getElementById("request-body").value=S,oe("JSON formatted successfully","success")}catch(w){oe("Invalid JSON: "+w.message,"error")}}function rc(){const d=document.getElementById("response-preview-tab"),h=document.getElementById("response-preview"),c=document.getElementById("html-preview-frame"),v=document.getElementById("response-body-content");if(!(!d||!h||!c)&&(d.classList.remove("hidden"),Ki("response-preview"),v&&v.textContent)){const w=v.textContent;c.srcdoc=w}}function ic(d,h){const c=document.getElementById("preview-response"),v=document.getElementById("response-preview-tab");if(!c)return;d&&(d.includes("text/html")||d.includes("application/xhtml"))||h&&h.trim().startsWith("<!DOCTYPE")||h.trim().startsWith("<html")?(c.classList.remove("hidden"),v&&v.classList.remove("hidden")):(c.classList.add("hidden"),v&&v.classList.add("hidden"))}function oc(d){const h=document.getElementById("env-variables-sample");h&&(d.target.value.trim()?h.classList.add("hidden"):h.classList.remove("hidden"))}function sc(){}function ac(d){const h=document.getElementById("env-variables-sample");h&&(d.target.value.trim()?h.classList.add("hidden"):h.classList.remove("hidden"))}function lc(){const d=document.getElementById("env-variables-sample"),h=document.getElementById("environment-variables");d&&h&&(h.value.trim()||d.classList.remove("hidden"))}function uc(){var v,w,S;const d=document.getElementById("auth-type-select");if(!d)return{};const h=d.value,c={};switch(h){case"bearer":const T=(v=document.getElementById("auth-bearer-token"))==null?void 0:v.value;T&&(c.Authorization=`Bearer ${T}`);break;case"basic":const O=(w=document.getElementById("auth-basic-username"))==null?void 0:w.value,B=(S=document.getElementById("auth-basic-password"))==null?void 0:S.value;if(O){const W=btoa(`${O}:${B||""}`);c.Authorization=`Basic ${W}`}break}return c}function fc(){const d=document.getElementById("body-type-select");if(!d)return"application/json";switch(d.value){case"json":return"application/json";case"xml":return"application/xml";case"text":return"text/plain";case"form":return"application/x-www-form-urlencoded";case"multipart":return"multipart/form-data";default:return"application/json"}}let Qo=null;function cc(){const d=document.getElementById("request-url").value.trim();if(!d){oe("Please enter a WebSocket URL","error");return}if(!d.startsWith("ws://")&&!d.startsWith("wss://")){oe("WebSocket URL must start with ws:// or wss://","error");return}ut&&ut.readyState===WebSocket.OPEN&&ut.close();const h=ji(),c=document.getElementById("auth-type-select"),v=c?c.value:"none";let w=null,S=null,T=null;if(v==="bearer"){const B=document.getElementById("auth-bearer-token");w=B?B.value:null}else if(v==="basic"){const B=document.getElementById("auth-basic-username"),W=document.getElementById("auth-basic-password");S=B?B.value:null,T=W?W.value:null}Qo={url:d,method:"WS",body:"",headers:h,bodyType:"none",authType:v,authToken:w||"",authUsername:S||"",authPassword:T||"",requestType:"ws"},br("connecting","Connecting...");const O=`ws://${window.location.host}/api/ws`;ut=new WebSocket(O),ut.onopen=()=>{const B={type:"connect",url:d,headers:Object.keys(h).length>0?h:null,auth_type:v!=="none"?v:null,auth_token:w,auth_username:S,auth_password:T};ut.send(JSON.stringify(B))},ut.onmessage=B=>{try{const W=JSON.parse(B.data);dc(W)}catch(W){console.error("Failed to parse WebSocket message:",W)}},ut.onerror=B=>{console.error("WebSocket error:",B),br("disconnected","Connection error"),wr=!1,zn(),yr("error","Connection error")},ut.onclose=()=>{br("disconnected","Disconnected"),wr=!1,zn()}}function dc(d){switch(d.type){case"connected":wr=!0,br("connected",`Connected to ${d.url}`),zn(),yr("info",`Connected to ${d.url}`),Qo&&(pl(Qo),ft&&hl());break;case"disconnected":wr=!1,br("disconnected",d.reason||"Disconnected"),zn(),yr("info",d.reason||"Disconnected");break;case"message":yr(d.direction,d.data);break;case"error":yr("error",d.message);break;case"info":yr("info",d.message);break}}function hc(){ut&&(ut.send(JSON.stringify({type:"disconnect"})),ut.close(),ut=null),wr=!1,br("disconnected","Disconnected"),zn()}function bl(){const d=Mt?Mt.getValue().trim():document.getElementById("ws-message-input").value.trim();if(!d){oe("Please enter a message to send","error");return}if(!ut||ut.readyState!==WebSocket.OPEN){oe("WebSocket is not connected","error");return}ut.send(JSON.stringify({type:"send",message:d})),Mt?Mt.setValue(""):document.getElementById("ws-message-input").value=""}function yr(d,h){const c=document.getElementById("ws-response-messages"),v=document.createElement("div");v.className=`ws-message ${d}`;const w=new Date().toLocaleTimeString();let S="",T="";d==="sent"?(S="sent",T="SENT"):d==="received"?(S="received",T="RECEIVED"):d==="error"?T="ERROR":d==="info"&&(T="INFO"),v.innerHTML=`
        <div class="ws-message-header">
            <span class="ws-message-direction ${S}">${T}</span>
            <span class="ws-message-time">${w}</span>
        </div>
        <div class="ws-message-content">${Ze(h)}</div>
    `,c.insertBefore(v,c.firstChild),c.scrollTop=0}function pc(){const d=document.getElementById("ws-response-messages");d.innerHTML=""}function vc(){const d=document.getElementById("collection-header"),h=document.getElementById("collection-section");d&&h&&d.addEventListener("click",w=>{w.target.closest(".sidebar-section-actions")||h.classList.toggle("collapsed")});const c=document.getElementById("history-header"),v=document.getElementById("history-section");c&&v&&c.addEventListener("click",()=>{v.classList.toggle("collapsed")})}function wl(){const d=document.getElementById("history-tree");if(!d)return;d.innerHTML="";const h=[...Sr].filter(c=>!c.archived_at).sort((c,v)=>{const w=new Date(c.updated_at||c.created_at);return new Date(v.updated_at||v.created_at)-w});if(h.length===0){const c=document.createElement("li");c.className="history-item",c.style.color="rgba(255, 255, 255, 0.5)",c.style.fontStyle="italic",c.textContent="No requests yet",d.appendChild(c);return}h.forEach(c=>{const v=document.createElement("li");v.className="history-item";const w=c.method||"GET",S=gc(new Date(c.updated_at||c.created_at));v.innerHTML=`
            <span class="history-item-method ${w}">${w}</span>
            <span class="history-item-name">${Ze(c.name)}</span>
            <span class="history-item-time">${S}</span>
        `,v.addEventListener("click",()=>{xr(c.id)}),v.addEventListener("contextmenu",T=>{T.preventDefault(),T.stopPropagation(),c.archived_at,ii(T,[{label:"Edit",icon:"fas fa-edit",action:()=>ri(c.id)},{label:"Delete",icon:"fas fa-trash",action:()=>Xi(c.id),danger:!0}])}),d.appendChild(v)})}function gc(d){const c=new Date-d,v=Math.floor(c/1e3),w=Math.floor(v/60),S=Math.floor(w/60),T=Math.floor(S/24);return v<60?"just now":w<60?`${w}m ago`:S<24?`${S}h ago`:T<7?`${T}d ago`:d.toLocaleDateString()}function mc(){const d=document.getElementById("import-btn"),h=document.getElementById("import-file-input");d&&h&&(d.addEventListener("click",c=>{c.stopPropagation(),Un("import-modal")}),h.addEventListener("change",c=>{c.target.files.length>0&&(yc(c.target.files[0]),h.value="")}))}async function yc(d){const h=new FormData;h.append("file",d),oe(`Analyzing ${d.name}...`,"info");try{const c=await fetch("/api/import?preview=true",{method:"POST",body:h});if(c.ok){const v=await c.json();if(v.collections&&v.collections.length>0){Ui=d;const w=document.getElementById("import-preview-list");w.innerHTML="",v.collections.forEach(S=>{const T=document.createElement("div");T.style.cssText="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid var(--border-color);",T.innerHTML=`
                        <div style="font-weight: 500; color: var(--text-primary);">
                            <i class="fas fa-folder" style="color: var(--primary-blue); margin-right: 8px;"></i>
                            ${Ze(S.name)}
                        </div>
                        <div style="font-size: 12px; color: var(--text-secondary); background: var(--bg-secondary); padding: 2px 8px; border-radius: 10px;">
                            ${S.request_count} requests
                        </div>
                    `,w.appendChild(T)}),Cn("import-modal"),Un("import-confirmation-modal")}else oe("No valid collections/requests found in file","error")}else{const v=await c.text();oe(`Import analysis failed: ${v}`,"error")}}catch(c){console.error("Error during import analysis:",c),oe(`Error during import analysis: ${c.message}`,"error")}}async function bc(){if(!Ui)return;const d=new FormData;d.append("file",Ui),Cn("import-confirmation-modal"),oe("Importing collections...","info");try{const h=await fetch("/api/import",{method:"POST",body:d});if(h.ok){const c=await h.json();oe(c.message||"Import successful"),await kr(),await _t(null,$t),Ui=null}else{const c=await h.text();oe(`Import failed: ${c}`,"error")}}catch(h){console.error("Error during import:",h),oe(`Error during import: ${h.message}`,"error")}}window.openModal=Un;window.closeModal=Cn;window.openRequestModal=al;window.saveFolder=sl;window.saveRequestFromModal=ll;window.saveEnvironment=ul;window.editFolder=gl;window.editRequest=ri;window.editEnvironment=Vo;window.deleteFolder=ml;window.deleteRequest=Xi;window.deleteEnvironment=Zo;window.archiveFolder=jf;window.unarchiveFolder=Xf;window.archiveRequest=$f;window.unarchiveRequest=Yf;window.archiveEnvironment=yl;window.unarchiveEnvironment=Jf;window.CodeMirror=Lf;
